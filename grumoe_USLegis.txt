INFO:root:********** Run 1 starts. **********
INFO:root:configuration is Namespace(dataset_name='USLegis', batch_size=200, model_name='TGN', gpu=0, num_neighbors=20, sample_neighbor_strategy='time_interval_aware', time_scaling_factor=1e-06, num_walk_heads=8, num_heads=2, num_layers=2, walk_length=1, time_gap=2000, time_feat_dim=100, position_feat_dim=172, edge_bank_memory_mode='unlimited_memory', time_window_mode='fixed_proportion', patch_size=200, channel_embedding_dim=50, max_input_sequence_length=64, learning_rate=0.0001, dropout=0.1, num_epochs=100, optimizer='Adam', weight_decay=0.0, patience=20, val_ratio=0.15, test_ratio=0.15, num_runs=5, test_interval_epochs=10, negative_sample_strategy='random', load_best_configs=False, device='cuda:0', seed=0, save_model_name='TGN_seed0')
INFO:root:model -> Sequential(
  (0): MemoryModel(
    (src_memory_encoder): Linear(in_features=172, out_features=172, bias=True)
    (dst_memory_encoder): Linear(in_features=172, out_features=172, bias=True)
    (edge_encoder): Linear(in_features=172, out_features=172, bias=True)
    (channel_attention): ChannelAttentionTemporal(
      (avg_pool): AdaptiveAvgPool1d(output_size=1)
      (max_pool): AdaptiveMaxPool1d(output_size=1)
      (fc1): Linear(in_features=4, out_features=0, bias=False)
      (relu1): ReLU()
      (fc2): Linear(in_features=0, out_features=4, bias=False)
      (sigmoid): Sigmoid()
    )
    (time_encoder): TimeEncoder(
      (w): Linear(in_features=1, out_features=100, bias=True)
    )
    (message_aggregator): MessageAggregator()
    (memory_bank): MemoryBank(num_nodes=226, memory_dim=172)
    (memory_updater): CFCMemoryUpdater(
      (memory_bank): MemoryBank(num_nodes=226, memory_dim=172)
      (memory_updater): MoE(
        (mixer): Linear(in_features=788, out_features=616, bias=True)
        (relu): ReLU(inplace=True)
        (experts): ModuleList(
          (0-5): 6 x rnnmodule(
            (cell): GRUCell(616, 172)
            (relu): ReLU()
          )
        )
        (softplus): Softplus(beta=1.0, threshold=20.0)
        (softmax): Softmax(dim=1)
      )
    )
    (embedding_module): GraphAttentionEmbedding(
      (time_encoder): TimeEncoder(
        (w): Linear(in_features=1, out_features=100, bias=True)
      )
      (temporal_conv_layers): ModuleList(
        (0-1): 2 x MultiHeadAttention(
          (query_projection): Linear(in_features=272, out_features=272, bias=False)
          (key_projection): Linear(in_features=444, out_features=272, bias=False)
          (value_projection): Linear(in_features=444, out_features=272, bias=False)
          (layer_norm): LayerNorm((272,), eps=1e-05, elementwise_affine=True)
          (residual_fc): Linear(in_features=272, out_features=272, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (merge_layers): ModuleList(
        (0-1): 2 x MergeLayer(
          (fc1): Linear(in_features=444, out_features=172, bias=True)
          (fc2): Linear(in_features=172, out_features=172, bias=True)
          (act): ReLU()
        )
      )
    )
  )
  (1): MergeLayer(
    (fc1): Linear(in_features=344, out_features=172, bias=True)
    (fc2): Linear(in_features=172, out_features=1, bias=True)
    (act): ReLU()
  )
)
INFO:root:model name: TGN, #parameters: 16325876 B, 15943.23828125 KB, 15.569568634033203 MB.
INFO:root:Epoch: 1, learning rate: 0.00016613118653236524, train loss: 0.5876
INFO:root:train average_precision, 0.6535
INFO:root:train roc_auc, 0.7129
INFO:root:validate loss: 0.5530
INFO:root:validate average_precision, 0.7036
INFO:root:validate roc_auc, 0.7658
INFO:root:new node validate loss: 0.7200
INFO:root:new node validate average_precision, 0.5975
INFO:root:new node validate roc_auc, 0.5941
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 2, learning rate: 8.746667664356936e-05, train loss: 0.5837
INFO:root:train average_precision, 0.6433
INFO:root:train roc_auc, 0.7089
INFO:root:validate loss: 0.6120
INFO:root:validate average_precision, 0.6655
INFO:root:validate roc_auc, 0.7123
INFO:root:new node validate loss: 0.6718
INFO:root:new node validate average_precision, 0.5946
INFO:root:new node validate roc_auc, 0.5878
INFO:root:Epoch: 3, learning rate: 1.7291942572543902e-05, train loss: 0.5493
INFO:root:train average_precision, 0.6612
INFO:root:train roc_auc, 0.7284
INFO:root:validate loss: 0.5885
INFO:root:validate average_precision, 0.6532
INFO:root:validate roc_auc, 0.7042
INFO:root:new node validate loss: 0.7047
INFO:root:new node validate average_precision, 0.5797
INFO:root:new node validate roc_auc, 0.5720
INFO:root:Epoch: 4, learning rate: 3.1416838871369568e-06, train loss: 0.5355
INFO:root:train average_precision, 0.6810
INFO:root:train roc_auc, 0.7484
INFO:root:validate loss: 0.5739
INFO:root:validate average_precision, 0.7017
INFO:root:validate roc_auc, 0.7514
INFO:root:new node validate loss: 0.7566
INFO:root:new node validate average_precision, 0.5685
INFO:root:new node validate roc_auc, 0.5471
INFO:root:Epoch: 5, learning rate: 5.4600950026033074e-05, train loss: 0.5272
INFO:root:train average_precision, 0.6909
INFO:root:train roc_auc, 0.7589
INFO:root:validate loss: 0.5775
INFO:root:validate average_precision, 0.7192
INFO:root:validate roc_auc, 0.7741
INFO:root:new node validate loss: 0.8942
INFO:root:new node validate average_precision, 0.5576
INFO:root:new node validate roc_auc, 0.5267
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 6, learning rate: 0.000136812455268468, train loss: 0.5328
INFO:root:train average_precision, 0.6906
INFO:root:train roc_auc, 0.7585
INFO:root:validate loss: 0.5909
INFO:root:validate average_precision, 0.7160
INFO:root:validate roc_auc, 0.7707
INFO:root:new node validate loss: 0.9078
INFO:root:new node validate average_precision, 0.5392
INFO:root:new node validate roc_auc, 0.5112
INFO:root:Epoch: 7, learning rate: 0.00019408807689546632, train loss: 0.5385
INFO:root:train average_precision, 0.6818
INFO:root:train roc_auc, 0.7466
INFO:root:validate loss: 0.5488
INFO:root:validate average_precision, 0.7260
INFO:root:validate roc_auc, 0.7861
INFO:root:new node validate loss: 0.8727
INFO:root:new node validate average_precision, 0.5320
INFO:root:new node validate roc_auc, 0.5139
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 8, learning rate: 0.00018763066800442832, train loss: 0.5565
INFO:root:train average_precision, 0.6639
INFO:root:train roc_auc, 0.7253
INFO:root:validate loss: 0.5056
INFO:root:validate average_precision, 0.7245
INFO:root:validate roc_auc, 0.7898
INFO:root:new node validate loss: 0.7403
INFO:root:new node validate average_precision, 0.5666
INFO:root:new node validate roc_auc, 0.5762
INFO:root:Epoch: 9, learning rate: 0.0001218143241396262, train loss: 0.5373
INFO:root:train average_precision, 0.6791
INFO:root:train roc_auc, 0.7460
INFO:root:validate loss: 0.5166
INFO:root:validate average_precision, 0.7275
INFO:root:validate roc_auc, 0.7920
INFO:root:new node validate loss: 0.7394
INFO:root:new node validate average_precision, 0.5944
INFO:root:new node validate roc_auc, 0.5819
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 10, learning rate: 4.1221474770761954e-05, train loss: 0.5094
INFO:root:train average_precision, 0.6852
INFO:root:train roc_auc, 0.7612
INFO:root:validate loss: 0.4904
INFO:root:validate average_precision, 0.7360
INFO:root:validate roc_auc, 0.8046
INFO:root:new node validate loss: 0.7674
INFO:root:new node validate average_precision, 0.5602
INFO:root:new node validate roc_auc, 0.5502
INFO:root:test loss: 0.4763
INFO:root:test average_precision, 0.7459
INFO:root:test roc_auc, 0.8122
INFO:root:new node test loss: 0.7378
INFO:root:new node test average_precision, 0.5537
INFO:root:new node test roc_auc, 0.5725
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 11, learning rate: 4.438035396920891e-07, train loss: 0.5125
INFO:root:train average_precision, 0.6938
INFO:root:train roc_auc, 0.7658
INFO:root:validate loss: 0.4732
INFO:root:validate average_precision, 0.7383
INFO:root:validate roc_auc, 0.8078
INFO:root:new node validate loss: 0.7710
INFO:root:new node validate average_precision, 0.5589
INFO:root:new node validate roc_auc, 0.5556
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 12, learning rate: 2.71031372578646e-05, train loss: 0.5078
INFO:root:train average_precision, 0.6980
INFO:root:train roc_auc, 0.7706
INFO:root:validate loss: 0.4973
INFO:root:validate average_precision, 0.7297
INFO:root:validate roc_auc, 0.7951
INFO:root:new node validate loss: 0.7719
INFO:root:new node validate average_precision, 0.5783
INFO:root:new node validate roc_auc, 0.5516
INFO:root:Epoch: 13, learning rate: 0.00010314107590778983, train loss: 0.5022
INFO:root:train average_precision, 0.7031
INFO:root:train roc_auc, 0.7725
INFO:root:validate loss: 0.5070
INFO:root:validate average_precision, 0.7246
INFO:root:validate roc_auc, 0.7891
INFO:root:new node validate loss: 0.7889
INFO:root:new node validate average_precision, 0.5575
INFO:root:new node validate roc_auc, 0.5264
INFO:root:Epoch: 14, learning rate: 0.00017705132427761958, train loss: 0.5024
INFO:root:train average_precision, 0.7025
INFO:root:train roc_auc, 0.7698
INFO:root:validate loss: 0.5066
INFO:root:validate average_precision, 0.7278
INFO:root:validate roc_auc, 0.7937
INFO:root:new node validate loss: 0.7960
INFO:root:new node validate average_precision, 0.5511
INFO:root:new node validate roc_auc, 0.5339
INFO:root:Epoch: 15, learning rate: 0.00019876883405964778, train loss: 0.4981
INFO:root:train average_precision, 0.7083
INFO:root:train roc_auc, 0.7748
INFO:root:validate loss: 0.4855
INFO:root:validate average_precision, 0.7314
INFO:root:validate roc_auc, 0.7983
INFO:root:new node validate loss: 0.7555
INFO:root:new node validate average_precision, 0.5612
INFO:root:new node validate roc_auc, 0.5375
INFO:root:Epoch: 16, learning rate: 0.00015358267949793335, train loss: 0.5004
INFO:root:train average_precision, 0.7012
INFO:root:train roc_auc, 0.7713
INFO:root:validate loss: 0.4721
INFO:root:validate average_precision, 0.7366
INFO:root:validate roc_auc, 0.8051
INFO:root:new node validate loss: 0.7352
INFO:root:new node validate average_precision, 0.5790
INFO:root:new node validate roc_auc, 0.5605
INFO:root:Epoch: 17, learning rate: 7.21008893960603e-05, train loss: 0.4997
INFO:root:train average_precision, 0.7011
INFO:root:train roc_auc, 0.7723
INFO:root:validate loss: 0.4939
INFO:root:validate average_precision, 0.7372
INFO:root:validate roc_auc, 0.8052
INFO:root:new node validate loss: 0.7807
INFO:root:new node validate average_precision, 0.5763
INFO:root:new node validate roc_auc, 0.5609
INFO:root:Epoch: 18, learning rate: 9.517294753399618e-06, train loss: 0.5021
INFO:root:train average_precision, 0.7010
INFO:root:train roc_auc, 0.7714
INFO:root:validate loss: 0.4831
INFO:root:validate average_precision, 0.7356
INFO:root:validate roc_auc, 0.8058
INFO:root:new node validate loss: 0.7698
INFO:root:new node validate average_precision, 0.5501
INFO:root:new node validate roc_auc, 0.5439
INFO:root:Epoch: 19, learning rate: 8.224537431604012e-06, train loss: 0.4977
INFO:root:train average_precision, 0.7008
INFO:root:train roc_auc, 0.7725
INFO:root:validate loss: 0.4699
INFO:root:validate average_precision, 0.7382
INFO:root:validate roc_auc, 0.8071
INFO:root:new node validate loss: 0.7713
INFO:root:new node validate average_precision, 0.5613
INFO:root:new node validate roc_auc, 0.5517
INFO:root:Epoch: 20, learning rate: 6.909830056255193e-05, train loss: 0.5002
INFO:root:train average_precision, 0.7051
INFO:root:train roc_auc, 0.7743
INFO:root:validate loss: 0.4800
INFO:root:validate average_precision, 0.7368
INFO:root:validate roc_auc, 0.8047
INFO:root:new node validate loss: 0.7583
INFO:root:new node validate average_precision, 0.5717
INFO:root:new node validate roc_auc, 0.5546
INFO:root:test loss: 0.4805
INFO:root:test average_precision, 0.7464
INFO:root:test roc_auc, 0.8112
INFO:root:new node test loss: 0.7408
INFO:root:new node test average_precision, 0.5752
INFO:root:new node test roc_auc, 0.5873
INFO:root:Epoch: 21, learning rate: 0.00015090414157507186, train loss: 0.4964
INFO:root:train average_precision, 0.7060
INFO:root:train roc_auc, 0.7753
INFO:root:validate loss: 0.4806
INFO:root:validate average_precision, 0.7343
INFO:root:validate roc_auc, 0.8008
INFO:root:new node validate loss: 0.7484
INFO:root:new node validate average_precision, 0.5460
INFO:root:new node validate roc_auc, 0.5317
INFO:root:Epoch: 22, learning rate: 0.00019822872507282462, train loss: 0.4980
INFO:root:train average_precision, 0.7052
INFO:root:train roc_auc, 0.7730
INFO:root:validate loss: 0.4778
INFO:root:validate average_precision, 0.7359
INFO:root:validate roc_auc, 0.8024
INFO:root:new node validate loss: 0.7305
INFO:root:new node validate average_precision, 0.5717
INFO:root:new node validate roc_auc, 0.5455
INFO:root:Epoch: 23, learning rate: 0.00017901550123764875, train loss: 0.4969
INFO:root:train average_precision, 0.7032
INFO:root:train roc_auc, 0.7736
INFO:root:validate loss: 0.4852
INFO:root:validate average_precision, 0.7343
INFO:root:validate roc_auc, 0.8007
INFO:root:new node validate loss: 0.7360
INFO:root:new node validate average_precision, 0.5772
INFO:root:new node validate roc_auc, 0.5481
INFO:root:Epoch: 24, learning rate: 0.00010627905195293241, train loss: 0.4983
INFO:root:train average_precision, 0.7052
INFO:root:train roc_auc, 0.7736
INFO:root:validate loss: 0.4755
INFO:root:validate average_precision, 0.7377
INFO:root:validate roc_auc, 0.8052
INFO:root:new node validate loss: 0.7435
INFO:root:new node validate average_precision, 0.5834
INFO:root:new node validate roc_auc, 0.5663
INFO:root:Epoch: 25, learning rate: 2.928932188133125e-05, train loss: 0.4972
INFO:root:train average_precision, 0.7011
INFO:root:train roc_auc, 0.7732
INFO:root:validate loss: 0.4693
INFO:root:validate average_precision, 0.7343
INFO:root:validate roc_auc, 0.8069
INFO:root:new node validate loss: 0.7569
INFO:root:new node validate average_precision, 0.5344
INFO:root:new node validate roc_auc, 0.5426
INFO:root:Epoch: 26, learning rate: 1.9732715717278847e-07, train loss: 0.5053
INFO:root:train average_precision, 0.7020
INFO:root:train roc_auc, 0.7712
INFO:root:validate loss: 0.4641
INFO:root:validate average_precision, 0.7371
INFO:root:validate roc_auc, 0.8086
INFO:root:new node validate loss: 0.7646
INFO:root:new node validate average_precision, 0.5468
INFO:root:new node validate roc_auc, 0.5595
INFO:root:Epoch: 27, learning rate: 3.870929463473711e-05, train loss: 0.4939
INFO:root:train average_precision, 0.7060
INFO:root:train roc_auc, 0.7752
INFO:root:validate loss: 0.4759
INFO:root:validate average_precision, 0.7370
INFO:root:validate roc_auc, 0.8045
INFO:root:new node validate loss: 0.7556
INFO:root:new node validate average_precision, 0.5737
INFO:root:new node validate roc_auc, 0.5610
INFO:root:Epoch: 28, learning rate: 0.00011873813145862787, train loss: 0.4949
INFO:root:train average_precision, 0.7069
INFO:root:train roc_auc, 0.7748
INFO:root:validate loss: 0.4778
INFO:root:validate average_precision, 0.7393
INFO:root:validate roc_auc, 0.8065
INFO:root:new node validate loss: 0.7321
INFO:root:new node validate average_precision, 0.5729
INFO:root:new node validate roc_auc, 0.5662
INFO:root:Epoch: 29, learning rate: 0.00018607420270039493, train loss: 0.4912
INFO:root:train average_precision, 0.7090
INFO:root:train roc_auc, 0.7773
INFO:root:validate loss: 0.4722
INFO:root:validate average_precision, 0.7326
INFO:root:validate roc_auc, 0.8002
INFO:root:new node validate loss: 0.7347
INFO:root:new node validate average_precision, 0.5475
INFO:root:new node validate roc_auc, 0.5407
INFO:root:Epoch: 30, learning rate: 0.00019510565162977856, train loss: 0.4914
INFO:root:train average_precision, 0.7059
INFO:root:train roc_auc, 0.7747
INFO:root:validate loss: 0.4790
INFO:root:validate average_precision, 0.7353
INFO:root:validate roc_auc, 0.8029
INFO:root:new node validate loss: 0.7416
INFO:root:new node validate average_precision, 0.5494
INFO:root:new node validate roc_auc, 0.5465
INFO:root:test loss: 0.4861
INFO:root:test average_precision, 0.7407
INFO:root:test roc_auc, 0.8084
INFO:root:new node test loss: 0.7474
INFO:root:new node test average_precision, 0.5445
INFO:root:new node test roc_auc, 0.5657
INFO:root:Epoch: 31, learning rate: 0.000139714789063601, train loss: 0.4927
INFO:root:train average_precision, 0.7048
INFO:root:train roc_auc, 0.7746
INFO:root:validate loss: 0.4724
INFO:root:validate average_precision, 0.7382
INFO:root:validate roc_auc, 0.8061
INFO:root:new node validate loss: 0.7446
INFO:root:new node validate average_precision, 0.5650
INFO:root:new node validate roc_auc, 0.5554
INFO:root:load model ./saved_models/TGN/USLegis/TGN_seed0/TGN_seed0.pkl
INFO:root:get final performance on dataset USLegis...
INFO:root:test loss: 0.4759
INFO:root:test average_precision, 0.7469
INFO:root:test roc_auc, 0.8132
INFO:root:new node test loss: 0.7686
INFO:root:new node test average_precision, 0.5484
INFO:root:new node test roc_auc, 0.5702
INFO:root:Run 1 cost 7740.02 seconds.
INFO:root:********** Run 2 starts. **********
INFO:root:configuration is Namespace(dataset_name='USLegis', batch_size=200, model_name='TGN', gpu=0, num_neighbors=20, sample_neighbor_strategy='time_interval_aware', time_scaling_factor=1e-06, num_walk_heads=8, num_heads=2, num_layers=2, walk_length=1, time_gap=2000, time_feat_dim=100, position_feat_dim=172, edge_bank_memory_mode='unlimited_memory', time_window_mode='fixed_proportion', patch_size=200, channel_embedding_dim=50, max_input_sequence_length=64, learning_rate=0.0001, dropout=0.1, num_epochs=100, optimizer='Adam', weight_decay=0.0, patience=20, val_ratio=0.15, test_ratio=0.15, num_runs=5, test_interval_epochs=10, negative_sample_strategy='random', load_best_configs=False, device='cuda:0', seed=1, save_model_name='TGN_seed1')
INFO:root:model -> Sequential(
  (0): MemoryModel(
    (src_memory_encoder): Linear(in_features=172, out_features=172, bias=True)
    (dst_memory_encoder): Linear(in_features=172, out_features=172, bias=True)
    (edge_encoder): Linear(in_features=172, out_features=172, bias=True)
    (channel_attention): ChannelAttentionTemporal(
      (avg_pool): AdaptiveAvgPool1d(output_size=1)
      (max_pool): AdaptiveMaxPool1d(output_size=1)
      (fc1): Linear(in_features=4, out_features=0, bias=False)
      (relu1): ReLU()
      (fc2): Linear(in_features=0, out_features=4, bias=False)
      (sigmoid): Sigmoid()
    )
    (time_encoder): TimeEncoder(
      (w): Linear(in_features=1, out_features=100, bias=True)
    )
    (message_aggregator): MessageAggregator()
    (memory_bank): MemoryBank(num_nodes=226, memory_dim=172)
    (memory_updater): CFCMemoryUpdater(
      (memory_bank): MemoryBank(num_nodes=226, memory_dim=172)
      (memory_updater): MoE(
        (mixer): Linear(in_features=788, out_features=616, bias=True)
        (relu): ReLU(inplace=True)
        (experts): ModuleList(
          (0-5): 6 x rnnmodule(
            (cell): GRUCell(616, 172)
            (relu): ReLU()
          )
        )
        (softplus): Softplus(beta=1.0, threshold=20.0)
        (softmax): Softmax(dim=1)
      )
    )
    (embedding_module): GraphAttentionEmbedding(
      (time_encoder): TimeEncoder(
        (w): Linear(in_features=1, out_features=100, bias=True)
      )
      (temporal_conv_layers): ModuleList(
        (0-1): 2 x MultiHeadAttention(
          (query_projection): Linear(in_features=272, out_features=272, bias=False)
          (key_projection): Linear(in_features=444, out_features=272, bias=False)
          (value_projection): Linear(in_features=444, out_features=272, bias=False)
          (layer_norm): LayerNorm((272,), eps=1e-05, elementwise_affine=True)
          (residual_fc): Linear(in_features=272, out_features=272, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (merge_layers): ModuleList(
        (0-1): 2 x MergeLayer(
          (fc1): Linear(in_features=444, out_features=172, bias=True)
          (fc2): Linear(in_features=172, out_features=172, bias=True)
          (act): ReLU()
        )
      )
    )
  )
  (1): MergeLayer(
    (fc1): Linear(in_features=344, out_features=172, bias=True)
    (fc2): Linear(in_features=172, out_features=1, bias=True)
    (act): ReLU()
  )
)
INFO:root:model name: TGN, #parameters: 16325876 B, 15943.23828125 KB, 15.569568634033203 MB.
INFO:root:Epoch: 1, learning rate: 0.00016613118653236524, train loss: 0.5913
INFO:root:train average_precision, 0.6567
INFO:root:train roc_auc, 0.7145
INFO:root:validate loss: 0.5989
INFO:root:validate average_precision, 0.6786
INFO:root:validate roc_auc, 0.7370
INFO:root:new node validate loss: 0.7034
INFO:root:new node validate average_precision, 0.6014
INFO:root:new node validate roc_auc, 0.5974
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 2, learning rate: 8.746667664356936e-05, train loss: 0.5911
INFO:root:train average_precision, 0.6395
INFO:root:train roc_auc, 0.7061
INFO:root:validate loss: 0.6263
INFO:root:validate average_precision, 0.6760
INFO:root:validate roc_auc, 0.7234
INFO:root:new node validate loss: 0.6735
INFO:root:new node validate average_precision, 0.5916
INFO:root:new node validate roc_auc, 0.5818
INFO:root:Epoch: 3, learning rate: 1.7291942572543902e-05, train loss: 0.5604
INFO:root:train average_precision, 0.6482
INFO:root:train roc_auc, 0.7165
INFO:root:validate loss: 0.5962
INFO:root:validate average_precision, 0.6464
INFO:root:validate roc_auc, 0.6968
INFO:root:new node validate loss: 0.6938
INFO:root:new node validate average_precision, 0.5841
INFO:root:new node validate roc_auc, 0.5852
INFO:root:Epoch: 4, learning rate: 3.1416838871369568e-06, train loss: 0.5446
INFO:root:train average_precision, 0.6719
INFO:root:train roc_auc, 0.7370
INFO:root:validate loss: 0.5690
INFO:root:validate average_precision, 0.6888
INFO:root:validate roc_auc, 0.7404
INFO:root:new node validate loss: 0.7010
INFO:root:new node validate average_precision, 0.5925
INFO:root:new node validate roc_auc, 0.5831
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 5, learning rate: 5.4600950026033074e-05, train loss: 0.5336
INFO:root:train average_precision, 0.6840
INFO:root:train roc_auc, 0.7514
INFO:root:validate loss: 0.5410
INFO:root:validate average_precision, 0.7042
INFO:root:validate roc_auc, 0.7641
INFO:root:new node validate loss: 0.7949
INFO:root:new node validate average_precision, 0.5406
INFO:root:new node validate roc_auc, 0.5283
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 6, learning rate: 0.000136812455268468, train loss: 0.5580
INFO:root:train average_precision, 0.6734
INFO:root:train roc_auc, 0.7289
INFO:root:validate loss: 0.5658
INFO:root:validate average_precision, 0.6959
INFO:root:validate roc_auc, 0.7553
INFO:root:new node validate loss: 0.8055
INFO:root:new node validate average_precision, 0.5760
INFO:root:new node validate roc_auc, 0.5342
INFO:root:Epoch: 7, learning rate: 0.00019408807689546632, train loss: 0.5303
INFO:root:train average_precision, 0.6865
INFO:root:train roc_auc, 0.7520
INFO:root:validate loss: 0.5055
INFO:root:validate average_precision, 0.7207
INFO:root:validate roc_auc, 0.7841
INFO:root:new node validate loss: 0.7514
INFO:root:new node validate average_precision, 0.5805
INFO:root:new node validate roc_auc, 0.5643
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 8, learning rate: 0.00018763066800442832, train loss: 0.5282
INFO:root:train average_precision, 0.6881
INFO:root:train roc_auc, 0.7501
INFO:root:validate loss: 0.5040
INFO:root:validate average_precision, 0.7258
INFO:root:validate roc_auc, 0.7900
INFO:root:new node validate loss: 0.7668
INFO:root:new node validate average_precision, 0.5843
INFO:root:new node validate roc_auc, 0.5734
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 9, learning rate: 0.0001218143241396262, train loss: 0.5153
INFO:root:train average_precision, 0.6916
INFO:root:train roc_auc, 0.7610
INFO:root:validate loss: 0.4955
INFO:root:validate average_precision, 0.7278
INFO:root:validate roc_auc, 0.7959
INFO:root:new node validate loss: 0.7308
INFO:root:new node validate average_precision, 0.6049
INFO:root:new node validate roc_auc, 0.5873
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 10, learning rate: 4.1221474770761954e-05, train loss: 0.5100
INFO:root:train average_precision, 0.6873
INFO:root:train roc_auc, 0.7602
INFO:root:validate loss: 0.4742
INFO:root:validate average_precision, 0.7361
INFO:root:validate roc_auc, 0.8063
INFO:root:new node validate loss: 0.7319
INFO:root:new node validate average_precision, 0.5851
INFO:root:new node validate roc_auc, 0.5823
INFO:root:test loss: 0.4858
INFO:root:test average_precision, 0.7387
INFO:root:test roc_auc, 0.8040
INFO:root:new node test loss: 0.7444
INFO:root:new node test average_precision, 0.5757
INFO:root:new node test roc_auc, 0.5874
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 11, learning rate: 4.438035396920891e-07, train loss: 0.5094
INFO:root:train average_precision, 0.6927
INFO:root:train roc_auc, 0.7660
INFO:root:validate loss: 0.4718
INFO:root:validate average_precision, 0.7378
INFO:root:validate roc_auc, 0.8085
INFO:root:new node validate loss: 0.7763
INFO:root:new node validate average_precision, 0.5628
INFO:root:new node validate roc_auc, 0.5662
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 12, learning rate: 2.71031372578646e-05, train loss: 0.5037
INFO:root:train average_precision, 0.6989
INFO:root:train roc_auc, 0.7702
INFO:root:validate loss: 0.4940
INFO:root:validate average_precision, 0.7270
INFO:root:validate roc_auc, 0.7944
INFO:root:new node validate loss: 0.7770
INFO:root:new node validate average_precision, 0.5815
INFO:root:new node validate roc_auc, 0.5594
INFO:root:Epoch: 13, learning rate: 0.00010314107590778983, train loss: 0.5049
INFO:root:train average_precision, 0.6990
INFO:root:train roc_auc, 0.7663
INFO:root:validate loss: 0.5035
INFO:root:validate average_precision, 0.7143
INFO:root:validate roc_auc, 0.7803
INFO:root:new node validate loss: 0.7700
INFO:root:new node validate average_precision, 0.5570
INFO:root:new node validate roc_auc, 0.5437
INFO:root:Epoch: 14, learning rate: 0.00017705132427761958, train loss: 0.5111
INFO:root:train average_precision, 0.6878
INFO:root:train roc_auc, 0.7546
INFO:root:validate loss: 0.5039
INFO:root:validate average_precision, 0.7176
INFO:root:validate roc_auc, 0.7822
INFO:root:new node validate loss: 0.7723
INFO:root:new node validate average_precision, 0.5421
INFO:root:new node validate roc_auc, 0.5254
INFO:root:Epoch: 15, learning rate: 0.00019876883405964778, train loss: 0.5069
INFO:root:train average_precision, 0.6903
INFO:root:train roc_auc, 0.7590
INFO:root:validate loss: 0.4858
INFO:root:validate average_precision, 0.7295
INFO:root:validate roc_auc, 0.7960
INFO:root:new node validate loss: 0.7651
INFO:root:new node validate average_precision, 0.5333
INFO:root:new node validate roc_auc, 0.5270
INFO:root:Epoch: 16, learning rate: 0.00015358267949793335, train loss: 0.5050
INFO:root:train average_precision, 0.6937
INFO:root:train roc_auc, 0.7645
INFO:root:validate loss: 0.4858
INFO:root:validate average_precision, 0.7317
INFO:root:validate roc_auc, 0.8000
INFO:root:new node validate loss: 0.7346
INFO:root:new node validate average_precision, 0.5883
INFO:root:new node validate roc_auc, 0.5723
INFO:root:Epoch: 17, learning rate: 7.21008893960603e-05, train loss: 0.5076
INFO:root:train average_precision, 0.6937
INFO:root:train roc_auc, 0.7663
INFO:root:validate loss: 0.4824
INFO:root:validate average_precision, 0.7370
INFO:root:validate roc_auc, 0.8040
INFO:root:new node validate loss: 0.7615
INFO:root:new node validate average_precision, 0.5806
INFO:root:new node validate roc_auc, 0.5711
INFO:root:Epoch: 18, learning rate: 9.517294753399618e-06, train loss: 0.5102
INFO:root:train average_precision, 0.6922
INFO:root:train roc_auc, 0.7650
INFO:root:validate loss: 0.4677
INFO:root:validate average_precision, 0.7339
INFO:root:validate roc_auc, 0.8056
INFO:root:new node validate loss: 0.7638
INFO:root:new node validate average_precision, 0.5504
INFO:root:new node validate roc_auc, 0.5533
INFO:root:Epoch: 19, learning rate: 8.224537431604012e-06, train loss: 0.5029
INFO:root:train average_precision, 0.6964
INFO:root:train roc_auc, 0.7679
INFO:root:validate loss: 0.4701
INFO:root:validate average_precision, 0.7393
INFO:root:validate roc_auc, 0.8084
INFO:root:new node validate loss: 0.7706
INFO:root:new node validate average_precision, 0.5737
INFO:root:new node validate roc_auc, 0.5713
INFO:root:Epoch: 20, learning rate: 6.909830056255193e-05, train loss: 0.5013
INFO:root:train average_precision, 0.6993
INFO:root:train roc_auc, 0.7700
INFO:root:validate loss: 0.4890
INFO:root:validate average_precision, 0.7338
INFO:root:validate roc_auc, 0.7983
INFO:root:new node validate loss: 0.7651
INFO:root:new node validate average_precision, 0.5429
INFO:root:new node validate roc_auc, 0.5410
INFO:root:test loss: 0.5027
INFO:root:test average_precision, 0.7370
INFO:root:test roc_auc, 0.8007
INFO:root:new node test loss: 0.7615
INFO:root:new node test average_precision, 0.5447
INFO:root:new node test roc_auc, 0.5593
INFO:root:Epoch: 21, learning rate: 0.00015090414157507186, train loss: 0.5092
INFO:root:train average_precision, 0.6937
INFO:root:train roc_auc, 0.7601
INFO:root:validate loss: 0.4902
INFO:root:validate average_precision, 0.7236
INFO:root:validate roc_auc, 0.7896
INFO:root:new node validate loss: 0.7636
INFO:root:new node validate average_precision, 0.5042
INFO:root:new node validate roc_auc, 0.4909
INFO:root:Epoch: 22, learning rate: 0.00019822872507282462, train loss: 0.5005
INFO:root:train average_precision, 0.6984
INFO:root:train roc_auc, 0.7660
INFO:root:validate loss: 0.4812
INFO:root:validate average_precision, 0.7322
INFO:root:validate roc_auc, 0.7964
INFO:root:new node validate loss: 0.7574
INFO:root:new node validate average_precision, 0.5653
INFO:root:new node validate roc_auc, 0.5512
INFO:root:Epoch: 23, learning rate: 0.00017901550123764875, train loss: 0.5013
INFO:root:train average_precision, 0.7007
INFO:root:train roc_auc, 0.7690
INFO:root:validate loss: 0.4796
INFO:root:validate average_precision, 0.7360
INFO:root:validate roc_auc, 0.8014
INFO:root:new node validate loss: 0.7302
INFO:root:new node validate average_precision, 0.5808
INFO:root:new node validate roc_auc, 0.5598
INFO:root:Epoch: 24, learning rate: 0.00010627905195293241, train loss: 0.5008
INFO:root:train average_precision, 0.7016
INFO:root:train roc_auc, 0.7699
INFO:root:validate loss: 0.4814
INFO:root:validate average_precision, 0.7341
INFO:root:validate roc_auc, 0.8032
INFO:root:new node validate loss: 0.7519
INFO:root:new node validate average_precision, 0.5684
INFO:root:new node validate roc_auc, 0.5603
INFO:root:Epoch: 25, learning rate: 2.928932188133125e-05, train loss: 0.5014
INFO:root:train average_precision, 0.6957
INFO:root:train roc_auc, 0.7668
INFO:root:validate loss: 0.4614
INFO:root:validate average_precision, 0.7367
INFO:root:validate roc_auc, 0.8071
INFO:root:new node validate loss: 0.7426
INFO:root:new node validate average_precision, 0.5730
INFO:root:new node validate roc_auc, 0.5669
INFO:root:Epoch: 26, learning rate: 1.9732715717278847e-07, train loss: 0.5044
INFO:root:train average_precision, 0.6957
INFO:root:train roc_auc, 0.7657
INFO:root:validate loss: 0.4629
INFO:root:validate average_precision, 0.7347
INFO:root:validate roc_auc, 0.8066
INFO:root:new node validate loss: 0.7506
INFO:root:new node validate average_precision, 0.5560
INFO:root:new node validate roc_auc, 0.5566
INFO:root:Epoch: 27, learning rate: 3.870929463473711e-05, train loss: 0.5039
INFO:root:train average_precision, 0.6987
INFO:root:train roc_auc, 0.7677
INFO:root:validate loss: 0.4758
INFO:root:validate average_precision, 0.7334
INFO:root:validate roc_auc, 0.8003
INFO:root:new node validate loss: 0.7621
INFO:root:new node validate average_precision, 0.5532
INFO:root:new node validate roc_auc, 0.5458
INFO:root:Epoch: 28, learning rate: 0.00011873813145862787, train loss: 0.5044
INFO:root:train average_precision, 0.7006
INFO:root:train roc_auc, 0.7672
INFO:root:validate loss: 0.4792
INFO:root:validate average_precision, 0.7286
INFO:root:validate roc_auc, 0.7964
INFO:root:new node validate loss: 0.7635
INFO:root:new node validate average_precision, 0.5044
INFO:root:new node validate roc_auc, 0.4942
INFO:root:Epoch: 29, learning rate: 0.00018607420270039493, train loss: 0.4996
INFO:root:train average_precision, 0.7029
INFO:root:train roc_auc, 0.7715
INFO:root:validate loss: 0.4798
INFO:root:validate average_precision, 0.7318
INFO:root:validate roc_auc, 0.7974
INFO:root:new node validate loss: 0.7337
INFO:root:new node validate average_precision, 0.5625
INFO:root:new node validate roc_auc, 0.5445
INFO:root:Epoch: 30, learning rate: 0.00019510565162977856, train loss: 0.5022
INFO:root:train average_precision, 0.6984
INFO:root:train roc_auc, 0.7672
INFO:root:validate loss: 0.4856
INFO:root:validate average_precision, 0.7275
INFO:root:validate roc_auc, 0.7933
INFO:root:new node validate loss: 0.7345
INFO:root:new node validate average_precision, 0.5809
INFO:root:new node validate roc_auc, 0.5527
INFO:root:test loss: 0.4869
INFO:root:test average_precision, 0.7389
INFO:root:test roc_auc, 0.8016
INFO:root:new node test loss: 0.7492
INFO:root:new node test average_precision, 0.5813
INFO:root:new node test roc_auc, 0.5778
INFO:root:Epoch: 31, learning rate: 0.000139714789063601, train loss: 0.5031
INFO:root:train average_precision, 0.6958
INFO:root:train roc_auc, 0.7658
INFO:root:validate loss: 0.4772
INFO:root:validate average_precision, 0.7339
INFO:root:validate roc_auc, 0.8023
INFO:root:new node validate loss: 0.7350
INFO:root:new node validate average_precision, 0.5857
INFO:root:new node validate roc_auc, 0.5684
INFO:root:load model ./saved_models/TGN/USLegis/TGN_seed1/TGN_seed1.pkl
INFO:root:get final performance on dataset USLegis...
INFO:root:test loss: 0.4883
INFO:root:test average_precision, 0.7403
INFO:root:test roc_auc, 0.8074
INFO:root:new node test loss: 0.7874
INFO:root:new node test average_precision, 0.5461
INFO:root:new node test roc_auc, 0.5681
INFO:root:Run 2 cost 8538.21 seconds.
INFO:root:********** Run 3 starts. **********
INFO:root:configuration is Namespace(dataset_name='USLegis', batch_size=200, model_name='TGN', gpu=0, num_neighbors=20, sample_neighbor_strategy='time_interval_aware', time_scaling_factor=1e-06, num_walk_heads=8, num_heads=2, num_layers=2, walk_length=1, time_gap=2000, time_feat_dim=100, position_feat_dim=172, edge_bank_memory_mode='unlimited_memory', time_window_mode='fixed_proportion', patch_size=200, channel_embedding_dim=50, max_input_sequence_length=64, learning_rate=0.0001, dropout=0.1, num_epochs=100, optimizer='Adam', weight_decay=0.0, patience=20, val_ratio=0.15, test_ratio=0.15, num_runs=5, test_interval_epochs=10, negative_sample_strategy='random', load_best_configs=False, device='cuda:0', seed=2, save_model_name='TGN_seed2')
INFO:root:model -> Sequential(
  (0): MemoryModel(
    (src_memory_encoder): Linear(in_features=172, out_features=172, bias=True)
    (dst_memory_encoder): Linear(in_features=172, out_features=172, bias=True)
    (edge_encoder): Linear(in_features=172, out_features=172, bias=True)
    (channel_attention): ChannelAttentionTemporal(
      (avg_pool): AdaptiveAvgPool1d(output_size=1)
      (max_pool): AdaptiveMaxPool1d(output_size=1)
      (fc1): Linear(in_features=4, out_features=0, bias=False)
      (relu1): ReLU()
      (fc2): Linear(in_features=0, out_features=4, bias=False)
      (sigmoid): Sigmoid()
    )
    (time_encoder): TimeEncoder(
      (w): Linear(in_features=1, out_features=100, bias=True)
    )
    (message_aggregator): MessageAggregator()
    (memory_bank): MemoryBank(num_nodes=226, memory_dim=172)
    (memory_updater): CFCMemoryUpdater(
      (memory_bank): MemoryBank(num_nodes=226, memory_dim=172)
      (memory_updater): MoE(
        (mixer): Linear(in_features=788, out_features=616, bias=True)
        (relu): ReLU(inplace=True)
        (experts): ModuleList(
          (0-5): 6 x rnnmodule(
            (cell): GRUCell(616, 172)
            (relu): ReLU()
          )
        )
        (softplus): Softplus(beta=1.0, threshold=20.0)
        (softmax): Softmax(dim=1)
      )
    )
    (embedding_module): GraphAttentionEmbedding(
      (time_encoder): TimeEncoder(
        (w): Linear(in_features=1, out_features=100, bias=True)
      )
      (temporal_conv_layers): ModuleList(
        (0-1): 2 x MultiHeadAttention(
          (query_projection): Linear(in_features=272, out_features=272, bias=False)
          (key_projection): Linear(in_features=444, out_features=272, bias=False)
          (value_projection): Linear(in_features=444, out_features=272, bias=False)
          (layer_norm): LayerNorm((272,), eps=1e-05, elementwise_affine=True)
          (residual_fc): Linear(in_features=272, out_features=272, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (merge_layers): ModuleList(
        (0-1): 2 x MergeLayer(
          (fc1): Linear(in_features=444, out_features=172, bias=True)
          (fc2): Linear(in_features=172, out_features=172, bias=True)
          (act): ReLU()
        )
      )
    )
  )
  (1): MergeLayer(
    (fc1): Linear(in_features=344, out_features=172, bias=True)
    (fc2): Linear(in_features=172, out_features=1, bias=True)
    (act): ReLU()
  )
)
INFO:root:model name: TGN, #parameters: 16325876 B, 15943.23828125 KB, 15.569568634033203 MB.
INFO:root:Epoch: 1, learning rate: 0.00016613118653236524, train loss: 0.5869
INFO:root:train average_precision, 0.6542
INFO:root:train roc_auc, 0.7149
INFO:root:validate loss: 0.5963
INFO:root:validate average_precision, 0.6974
INFO:root:validate roc_auc, 0.7589
INFO:root:new node validate loss: 0.7196
INFO:root:new node validate average_precision, 0.5959
INFO:root:new node validate roc_auc, 0.5901
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 2, learning rate: 8.746667664356936e-05, train loss: 0.5904
INFO:root:train average_precision, 0.6359
INFO:root:train roc_auc, 0.7034
INFO:root:validate loss: 0.6175
INFO:root:validate average_precision, 0.6557
INFO:root:validate roc_auc, 0.7040
INFO:root:new node validate loss: 0.6735
INFO:root:new node validate average_precision, 0.5928
INFO:root:new node validate roc_auc, 0.5887
INFO:root:Epoch: 3, learning rate: 1.7291942572543902e-05, train loss: 0.5603
INFO:root:train average_precision, 0.6500
INFO:root:train roc_auc, 0.7167
INFO:root:validate loss: 0.5971
INFO:root:validate average_precision, 0.6372
INFO:root:validate roc_auc, 0.6902
INFO:root:new node validate loss: 0.6955
INFO:root:new node validate average_precision, 0.5848
INFO:root:new node validate roc_auc, 0.5832
INFO:root:Epoch: 4, learning rate: 3.1416838871369568e-06, train loss: 0.5440
INFO:root:train average_precision, 0.6731
INFO:root:train roc_auc, 0.7411
INFO:root:validate loss: 0.5707
INFO:root:validate average_precision, 0.7008
INFO:root:validate roc_auc, 0.7492
INFO:root:new node validate loss: 0.7255
INFO:root:new node validate average_precision, 0.5843
INFO:root:new node validate roc_auc, 0.5649
INFO:root:Epoch: 5, learning rate: 5.4600950026033074e-05, train loss: 0.5242
INFO:root:train average_precision, 0.6916
INFO:root:train roc_auc, 0.7604
INFO:root:validate loss: 0.5605
INFO:root:validate average_precision, 0.7231
INFO:root:validate roc_auc, 0.7810
INFO:root:new node validate loss: 0.8535
INFO:root:new node validate average_precision, 0.5358
INFO:root:new node validate roc_auc, 0.5289
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 6, learning rate: 0.000136812455268468, train loss: 0.5501
INFO:root:train average_precision, 0.6859
INFO:root:train roc_auc, 0.7499
INFO:root:validate loss: 0.5422
INFO:root:validate average_precision, 0.7269
INFO:root:validate roc_auc, 0.7893
INFO:root:new node validate loss: 0.8294
INFO:root:new node validate average_precision, 0.5435
INFO:root:new node validate roc_auc, 0.5350
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 7, learning rate: 0.00019408807689546632, train loss: 0.5240
INFO:root:train average_precision, 0.6926
INFO:root:train roc_auc, 0.7579
INFO:root:validate loss: 0.5399
INFO:root:validate average_precision, 0.7164
INFO:root:validate roc_auc, 0.7796
INFO:root:new node validate loss: 0.8328
INFO:root:new node validate average_precision, 0.5039
INFO:root:new node validate roc_auc, 0.4988
INFO:root:Epoch: 8, learning rate: 0.00018763066800442832, train loss: 0.5422
INFO:root:train average_precision, 0.6798
INFO:root:train roc_auc, 0.7407
INFO:root:validate loss: 0.4967
INFO:root:validate average_precision, 0.7344
INFO:root:validate roc_auc, 0.7998
INFO:root:new node validate loss: 0.7449
INFO:root:new node validate average_precision, 0.5530
INFO:root:new node validate roc_auc, 0.5511
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 9, learning rate: 0.0001218143241396262, train loss: 0.5534
INFO:root:train average_precision, 0.6607
INFO:root:train roc_auc, 0.7267
INFO:root:validate loss: 0.5736
INFO:root:validate average_precision, 0.7091
INFO:root:validate roc_auc, 0.7676
INFO:root:new node validate loss: 0.6962
INFO:root:new node validate average_precision, 0.5871
INFO:root:new node validate roc_auc, 0.5673
INFO:root:Epoch: 10, learning rate: 4.1221474770761954e-05, train loss: 0.5128
INFO:root:train average_precision, 0.6868
INFO:root:train roc_auc, 0.7607
INFO:root:validate loss: 0.4907
INFO:root:validate average_precision, 0.7350
INFO:root:validate roc_auc, 0.8034
INFO:root:new node validate loss: 0.7480
INFO:root:new node validate average_precision, 0.5625
INFO:root:new node validate roc_auc, 0.5629
INFO:root:test loss: 0.4833
INFO:root:test average_precision, 0.7368
INFO:root:test roc_auc, 0.8059
INFO:root:new node test loss: 0.7324
INFO:root:new node test average_precision, 0.5567
INFO:root:new node test roc_auc, 0.5764
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 11, learning rate: 4.438035396920891e-07, train loss: 0.5193
INFO:root:train average_precision, 0.6903
INFO:root:train roc_auc, 0.7602
INFO:root:validate loss: 0.4825
INFO:root:validate average_precision, 0.7362
INFO:root:validate roc_auc, 0.8046
INFO:root:new node validate loss: 0.7693
INFO:root:new node validate average_precision, 0.5516
INFO:root:new node validate roc_auc, 0.5503
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 12, learning rate: 2.71031372578646e-05, train loss: 0.5108
INFO:root:train average_precision, 0.6997
INFO:root:train roc_auc, 0.7683
INFO:root:validate loss: 0.4882
INFO:root:validate average_precision, 0.7333
INFO:root:validate roc_auc, 0.8006
INFO:root:new node validate loss: 0.7707
INFO:root:new node validate average_precision, 0.5829
INFO:root:new node validate roc_auc, 0.5606
INFO:root:Epoch: 13, learning rate: 0.00010314107590778983, train loss: 0.5116
INFO:root:train average_precision, 0.6963
INFO:root:train roc_auc, 0.7671
INFO:root:validate loss: 0.4908
INFO:root:validate average_precision, 0.7346
INFO:root:validate roc_auc, 0.8016
INFO:root:new node validate loss: 0.7576
INFO:root:new node validate average_precision, 0.5712
INFO:root:new node validate roc_auc, 0.5544
INFO:root:Epoch: 14, learning rate: 0.00017705132427761958, train loss: 0.5049
INFO:root:train average_precision, 0.6990
INFO:root:train roc_auc, 0.7681
INFO:root:validate loss: 0.4852
INFO:root:validate average_precision, 0.7332
INFO:root:validate roc_auc, 0.8010
INFO:root:new node validate loss: 0.7575
INFO:root:new node validate average_precision, 0.5644
INFO:root:new node validate roc_auc, 0.5486
INFO:root:Epoch: 15, learning rate: 0.00019876883405964778, train loss: 0.4996
INFO:root:train average_precision, 0.7044
INFO:root:train roc_auc, 0.7739
INFO:root:validate loss: 0.4910
INFO:root:validate average_precision, 0.7330
INFO:root:validate roc_auc, 0.7995
INFO:root:new node validate loss: 0.7536
INFO:root:new node validate average_precision, 0.5405
INFO:root:new node validate roc_auc, 0.5191
INFO:root:Epoch: 16, learning rate: 0.00015358267949793335, train loss: 0.5029
INFO:root:train average_precision, 0.6984
INFO:root:train roc_auc, 0.7680
INFO:root:validate loss: 0.4829
INFO:root:validate average_precision, 0.7344
INFO:root:validate roc_auc, 0.8030
INFO:root:new node validate loss: 0.7514
INFO:root:new node validate average_precision, 0.5657
INFO:root:new node validate roc_auc, 0.5481
INFO:root:Epoch: 17, learning rate: 7.21008893960603e-05, train loss: 0.4989
INFO:root:train average_precision, 0.6982
INFO:root:train roc_auc, 0.7704
INFO:root:validate loss: 0.4737
INFO:root:validate average_precision, 0.7339
INFO:root:validate roc_auc, 0.8050
INFO:root:new node validate loss: 0.7633
INFO:root:new node validate average_precision, 0.5731
INFO:root:new node validate roc_auc, 0.5629
INFO:root:Epoch: 18, learning rate: 9.517294753399618e-06, train loss: 0.5036
INFO:root:train average_precision, 0.6985
INFO:root:train roc_auc, 0.7704
INFO:root:validate loss: 0.4778
INFO:root:validate average_precision, 0.7353
INFO:root:validate roc_auc, 0.8062
INFO:root:new node validate loss: 0.7750
INFO:root:new node validate average_precision, 0.5402
INFO:root:new node validate roc_auc, 0.5447
INFO:root:Epoch: 19, learning rate: 8.224537431604012e-06, train loss: 0.5005
INFO:root:train average_precision, 0.7011
INFO:root:train roc_auc, 0.7712
INFO:root:validate loss: 0.4691
INFO:root:validate average_precision, 0.7390
INFO:root:validate roc_auc, 0.8070
INFO:root:new node validate loss: 0.7671
INFO:root:new node validate average_precision, 0.5717
INFO:root:new node validate roc_auc, 0.5615
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 20, learning rate: 6.909830056255193e-05, train loss: 0.4991
INFO:root:train average_precision, 0.7036
INFO:root:train roc_auc, 0.7723
INFO:root:validate loss: 0.4880
INFO:root:validate average_precision, 0.7339
INFO:root:validate roc_auc, 0.8006
INFO:root:new node validate loss: 0.7642
INFO:root:new node validate average_precision, 0.5480
INFO:root:new node validate roc_auc, 0.5344
INFO:root:test loss: 0.4863
INFO:root:test average_precision, 0.7443
INFO:root:test roc_auc, 0.8108
INFO:root:new node test loss: 0.7327
INFO:root:new node test average_precision, 0.5564
INFO:root:new node test roc_auc, 0.5750
INFO:root:Epoch: 21, learning rate: 0.00015090414157507186, train loss: 0.5023
INFO:root:train average_precision, 0.7004
INFO:root:train roc_auc, 0.7682
INFO:root:validate loss: 0.4833
INFO:root:validate average_precision, 0.7329
INFO:root:validate roc_auc, 0.7985
INFO:root:new node validate loss: 0.7574
INFO:root:new node validate average_precision, 0.5604
INFO:root:new node validate roc_auc, 0.5280
INFO:root:Epoch: 22, learning rate: 0.00019822872507282462, train loss: 0.4983
INFO:root:train average_precision, 0.7055
INFO:root:train roc_auc, 0.7730
INFO:root:validate loss: 0.4774
INFO:root:validate average_precision, 0.7329
INFO:root:validate roc_auc, 0.8021
INFO:root:new node validate loss: 0.7477
INFO:root:new node validate average_precision, 0.5172
INFO:root:new node validate roc_auc, 0.5176
INFO:root:Epoch: 23, learning rate: 0.00017901550123764875, train loss: 0.4982
INFO:root:train average_precision, 0.7034
INFO:root:train roc_auc, 0.7723
INFO:root:validate loss: 0.4817
INFO:root:validate average_precision, 0.7328
INFO:root:validate roc_auc, 0.8003
INFO:root:new node validate loss: 0.7504
INFO:root:new node validate average_precision, 0.5617
INFO:root:new node validate roc_auc, 0.5408
INFO:root:Epoch: 24, learning rate: 0.00010627905195293241, train loss: 0.4988
INFO:root:train average_precision, 0.7040
INFO:root:train roc_auc, 0.7739
INFO:root:validate loss: 0.4762
INFO:root:validate average_precision, 0.7348
INFO:root:validate roc_auc, 0.8031
INFO:root:new node validate loss: 0.7501
INFO:root:new node validate average_precision, 0.5742
INFO:root:new node validate roc_auc, 0.5542
INFO:root:Epoch: 25, learning rate: 2.928932188133125e-05, train loss: 0.4991
INFO:root:train average_precision, 0.6993
INFO:root:train roc_auc, 0.7711
INFO:root:validate loss: 0.4632
INFO:root:validate average_precision, 0.7315
INFO:root:validate roc_auc, 0.8054
INFO:root:new node validate loss: 0.7522
INFO:root:new node validate average_precision, 0.5471
INFO:root:new node validate roc_auc, 0.5473
INFO:root:Epoch: 26, learning rate: 1.9732715717278847e-07, train loss: 0.4984
INFO:root:train average_precision, 0.7017
INFO:root:train roc_auc, 0.7716
INFO:root:validate loss: 0.4638
INFO:root:validate average_precision, 0.7379
INFO:root:validate roc_auc, 0.8082
INFO:root:new node validate loss: 0.7469
INFO:root:new node validate average_precision, 0.5741
INFO:root:new node validate roc_auc, 0.5663
INFO:root:Epoch: 27, learning rate: 3.870929463473711e-05, train loss: 0.4960
INFO:root:train average_precision, 0.7063
INFO:root:train roc_auc, 0.7742
INFO:root:validate loss: 0.4716
INFO:root:validate average_precision, 0.7345
INFO:root:validate roc_auc, 0.8040
INFO:root:new node validate loss: 0.7532
INFO:root:new node validate average_precision, 0.5558
INFO:root:new node validate roc_auc, 0.5573
INFO:root:Epoch: 28, learning rate: 0.00011873813145862787, train loss: 0.4980
INFO:root:train average_precision, 0.7037
INFO:root:train roc_auc, 0.7720
INFO:root:validate loss: 0.4773
INFO:root:validate average_precision, 0.7341
INFO:root:validate roc_auc, 0.8008
INFO:root:new node validate loss: 0.7434
INFO:root:new node validate average_precision, 0.5777
INFO:root:new node validate roc_auc, 0.5563
INFO:root:Epoch: 29, learning rate: 0.00018607420270039493, train loss: 0.4994
INFO:root:train average_precision, 0.7037
INFO:root:train roc_auc, 0.7715
INFO:root:validate loss: 0.4808
INFO:root:validate average_precision, 0.7324
INFO:root:validate roc_auc, 0.7996
INFO:root:new node validate loss: 0.7255
INFO:root:new node validate average_precision, 0.5749
INFO:root:new node validate roc_auc, 0.5561
INFO:root:Epoch: 30, learning rate: 0.00019510565162977856, train loss: 0.4912
INFO:root:train average_precision, 0.7085
INFO:root:train roc_auc, 0.7766
INFO:root:validate loss: 0.4744
INFO:root:validate average_precision, 0.7341
INFO:root:validate roc_auc, 0.8019
INFO:root:new node validate loss: 0.7368
INFO:root:new node validate average_precision, 0.5621
INFO:root:new node validate roc_auc, 0.5439
INFO:root:test loss: 0.4714
INFO:root:test average_precision, 0.7485
INFO:root:test roc_auc, 0.8134
INFO:root:new node test loss: 0.7419
INFO:root:new node test average_precision, 0.5651
INFO:root:new node test roc_auc, 0.5778
INFO:root:Epoch: 31, learning rate: 0.000139714789063601, train loss: 0.4959
INFO:root:train average_precision, 0.7004
INFO:root:train roc_auc, 0.7719
INFO:root:validate loss: 0.4698
INFO:root:validate average_precision, 0.7377
INFO:root:validate roc_auc, 0.8062
INFO:root:new node validate loss: 0.7226
INFO:root:new node validate average_precision, 0.5746
INFO:root:new node validate roc_auc, 0.5643
INFO:root:Epoch: 32, learning rate: 5.7422070843516444e-05, train loss: 0.4990
INFO:root:train average_precision, 0.6997
INFO:root:train roc_auc, 0.7702
INFO:root:validate loss: 0.4683
INFO:root:validate average_precision, 0.7366
INFO:root:validate roc_auc, 0.8072
INFO:root:new node validate loss: 0.7423
INFO:root:new node validate average_precision, 0.5594
INFO:root:new node validate roc_auc, 0.5632
INFO:root:Epoch: 33, learning rate: 3.970631432305205e-06, train loss: 0.4969
INFO:root:train average_precision, 0.7017
INFO:root:train roc_auc, 0.7718
INFO:root:validate loss: 0.4650
INFO:root:validate average_precision, 0.7392
INFO:root:validate roc_auc, 0.8093
INFO:root:new node validate loss: 0.7437
INFO:root:new node validate average_precision, 0.5559
INFO:root:new node validate roc_auc, 0.5619
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 34, learning rate: 1.556720744979912e-05, train loss: 0.4984
INFO:root:train average_precision, 0.7015
INFO:root:train roc_auc, 0.7703
INFO:root:validate loss: 0.4670
INFO:root:validate average_precision, 0.7351
INFO:root:validate roc_auc, 0.8037
INFO:root:new node validate loss: 0.7588
INFO:root:new node validate average_precision, 0.5597
INFO:root:new node validate roc_auc, 0.5582
INFO:root:Epoch: 35, learning rate: 8.43565534959395e-05, train loss: 0.4959
INFO:root:train average_precision, 0.7065
INFO:root:train roc_auc, 0.7737
INFO:root:validate loss: 0.4841
INFO:root:validate average_precision, 0.7351
INFO:root:validate roc_auc, 0.8002
INFO:root:new node validate loss: 0.7339
INFO:root:new node validate average_precision, 0.5771
INFO:root:new node validate roc_auc, 0.5572
INFO:root:Epoch: 36, learning rate: 0.00016374239897501834, train loss: 0.4954
INFO:root:train average_precision, 0.7079
INFO:root:train roc_auc, 0.7756
INFO:root:validate loss: 0.4863
INFO:root:validate average_precision, 0.7282
INFO:root:validate roc_auc, 0.7948
INFO:root:new node validate loss: 0.7521
INFO:root:new node validate average_precision, 0.5437
INFO:root:new node validate roc_auc, 0.5322
INFO:root:Epoch: 37, learning rate: 0.00019995065603666313, train loss: 0.4952
INFO:root:train average_precision, 0.7070
INFO:root:train roc_auc, 0.7740
INFO:root:validate loss: 0.4831
INFO:root:validate average_precision, 0.7287
INFO:root:validate roc_auc, 0.7949
INFO:root:new node validate loss: 0.7421
INFO:root:new node validate average_precision, 0.5508
INFO:root:new node validate roc_auc, 0.5395
INFO:root:Epoch: 38, learning rate: 0.00016845471059286798, train loss: 0.4939
INFO:root:train average_precision, 0.7074
INFO:root:train roc_auc, 0.7748
INFO:root:validate loss: 0.4814
INFO:root:validate average_precision, 0.7363
INFO:root:validate roc_auc, 0.8036
INFO:root:new node validate loss: 0.7328
INFO:root:new node validate average_precision, 0.5798
INFO:root:new node validate roc_auc, 0.5698
INFO:root:Epoch: 39, learning rate: 9.0589168668107e-05, train loss: 0.4977
INFO:root:train average_precision, 0.7029
INFO:root:train roc_auc, 0.7701
INFO:root:validate loss: 0.4728
INFO:root:validate average_precision, 0.7364
INFO:root:validate roc_auc, 0.8039
INFO:root:new node validate loss: 0.7345
INFO:root:new node validate average_precision, 0.5760
INFO:root:new node validate roc_auc, 0.5734
INFO:root:Epoch: 40, learning rate: 1.9098300562492276e-05, train loss: 0.4984
INFO:root:train average_precision, 0.7012
INFO:root:train roc_auc, 0.7712
INFO:root:validate loss: 0.4649
INFO:root:validate average_precision, 0.7379
INFO:root:validate roc_auc, 0.8086
INFO:root:new node validate loss: 0.7495
INFO:root:new node validate average_precision, 0.5638
INFO:root:new node validate roc_auc, 0.5725
INFO:root:test loss: 0.4845
INFO:root:test average_precision, 0.7470
INFO:root:test roc_auc, 0.8135
INFO:root:new node test loss: 0.7953
INFO:root:new node test average_precision, 0.5555
INFO:root:new node test roc_auc, 0.5690
INFO:root:Epoch: 41, learning rate: 2.4083238061241416e-06, train loss: 0.4940
INFO:root:train average_precision, 0.7030
INFO:root:train roc_auc, 0.7723
INFO:root:validate loss: 0.4656
INFO:root:validate average_precision, 0.7405
INFO:root:validate roc_auc, 0.8079
INFO:root:new node validate loss: 0.7262
INFO:root:new node validate average_precision, 0.5895
INFO:root:new node validate roc_auc, 0.5811
INFO:root:Epoch: 42, learning rate: 5.182463258977168e-05, train loss: 0.4949
INFO:root:train average_precision, 0.7053
INFO:root:train roc_auc, 0.7738
INFO:root:validate loss: 0.4774
INFO:root:validate average_precision, 0.7296
INFO:root:validate roc_auc, 0.7994
INFO:root:new node validate loss: 0.7352
INFO:root:new node validate average_precision, 0.5428
INFO:root:new node validate roc_auc, 0.5521
INFO:root:Epoch: 43, learning rate: 0.00013387379202480098, train loss: 0.4946
INFO:root:train average_precision, 0.7072
INFO:root:train roc_auc, 0.7740
INFO:root:validate loss: 0.4807
INFO:root:validate average_precision, 0.7279
INFO:root:validate roc_auc, 0.7968
INFO:root:new node validate loss: 0.7209
INFO:root:new node validate average_precision, 0.5458
INFO:root:new node validate roc_auc, 0.5500
INFO:root:Epoch: 44, learning rate: 0.0001929776485891291, train loss: 0.4928
INFO:root:train average_precision, 0.7020
INFO:root:train roc_auc, 0.7717
INFO:root:validate loss: 0.4743
INFO:root:validate average_precision, 0.7239
INFO:root:validate roc_auc, 0.7938
INFO:root:new node validate loss: 0.7227
INFO:root:new node validate average_precision, 0.5251
INFO:root:new node validate roc_auc, 0.5119
INFO:root:Epoch: 45, learning rate: 0.00018910065241904827, train loss: 0.4953
INFO:root:train average_precision, 0.7000
INFO:root:train roc_auc, 0.7694
INFO:root:validate loss: 0.4807
INFO:root:validate average_precision, 0.7313
INFO:root:validate roc_auc, 0.8004
INFO:root:new node validate loss: 0.7312
INFO:root:new node validate average_precision, 0.5574
INFO:root:new node validate roc_auc, 0.5524
INFO:root:Epoch: 46, learning rate: 0.0001248689887165679, train loss: 0.4954
INFO:root:train average_precision, 0.6991
INFO:root:train roc_auc, 0.7702
INFO:root:validate loss: 0.4698
INFO:root:validate average_precision, 0.7345
INFO:root:validate roc_auc, 0.8055
INFO:root:new node validate loss: 0.7400
INFO:root:new node validate average_precision, 0.5620
INFO:root:new node validate roc_auc, 0.5611
INFO:root:Epoch: 47, learning rate: 4.379166221479566e-05, train loss: 0.4964
INFO:root:train average_precision, 0.6976
INFO:root:train roc_auc, 0.7684
INFO:root:validate loss: 0.4625
INFO:root:validate average_precision, 0.7388
INFO:root:validate roc_auc, 0.8098
INFO:root:new node validate loss: 0.7270
INFO:root:new node validate average_precision, 0.5673
INFO:root:new node validate roc_auc, 0.5746
INFO:root:Epoch: 48, learning rate: 7.885298685523015e-07, train loss: 0.4936
INFO:root:train average_precision, 0.7037
INFO:root:train roc_auc, 0.7732
INFO:root:validate loss: 0.4609
INFO:root:validate average_precision, 0.7360
INFO:root:validate roc_auc, 0.8084
INFO:root:new node validate loss: 0.7278
INFO:root:new node validate average_precision, 0.5652
INFO:root:new node validate roc_auc, 0.5766
INFO:root:Epoch: 49, learning rate: 2.498889303694848e-05, train loss: 0.4979
INFO:root:train average_precision, 0.6994
INFO:root:train roc_auc, 0.7689
INFO:root:validate loss: 0.4657
INFO:root:validate average_precision, 0.7329
INFO:root:validate roc_auc, 0.8051
INFO:root:new node validate loss: 0.7398
INFO:root:new node validate average_precision, 0.5492
INFO:root:new node validate roc_auc, 0.5578
INFO:root:Epoch: 50, learning rate: 0.00010000000000011486, train loss: 0.4894
INFO:root:train average_precision, 0.7103
INFO:root:train roc_auc, 0.7781
INFO:root:validate loss: 0.4782
INFO:root:validate average_precision, 0.7328
INFO:root:validate roc_auc, 0.8009
INFO:root:new node validate loss: 0.7284
INFO:root:new node validate average_precision, 0.5529
INFO:root:new node validate roc_auc, 0.5496
INFO:root:test loss: 0.4983
INFO:root:test average_precision, 0.7335
INFO:root:test roc_auc, 0.8038
INFO:root:new node test loss: 0.7624
INFO:root:new node test average_precision, 0.5539
INFO:root:new node test roc_auc, 0.5723
INFO:root:Epoch: 51, learning rate: 0.00017501110696348246, train loss: 0.4907
INFO:root:train average_precision, 0.7114
INFO:root:train roc_auc, 0.7778
INFO:root:validate loss: 0.4736
INFO:root:validate average_precision, 0.7306
INFO:root:validate roc_auc, 0.7989
INFO:root:new node validate loss: 0.7211
INFO:root:new node validate average_precision, 0.5511
INFO:root:new node validate roc_auc, 0.5452
INFO:root:Epoch: 52, learning rate: 0.0001992114701314927, train loss: 0.4919
INFO:root:train average_precision, 0.7046
INFO:root:train roc_auc, 0.7731
INFO:root:validate loss: 0.4929
INFO:root:validate average_precision, 0.7338
INFO:root:validate roc_auc, 0.7994
INFO:root:new node validate loss: 0.7234
INFO:root:new node validate average_precision, 0.5851
INFO:root:new node validate roc_auc, 0.5762
INFO:root:Epoch: 53, learning rate: 0.0001562083377854611, train loss: 0.4918
INFO:root:train average_precision, 0.7073
INFO:root:train roc_auc, 0.7756
INFO:root:validate loss: 0.4707
INFO:root:validate average_precision, 0.7404
INFO:root:validate roc_auc, 0.8094
INFO:root:new node validate loss: 0.7152
INFO:root:new node validate average_precision, 0.5885
INFO:root:new node validate roc_auc, 0.5861
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 54, learning rate: 7.513101128346403e-05, train loss: 0.4939
INFO:root:train average_precision, 0.7042
INFO:root:train roc_auc, 0.7740
INFO:root:validate loss: 0.4709
INFO:root:validate average_precision, 0.7411
INFO:root:validate roc_auc, 0.8086
INFO:root:new node validate loss: 0.7349
INFO:root:new node validate average_precision, 0.5906
INFO:root:new node validate roc_auc, 0.5874
INFO:root:Epoch: 55, learning rate: 1.0899347581169677e-05, train loss: 0.4951
INFO:root:train average_precision, 0.7016
INFO:root:train roc_auc, 0.7715
INFO:root:validate loss: 0.4602
INFO:root:validate average_precision, 0.7395
INFO:root:validate roc_auc, 0.8089
INFO:root:new node validate loss: 0.7217
INFO:root:new node validate average_precision, 0.5909
INFO:root:new node validate roc_auc, 0.5939
INFO:root:Epoch: 56, learning rate: 7.022351411181132e-06, train loss: 0.4906
INFO:root:train average_precision, 0.7055
INFO:root:train roc_auc, 0.7750
INFO:root:validate loss: 0.4606
INFO:root:validate average_precision, 0.7318
INFO:root:validate roc_auc, 0.8044
INFO:root:new node validate loss: 0.7322
INFO:root:new node validate average_precision, 0.5478
INFO:root:new node validate roc_auc, 0.5560
INFO:root:Epoch: 57, learning rate: 6.612620797562036e-05, train loss: 0.4894
INFO:root:train average_precision, 0.7076
INFO:root:train roc_auc, 0.7769
INFO:root:validate loss: 0.4737
INFO:root:validate average_precision, 0.7307
INFO:root:validate roc_auc, 0.8008
INFO:root:new node validate loss: 0.7300
INFO:root:new node validate average_precision, 0.5674
INFO:root:new node validate roc_auc, 0.5551
INFO:root:Epoch: 58, learning rate: 0.00014817536741017415, train loss: 0.4920
INFO:root:train average_precision, 0.7068
INFO:root:train roc_auc, 0.7758
INFO:root:validate loss: 0.4775
INFO:root:validate average_precision, 0.7298
INFO:root:validate roc_auc, 0.8013
INFO:root:new node validate loss: 0.7239
INFO:root:new node validate average_precision, 0.5405
INFO:root:new node validate roc_auc, 0.5452
INFO:root:Epoch: 59, learning rate: 0.0001975916761941429, train loss: 0.4877
INFO:root:train average_precision, 0.7091
INFO:root:train roc_auc, 0.7783
INFO:root:validate loss: 0.4832
INFO:root:validate average_precision, 0.7323
INFO:root:validate roc_auc, 0.7994
INFO:root:new node validate loss: 0.7334
INFO:root:new node validate average_precision, 0.5715
INFO:root:new node validate roc_auc, 0.5488
INFO:root:Epoch: 60, learning rate: 0.00018090169943733105, train loss: 0.4875
INFO:root:train average_precision, 0.7079
INFO:root:train roc_auc, 0.7764
INFO:root:validate loss: 0.4807
INFO:root:validate average_precision, 0.7327
INFO:root:validate roc_auc, 0.8044
INFO:root:new node validate loss: 0.7191
INFO:root:new node validate average_precision, 0.5604
INFO:root:new node validate roc_auc, 0.5706
INFO:root:test loss: 0.4849
INFO:root:test average_precision, 0.7379
INFO:root:test roc_auc, 0.8094
INFO:root:new node test loss: 0.7492
INFO:root:new node test average_precision, 0.5657
INFO:root:new node test roc_auc, 0.5807
INFO:root:Epoch: 61, learning rate: 0.00010941083133190251, train loss: 0.4931
INFO:root:train average_precision, 0.7053
INFO:root:train roc_auc, 0.7729
INFO:root:validate loss: 0.4666
INFO:root:validate average_precision, 0.7400
INFO:root:validate roc_auc, 0.8093
INFO:root:new node validate loss: 0.7231
INFO:root:new node validate average_precision, 0.5813
INFO:root:new node validate roc_auc, 0.5784
INFO:root:Epoch: 62, learning rate: 3.154528940706994e-05, train loss: 0.4885
INFO:root:train average_precision, 0.7103
INFO:root:train roc_auc, 0.7776
INFO:root:validate loss: 0.4619
INFO:root:validate average_precision, 0.7385
INFO:root:validate roc_auc, 0.8097
INFO:root:new node validate loss: 0.7256
INFO:root:new node validate average_precision, 0.5542
INFO:root:new node validate roc_auc, 0.5709
INFO:root:Epoch: 63, learning rate: 4.934396342683992e-08, train loss: 0.4909
INFO:root:train average_precision, 0.7093
INFO:root:train roc_auc, 0.7772
INFO:root:validate loss: 0.4565
INFO:root:validate average_precision, 0.7368
INFO:root:validate roc_auc, 0.8082
INFO:root:new node validate loss: 0.7292
INFO:root:new node validate average_precision, 0.5153
INFO:root:new node validate roc_auc, 0.5269
INFO:root:Epoch: 64, learning rate: 3.6257601025118355e-05, train loss: 0.4857
INFO:root:train average_precision, 0.7106
INFO:root:train roc_auc, 0.7793
INFO:root:validate loss: 0.4689
INFO:root:validate average_precision, 0.7330
INFO:root:validate roc_auc, 0.8017
INFO:root:new node validate loss: 0.7368
INFO:root:new node validate average_precision, 0.5422
INFO:root:new node validate roc_auc, 0.5339
INFO:root:Epoch: 65, learning rate: 0.00011564344650412834, train loss: 0.4866
INFO:root:train average_precision, 0.7119
INFO:root:train roc_auc, 0.7791
INFO:root:validate loss: 0.5058
INFO:root:validate average_precision, 0.7096
INFO:root:validate roc_auc, 0.7734
INFO:root:new node validate loss: 0.7420
INFO:root:new node validate average_precision, 0.5632
INFO:root:new node validate roc_auc, 0.5267
INFO:root:Epoch: 66, learning rate: 0.00018443279254995456, train loss: 0.4927
INFO:root:train average_precision, 0.7055
INFO:root:train roc_auc, 0.7730
INFO:root:validate loss: 0.4725
INFO:root:validate average_precision, 0.7230
INFO:root:validate roc_auc, 0.7982
INFO:root:new node validate loss: 0.7296
INFO:root:new node validate average_precision, 0.5127
INFO:root:new node validate roc_auc, 0.5263
INFO:root:Epoch: 67, learning rate: 0.00019602936856839986, train loss: 0.4865
INFO:root:train average_precision, 0.7065
INFO:root:train roc_auc, 0.7754
INFO:root:validate loss: 0.5031
INFO:root:validate average_precision, 0.7083
INFO:root:validate roc_auc, 0.7714
INFO:root:new node validate loss: 0.7347
INFO:root:new node validate average_precision, 0.5516
INFO:root:new node validate roc_auc, 0.5477
INFO:root:Epoch: 68, learning rate: 0.00014257792915669772, train loss: 0.4866
INFO:root:train average_precision, 0.7119
INFO:root:train roc_auc, 0.7792
INFO:root:validate loss: 0.4822
INFO:root:validate average_precision, 0.7314
INFO:root:validate roc_auc, 0.8014
INFO:root:new node validate loss: 0.7346
INFO:root:new node validate average_precision, 0.5409
INFO:root:new node validate roc_auc, 0.5516
INFO:root:Epoch: 69, learning rate: 6.028521093668586e-05, train loss: 0.4921
INFO:root:train average_precision, 0.7057
INFO:root:train roc_auc, 0.7755
INFO:root:validate loss: 0.4615
INFO:root:validate average_precision, 0.7407
INFO:root:validate roc_auc, 0.8104
INFO:root:new node validate loss: 0.7126
INFO:root:new node validate average_precision, 0.5751
INFO:root:new node validate roc_auc, 0.5841
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 70, learning rate: 4.894348370486552e-06, train loss: 0.4931
INFO:root:train average_precision, 0.7029
INFO:root:train roc_auc, 0.7729
INFO:root:validate loss: 0.4660
INFO:root:validate average_precision, 0.7370
INFO:root:validate roc_auc, 0.8088
INFO:root:new node validate loss: 0.7281
INFO:root:new node validate average_precision, 0.5514
INFO:root:new node validate roc_auc, 0.5691
INFO:root:test loss: 0.4862
INFO:root:test average_precision, 0.7423
INFO:root:test roc_auc, 0.8125
INFO:root:new node test loss: 0.7793
INFO:root:new node test average_precision, 0.5540
INFO:root:new node test roc_auc, 0.5704
INFO:root:Epoch: 71, learning rate: 1.392579729961352e-05, train loss: 0.4862
INFO:root:train average_precision, 0.7074
INFO:root:train roc_auc, 0.7767
INFO:root:validate loss: 0.4630
INFO:root:validate average_precision, 0.7291
INFO:root:validate roc_auc, 0.8032
INFO:root:new node validate loss: 0.7243
INFO:root:new node validate average_precision, 0.5420
INFO:root:new node validate roc_auc, 0.5570
INFO:root:Epoch: 72, learning rate: 8.126186854157901e-05, train loss: 0.4835
INFO:root:train average_precision, 0.7095
INFO:root:train roc_auc, 0.7787
INFO:root:validate loss: 0.4680
INFO:root:validate average_precision, 0.7218
INFO:root:validate roc_auc, 0.7964
INFO:root:new node validate loss: 0.7322
INFO:root:new node validate average_precision, 0.5167
INFO:root:new node validate roc_auc, 0.5300
INFO:root:Epoch: 73, learning rate: 0.00016129070536522648, train loss: 0.4888
INFO:root:train average_precision, 0.7086
INFO:root:train roc_auc, 0.7771
INFO:root:validate loss: 0.4716
INFO:root:validate average_precision, 0.7201
INFO:root:validate roc_auc, 0.7959
INFO:root:new node validate loss: 0.7254
INFO:root:new node validate average_precision, 0.5070
INFO:root:new node validate roc_auc, 0.5144
INFO:root:Epoch: 74, learning rate: 0.00019980267284305187, train loss: 0.4870
INFO:root:train average_precision, 0.7057
INFO:root:train roc_auc, 0.7761
INFO:root:validate loss: 0.4903
INFO:root:validate average_precision, 0.7162
INFO:root:validate roc_auc, 0.7878
INFO:root:new node validate loss: 0.7309
INFO:root:new node validate average_precision, 0.5517
INFO:root:new node validate roc_auc, 0.5451
INFO:root:Epoch: 75, learning rate: 0.00017071067811846234, train loss: 0.4838
INFO:root:train average_precision, 0.7097
INFO:root:train roc_auc, 0.7788
INFO:root:validate loss: 0.4821
INFO:root:validate average_precision, 0.7280
INFO:root:validate roc_auc, 0.7999
INFO:root:new node validate loss: 0.7213
INFO:root:new node validate average_precision, 0.5455
INFO:root:new node validate roc_auc, 0.5618
INFO:root:Epoch: 76, learning rate: 9.372094804708691e-05, train loss: 0.4890
INFO:root:train average_precision, 0.7071
INFO:root:train roc_auc, 0.7753
INFO:root:validate loss: 0.4643
INFO:root:validate average_precision, 0.7346
INFO:root:validate roc_auc, 0.8048
INFO:root:new node validate loss: 0.7199
INFO:root:new node validate average_precision, 0.5564
INFO:root:new node validate roc_auc, 0.5690
INFO:root:Epoch: 77, learning rate: 2.0984498762464415e-05, train loss: 0.4892
INFO:root:train average_precision, 0.7068
INFO:root:train roc_auc, 0.7759
INFO:root:validate loss: 0.4641
INFO:root:validate average_precision, 0.7431
INFO:root:validate roc_auc, 0.8127
INFO:root:new node validate loss: 0.7236
INFO:root:new node validate average_precision, 0.5375
INFO:root:new node validate roc_auc, 0.5487
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 78, learning rate: 1.771274927134204e-06, train loss: 0.4850
INFO:root:train average_precision, 0.7107
INFO:root:train roc_auc, 0.7800
INFO:root:validate loss: 0.4623
INFO:root:validate average_precision, 0.7312
INFO:root:validate roc_auc, 0.8039
INFO:root:new node validate loss: 0.7338
INFO:root:new node validate average_precision, 0.5098
INFO:root:new node validate roc_auc, 0.5149
INFO:root:Epoch: 79, learning rate: 4.9095858424928075e-05, train loss: 0.4872
INFO:root:train average_precision, 0.7124
INFO:root:train roc_auc, 0.7804
INFO:root:validate loss: 0.4690
INFO:root:validate average_precision, 0.7284
INFO:root:validate roc_auc, 0.8000
INFO:root:new node validate loss: 0.7300
INFO:root:new node validate average_precision, 0.5205
INFO:root:new node validate roc_auc, 0.5224
INFO:root:Epoch: 80, learning rate: 0.00013090169943758348, train loss: 0.4863
INFO:root:train average_precision, 0.7122
INFO:root:train roc_auc, 0.7799
INFO:root:validate loss: 0.4827
INFO:root:validate average_precision, 0.7254
INFO:root:validate roc_auc, 0.7988
INFO:root:new node validate loss: 0.7288
INFO:root:new node validate average_precision, 0.5161
INFO:root:new node validate roc_auc, 0.5244
INFO:root:test loss: 0.4756
INFO:root:test average_precision, 0.7357
INFO:root:test roc_auc, 0.8086
INFO:root:new node test loss: 0.7425
INFO:root:new node test average_precision, 0.5451
INFO:root:new node test roc_auc, 0.5671
INFO:root:Epoch: 81, learning rate: 0.00019177546256809677, train loss: 0.4861
INFO:root:train average_precision, 0.7107
INFO:root:train roc_auc, 0.7787
INFO:root:validate loss: 0.5048
INFO:root:validate average_precision, 0.6941
INFO:root:validate roc_auc, 0.7583
INFO:root:new node validate loss: 0.7437
INFO:root:new node validate average_precision, 0.5320
INFO:root:new node validate roc_auc, 0.5184
INFO:root:Epoch: 82, learning rate: 0.00019048270524724283, train loss: 0.4913
INFO:root:train average_precision, 0.7072
INFO:root:train roc_auc, 0.7754
INFO:root:validate loss: 0.5040
INFO:root:validate average_precision, 0.6695
INFO:root:validate roc_auc, 0.7426
INFO:root:new node validate loss: 0.7326
INFO:root:new node validate average_precision, 0.5411
INFO:root:new node validate roc_auc, 0.5373
INFO:root:Epoch: 83, learning rate: 0.0001278991106040657, train loss: 0.4860
INFO:root:train average_precision, 0.7109
INFO:root:train roc_auc, 0.7799
INFO:root:validate loss: 0.4752
INFO:root:validate average_precision, 0.7365
INFO:root:validate roc_auc, 0.8068
INFO:root:new node validate loss: 0.7280
INFO:root:new node validate average_precision, 0.5635
INFO:root:new node validate roc_auc, 0.5744
INFO:root:Epoch: 84, learning rate: 4.641732050221234e-05, train loss: 0.4938
INFO:root:train average_precision, 0.7045
INFO:root:train roc_auc, 0.7740
INFO:root:validate loss: 0.4578
INFO:root:validate average_precision, 0.7446
INFO:root:validate roc_auc, 0.8144
INFO:root:new node validate loss: 0.7214
INFO:root:new node validate average_precision, 0.5463
INFO:root:new node validate roc_auc, 0.5577
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 85, learning rate: 1.231165940486511e-06, train loss: 0.4875
INFO:root:train average_precision, 0.7107
INFO:root:train roc_auc, 0.7809
INFO:root:validate loss: 0.4692
INFO:root:validate average_precision, 0.7417
INFO:root:validate roc_auc, 0.8112
INFO:root:new node validate loss: 0.7376
INFO:root:new node validate average_precision, 0.5224
INFO:root:new node validate roc_auc, 0.5361
INFO:root:Epoch: 86, learning rate: 2.294867572242764e-05, train loss: 0.4854
INFO:root:train average_precision, 0.7127
INFO:root:train roc_auc, 0.7808
INFO:root:validate loss: 0.4629
INFO:root:validate average_precision, 0.7318
INFO:root:validate roc_auc, 0.8052
INFO:root:new node validate loss: 0.7289
INFO:root:new node validate average_precision, 0.5315
INFO:root:new node validate roc_auc, 0.5377
INFO:root:Epoch: 87, learning rate: 9.685892409233848e-05, train loss: 0.4836
INFO:root:train average_precision, 0.7121
INFO:root:train roc_auc, 0.7825
INFO:root:validate loss: 0.4739
INFO:root:validate average_precision, 0.7357
INFO:root:validate roc_auc, 0.8046
INFO:root:new node validate loss: 0.7355
INFO:root:new node validate average_precision, 0.5189
INFO:root:new node validate roc_auc, 0.5153
INFO:root:Epoch: 88, learning rate: 0.0001728968627420249, train loss: 0.4852
INFO:root:train average_precision, 0.7122
INFO:root:train roc_auc, 0.7810
INFO:root:validate loss: 0.4934
INFO:root:validate average_precision, 0.7194
INFO:root:validate roc_auc, 0.7901
INFO:root:new node validate loss: 0.7330
INFO:root:new node validate average_precision, 0.5205
INFO:root:new node validate roc_auc, 0.5141
INFO:root:Epoch: 89, learning rate: 0.000199556196460443, train loss: 0.4858
INFO:root:train average_precision, 0.7127
INFO:root:train roc_auc, 0.7805
INFO:root:validate loss: 0.5102
INFO:root:validate average_precision, 0.7007
INFO:root:validate roc_auc, 0.7617
INFO:root:new node validate loss: 0.7783
INFO:root:new node validate average_precision, 0.5211
INFO:root:new node validate roc_auc, 0.5152
INFO:root:Epoch: 90, learning rate: 0.00015877852522960044, train loss: 0.4909
INFO:root:train average_precision, 0.7068
INFO:root:train roc_auc, 0.7763
INFO:root:validate loss: 0.4733
INFO:root:validate average_precision, 0.7430
INFO:root:validate roc_auc, 0.8102
INFO:root:new node validate loss: 0.7169
INFO:root:new node validate average_precision, 0.5975
INFO:root:new node validate roc_auc, 0.6006
INFO:root:test loss: 0.4743
INFO:root:test average_precision, 0.7450
INFO:root:test roc_auc, 0.8141
INFO:root:new node test loss: 0.7605
INFO:root:new node test average_precision, 0.5923
INFO:root:new node test roc_auc, 0.6132
INFO:root:Epoch: 91, learning rate: 7.818567586034398e-05, train loss: 0.4895
INFO:root:train average_precision, 0.7065
INFO:root:train roc_auc, 0.7758
INFO:root:validate loss: 0.4659
INFO:root:validate average_precision, 0.7459
INFO:root:validate roc_auc, 0.8124
INFO:root:new node validate loss: 0.7253
INFO:root:new node validate average_precision, 0.5899
INFO:root:new node validate roc_auc, 0.5926
INFO:root:Epoch: 92, learning rate: 1.2369331995628408e-05, train loss: 0.4889
INFO:root:train average_precision, 0.7101
INFO:root:train roc_auc, 0.7787
INFO:root:validate loss: 0.4674
INFO:root:validate average_precision, 0.7409
INFO:root:validate roc_auc, 0.8110
INFO:root:new node validate loss: 0.7451
INFO:root:new node validate average_precision, 0.5519
INFO:root:new node validate roc_auc, 0.5643
INFO:root:Epoch: 93, learning rate: 5.911923104585612e-06, train loss: 0.4877
INFO:root:train average_precision, 0.7120
INFO:root:train roc_auc, 0.7789
INFO:root:validate loss: 0.4605
INFO:root:validate average_precision, 0.7328
INFO:root:validate roc_auc, 0.8056
INFO:root:new node validate loss: 0.7292
INFO:root:new node validate average_precision, 0.5362
INFO:root:new node validate roc_auc, 0.5505
INFO:root:Epoch: 94, learning rate: 6.318754473147785e-05, train loss: 0.4872
INFO:root:train average_precision, 0.7085
INFO:root:train roc_auc, 0.7769
INFO:root:validate loss: 0.4702
INFO:root:validate average_precision, 0.7317
INFO:root:validate roc_auc, 0.8041
INFO:root:new node validate loss: 0.7401
INFO:root:new node validate average_precision, 0.5375
INFO:root:new node validate roc_auc, 0.5488
INFO:root:Epoch: 95, learning rate: 0.00014539904997401933, train loss: 0.4859
INFO:root:train average_precision, 0.7119
INFO:root:train roc_auc, 0.7797
INFO:root:validate loss: 0.4915
INFO:root:validate average_precision, 0.7214
INFO:root:validate roc_auc, 0.7905
INFO:root:new node validate loss: 0.7362
INFO:root:new node validate average_precision, 0.5359
INFO:root:new node validate roc_auc, 0.5366
INFO:root:Epoch: 96, learning rate: 0.00019685831611321615, train loss: 0.4849
INFO:root:train average_precision, 0.7174
INFO:root:train roc_auc, 0.7823
INFO:root:validate loss: 0.4934
INFO:root:validate average_precision, 0.7072
INFO:root:validate roc_auc, 0.7785
INFO:root:new node validate loss: 0.7301
INFO:root:new node validate average_precision, 0.5457
INFO:root:new node validate roc_auc, 0.5490
INFO:root:Epoch: 97, learning rate: 0.0001827080574280297, train loss: 0.4836
INFO:root:train average_precision, 0.7158
INFO:root:train roc_auc, 0.7825
INFO:root:validate loss: 0.4866
INFO:root:validate average_precision, 0.7279
INFO:root:validate roc_auc, 0.7983
INFO:root:new node validate loss: 0.7145
INFO:root:new node validate average_precision, 0.5516
INFO:root:new node validate roc_auc, 0.5670
INFO:root:Epoch: 98, learning rate: 0.00011253332335693666, train loss: 0.4849
INFO:root:train average_precision, 0.7143
INFO:root:train roc_auc, 0.7817
INFO:root:validate loss: 0.4740
INFO:root:validate average_precision, 0.7400
INFO:root:validate roc_auc, 0.8084
INFO:root:new node validate loss: 0.7150
INFO:root:new node validate average_precision, 0.5906
INFO:root:new node validate roc_auc, 0.5963
INFO:root:Epoch: 99, learning rate: 3.386881346759156e-05, train loss: 0.4867
INFO:root:train average_precision, 0.7109
INFO:root:train roc_auc, 0.7793
INFO:root:validate loss: 0.4671
INFO:root:validate average_precision, 0.7410
INFO:root:validate roc_auc, 0.8087
INFO:root:new node validate loss: 0.7195
INFO:root:new node validate average_precision, 0.5789
INFO:root:new node validate roc_auc, 0.5794
INFO:root:Epoch: 100, learning rate: 0.0, train loss: 0.4827
INFO:root:train average_precision, 0.7128
INFO:root:train roc_auc, 0.7821
INFO:root:validate loss: 0.4659
INFO:root:validate average_precision, 0.7383
INFO:root:validate roc_auc, 0.8092
INFO:root:new node validate loss: 0.7276
INFO:root:new node validate average_precision, 0.5510
INFO:root:new node validate roc_auc, 0.5624
INFO:root:test loss: 0.4734
INFO:root:test average_precision, 0.7457
INFO:root:test roc_auc, 0.8180
INFO:root:new node test loss: 0.7734
INFO:root:new node test average_precision, 0.5565
INFO:root:new node test roc_auc, 0.5782
INFO:root:load model ./saved_models/TGN/USLegis/TGN_seed2/TGN_seed2.pkl
INFO:root:get final performance on dataset USLegis...
INFO:root:test loss: 0.4782
INFO:root:test average_precision, 0.7489
INFO:root:test roc_auc, 0.8159
INFO:root:new node test loss: 0.7644
INFO:root:new node test average_precision, 0.5576
INFO:root:new node test roc_auc, 0.5711
INFO:root:Run 3 cost 26525.78 seconds.
INFO:root:********** Run 4 starts. **********
INFO:root:configuration is Namespace(dataset_name='USLegis', batch_size=200, model_name='TGN', gpu=0, num_neighbors=20, sample_neighbor_strategy='time_interval_aware', time_scaling_factor=1e-06, num_walk_heads=8, num_heads=2, num_layers=2, walk_length=1, time_gap=2000, time_feat_dim=100, position_feat_dim=172, edge_bank_memory_mode='unlimited_memory', time_window_mode='fixed_proportion', patch_size=200, channel_embedding_dim=50, max_input_sequence_length=64, learning_rate=0.0001, dropout=0.1, num_epochs=100, optimizer='Adam', weight_decay=0.0, patience=20, val_ratio=0.15, test_ratio=0.15, num_runs=5, test_interval_epochs=10, negative_sample_strategy='random', load_best_configs=False, device='cuda:0', seed=3, save_model_name='TGN_seed3')
INFO:root:model -> Sequential(
  (0): MemoryModel(
    (src_memory_encoder): Linear(in_features=172, out_features=172, bias=True)
    (dst_memory_encoder): Linear(in_features=172, out_features=172, bias=True)
    (edge_encoder): Linear(in_features=172, out_features=172, bias=True)
    (channel_attention): ChannelAttentionTemporal(
      (avg_pool): AdaptiveAvgPool1d(output_size=1)
      (max_pool): AdaptiveMaxPool1d(output_size=1)
      (fc1): Linear(in_features=4, out_features=0, bias=False)
      (relu1): ReLU()
      (fc2): Linear(in_features=0, out_features=4, bias=False)
      (sigmoid): Sigmoid()
    )
    (time_encoder): TimeEncoder(
      (w): Linear(in_features=1, out_features=100, bias=True)
    )
    (message_aggregator): MessageAggregator()
    (memory_bank): MemoryBank(num_nodes=226, memory_dim=172)
    (memory_updater): CFCMemoryUpdater(
      (memory_bank): MemoryBank(num_nodes=226, memory_dim=172)
      (memory_updater): MoE(
        (mixer): Linear(in_features=788, out_features=616, bias=True)
        (relu): ReLU(inplace=True)
        (experts): ModuleList(
          (0-5): 6 x rnnmodule(
            (cell): GRUCell(616, 172)
            (relu): ReLU()
          )
        )
        (softplus): Softplus(beta=1.0, threshold=20.0)
        (softmax): Softmax(dim=1)
      )
    )
    (embedding_module): GraphAttentionEmbedding(
      (time_encoder): TimeEncoder(
        (w): Linear(in_features=1, out_features=100, bias=True)
      )
      (temporal_conv_layers): ModuleList(
        (0-1): 2 x MultiHeadAttention(
          (query_projection): Linear(in_features=272, out_features=272, bias=False)
          (key_projection): Linear(in_features=444, out_features=272, bias=False)
          (value_projection): Linear(in_features=444, out_features=272, bias=False)
          (layer_norm): LayerNorm((272,), eps=1e-05, elementwise_affine=True)
          (residual_fc): Linear(in_features=272, out_features=272, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (merge_layers): ModuleList(
        (0-1): 2 x MergeLayer(
          (fc1): Linear(in_features=444, out_features=172, bias=True)
          (fc2): Linear(in_features=172, out_features=172, bias=True)
          (act): ReLU()
        )
      )
    )
  )
  (1): MergeLayer(
    (fc1): Linear(in_features=344, out_features=172, bias=True)
    (fc2): Linear(in_features=172, out_features=1, bias=True)
    (act): ReLU()
  )
)
INFO:root:model name: TGN, #parameters: 16325876 B, 15943.23828125 KB, 15.569568634033203 MB.
INFO:root:Epoch: 1, learning rate: 0.00016613118653236524, train loss: 0.5864
INFO:root:train average_precision, 0.6541
INFO:root:train roc_auc, 0.7165
INFO:root:validate loss: 0.5682
INFO:root:validate average_precision, 0.7094
INFO:root:validate roc_auc, 0.7752
INFO:root:new node validate loss: 0.7185
INFO:root:new node validate average_precision, 0.5984
INFO:root:new node validate roc_auc, 0.5905
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 2, learning rate: 8.746667664356936e-05, train loss: 0.5896
INFO:root:train average_precision, 0.6403
INFO:root:train roc_auc, 0.7058
INFO:root:validate loss: 0.6184
INFO:root:validate average_precision, 0.6463
INFO:root:validate roc_auc, 0.6952
INFO:root:new node validate loss: 0.6685
INFO:root:new node validate average_precision, 0.5958
INFO:root:new node validate roc_auc, 0.5916
INFO:root:Epoch: 3, learning rate: 1.7291942572543902e-05, train loss: 0.5556
INFO:root:train average_precision, 0.6524
INFO:root:train roc_auc, 0.7213
INFO:root:validate loss: 0.5875
INFO:root:validate average_precision, 0.6598
INFO:root:validate roc_auc, 0.7117
INFO:root:new node validate loss: 0.6914
INFO:root:new node validate average_precision, 0.5856
INFO:root:new node validate roc_auc, 0.5837
INFO:root:Epoch: 4, learning rate: 3.1416838871369568e-06, train loss: 0.5399
INFO:root:train average_precision, 0.6781
INFO:root:train roc_auc, 0.7451
INFO:root:validate loss: 0.5587
INFO:root:validate average_precision, 0.7068
INFO:root:validate roc_auc, 0.7609
INFO:root:new node validate loss: 0.7177
INFO:root:new node validate average_precision, 0.5868
INFO:root:new node validate roc_auc, 0.5809
INFO:root:Epoch: 5, learning rate: 5.4600950026033074e-05, train loss: 0.5234
INFO:root:train average_precision, 0.6930
INFO:root:train roc_auc, 0.7614
INFO:root:validate loss: 0.5480
INFO:root:validate average_precision, 0.7242
INFO:root:validate roc_auc, 0.7819
INFO:root:new node validate loss: 0.8315
INFO:root:new node validate average_precision, 0.5506
INFO:root:new node validate roc_auc, 0.5398
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 6, learning rate: 0.000136812455268468, train loss: 0.5394
INFO:root:train average_precision, 0.6895
INFO:root:train roc_auc, 0.7562
INFO:root:validate loss: 0.5147
INFO:root:validate average_precision, 0.7200
INFO:root:validate roc_auc, 0.7849
INFO:root:new node validate loss: 0.7731
INFO:root:new node validate average_precision, 0.5443
INFO:root:new node validate roc_auc, 0.5460
INFO:root:Epoch: 7, learning rate: 0.00019408807689546632, train loss: 0.5134
INFO:root:train average_precision, 0.6921
INFO:root:train roc_auc, 0.7603
INFO:root:validate loss: 0.5026
INFO:root:validate average_precision, 0.7302
INFO:root:validate roc_auc, 0.7964
INFO:root:new node validate loss: 0.7553
INFO:root:new node validate average_precision, 0.5787
INFO:root:new node validate roc_auc, 0.5753
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 8, learning rate: 0.00018763066800442832, train loss: 0.5154
INFO:root:train average_precision, 0.6935
INFO:root:train roc_auc, 0.7610
INFO:root:validate loss: 0.4989
INFO:root:validate average_precision, 0.7291
INFO:root:validate roc_auc, 0.7948
INFO:root:new node validate loss: 0.7838
INFO:root:new node validate average_precision, 0.5334
INFO:root:new node validate roc_auc, 0.5326
INFO:root:Epoch: 9, learning rate: 0.0001218143241396262, train loss: 0.5168
INFO:root:train average_precision, 0.6927
INFO:root:train roc_auc, 0.7617
INFO:root:validate loss: 0.5040
INFO:root:validate average_precision, 0.7308
INFO:root:validate roc_auc, 0.7965
INFO:root:new node validate loss: 0.7346
INFO:root:new node validate average_precision, 0.5955
INFO:root:new node validate roc_auc, 0.5730
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 10, learning rate: 4.1221474770761954e-05, train loss: 0.5469
INFO:root:train average_precision, 0.6581
INFO:root:train roc_auc, 0.7280
INFO:root:validate loss: 0.5470
INFO:root:validate average_precision, 0.7034
INFO:root:validate roc_auc, 0.7676
INFO:root:new node validate loss: 0.6974
INFO:root:new node validate average_precision, 0.5506
INFO:root:new node validate roc_auc, 0.5651
INFO:root:test loss: 0.5522
INFO:root:test average_precision, 0.7192
INFO:root:test roc_auc, 0.7831
INFO:root:new node test loss: 0.7136
INFO:root:new node test average_precision, 0.5445
INFO:root:new node test roc_auc, 0.5571
INFO:root:Epoch: 11, learning rate: 4.438035396920891e-07, train loss: 0.5090
INFO:root:train average_precision, 0.6887
INFO:root:train roc_auc, 0.7634
INFO:root:validate loss: 0.4828
INFO:root:validate average_precision, 0.7340
INFO:root:validate roc_auc, 0.8051
INFO:root:new node validate loss: 0.7976
INFO:root:new node validate average_precision, 0.5139
INFO:root:new node validate roc_auc, 0.5288
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 12, learning rate: 2.71031372578646e-05, train loss: 0.5087
INFO:root:train average_precision, 0.7001
INFO:root:train roc_auc, 0.7717
INFO:root:validate loss: 0.4983
INFO:root:validate average_precision, 0.7297
INFO:root:validate roc_auc, 0.7975
INFO:root:new node validate loss: 0.7716
INFO:root:new node validate average_precision, 0.5681
INFO:root:new node validate roc_auc, 0.5466
INFO:root:Epoch: 13, learning rate: 0.00010314107590778983, train loss: 0.5110
INFO:root:train average_precision, 0.6961
INFO:root:train roc_auc, 0.7680
INFO:root:validate loss: 0.4940
INFO:root:validate average_precision, 0.7279
INFO:root:validate roc_auc, 0.7947
INFO:root:new node validate loss: 0.7596
INFO:root:new node validate average_precision, 0.5652
INFO:root:new node validate roc_auc, 0.5440
INFO:root:Epoch: 14, learning rate: 0.00017705132427761958, train loss: 0.5057
INFO:root:train average_precision, 0.7016
INFO:root:train roc_auc, 0.7695
INFO:root:validate loss: 0.5011
INFO:root:validate average_precision, 0.7268
INFO:root:validate roc_auc, 0.7932
INFO:root:new node validate loss: 0.7709
INFO:root:new node validate average_precision, 0.5379
INFO:root:new node validate roc_auc, 0.5262
INFO:root:Epoch: 15, learning rate: 0.00019876883405964778, train loss: 0.5040
INFO:root:train average_precision, 0.7011
INFO:root:train roc_auc, 0.7703
INFO:root:validate loss: 0.4814
INFO:root:validate average_precision, 0.7341
INFO:root:validate roc_auc, 0.8000
INFO:root:new node validate loss: 0.7471
INFO:root:new node validate average_precision, 0.5757
INFO:root:new node validate roc_auc, 0.5441
INFO:root:Epoch: 16, learning rate: 0.00015358267949793335, train loss: 0.5020
INFO:root:train average_precision, 0.6967
INFO:root:train roc_auc, 0.7683
INFO:root:validate loss: 0.4829
INFO:root:validate average_precision, 0.7339
INFO:root:validate roc_auc, 0.8007
INFO:root:new node validate loss: 0.7532
INFO:root:new node validate average_precision, 0.5731
INFO:root:new node validate roc_auc, 0.5459
INFO:root:Epoch: 17, learning rate: 7.21008893960603e-05, train loss: 0.5010
INFO:root:train average_precision, 0.7005
INFO:root:train roc_auc, 0.7725
INFO:root:validate loss: 0.4768
INFO:root:validate average_precision, 0.7358
INFO:root:validate roc_auc, 0.8064
INFO:root:new node validate loss: 0.7808
INFO:root:new node validate average_precision, 0.5420
INFO:root:new node validate roc_auc, 0.5418
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 18, learning rate: 9.517294753399618e-06, train loss: 0.5025
INFO:root:train average_precision, 0.6987
INFO:root:train roc_auc, 0.7693
INFO:root:validate loss: 0.4638
INFO:root:validate average_precision, 0.7361
INFO:root:validate roc_auc, 0.8083
INFO:root:new node validate loss: 0.7641
INFO:root:new node validate average_precision, 0.5651
INFO:root:new node validate roc_auc, 0.5623
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 19, learning rate: 8.224537431604012e-06, train loss: 0.5008
INFO:root:train average_precision, 0.7012
INFO:root:train roc_auc, 0.7727
INFO:root:validate loss: 0.4649
INFO:root:validate average_precision, 0.7381
INFO:root:validate roc_auc, 0.8078
INFO:root:new node validate loss: 0.7478
INFO:root:new node validate average_precision, 0.5812
INFO:root:new node validate roc_auc, 0.5734
INFO:root:Epoch: 20, learning rate: 6.909830056255193e-05, train loss: 0.4985
INFO:root:train average_precision, 0.6996
INFO:root:train roc_auc, 0.7725
INFO:root:validate loss: 0.4901
INFO:root:validate average_precision, 0.7332
INFO:root:validate roc_auc, 0.8011
INFO:root:new node validate loss: 0.7558
INFO:root:new node validate average_precision, 0.5783
INFO:root:new node validate roc_auc, 0.5592
INFO:root:test loss: 0.4852
INFO:root:test average_precision, 0.7426
INFO:root:test roc_auc, 0.8100
INFO:root:new node test loss: 0.7341
INFO:root:new node test average_precision, 0.5761
INFO:root:new node test roc_auc, 0.5926
INFO:root:Epoch: 21, learning rate: 0.00015090414157507186, train loss: 0.4995
INFO:root:train average_precision, 0.7017
INFO:root:train roc_auc, 0.7697
INFO:root:validate loss: 0.4819
INFO:root:validate average_precision, 0.7345
INFO:root:validate roc_auc, 0.8016
INFO:root:new node validate loss: 0.7383
INFO:root:new node validate average_precision, 0.5748
INFO:root:new node validate roc_auc, 0.5544
INFO:root:Epoch: 22, learning rate: 0.00019822872507282462, train loss: 0.4993
INFO:root:train average_precision, 0.7046
INFO:root:train roc_auc, 0.7722
INFO:root:validate loss: 0.4794
INFO:root:validate average_precision, 0.7349
INFO:root:validate roc_auc, 0.8046
INFO:root:new node validate loss: 0.7316
INFO:root:new node validate average_precision, 0.5502
INFO:root:new node validate roc_auc, 0.5501
INFO:root:Epoch: 23, learning rate: 0.00017901550123764875, train loss: 0.4945
INFO:root:train average_precision, 0.7074
INFO:root:train roc_auc, 0.7751
INFO:root:validate loss: 0.4799
INFO:root:validate average_precision, 0.7352
INFO:root:validate roc_auc, 0.8040
INFO:root:new node validate loss: 0.7238
INFO:root:new node validate average_precision, 0.5836
INFO:root:new node validate roc_auc, 0.5713
INFO:root:Epoch: 24, learning rate: 0.00010627905195293241, train loss: 0.5075
INFO:root:train average_precision, 0.6957
INFO:root:train roc_auc, 0.7660
INFO:root:validate loss: 0.4761
INFO:root:validate average_precision, 0.7363
INFO:root:validate roc_auc, 0.8041
INFO:root:new node validate loss: 0.7320
INFO:root:new node validate average_precision, 0.5886
INFO:root:new node validate roc_auc, 0.5694
INFO:root:Epoch: 25, learning rate: 2.928932188133125e-05, train loss: 0.5000
INFO:root:train average_precision, 0.7021
INFO:root:train roc_auc, 0.7737
INFO:root:validate loss: 0.4644
INFO:root:validate average_precision, 0.7323
INFO:root:validate roc_auc, 0.8063
INFO:root:new node validate loss: 0.7545
INFO:root:new node validate average_precision, 0.5457
INFO:root:new node validate roc_auc, 0.5518
INFO:root:Epoch: 26, learning rate: 1.9732715717278847e-07, train loss: 0.4988
INFO:root:train average_precision, 0.7005
INFO:root:train roc_auc, 0.7713
INFO:root:validate loss: 0.4594
INFO:root:validate average_precision, 0.7366
INFO:root:validate roc_auc, 0.8084
INFO:root:new node validate loss: 0.7545
INFO:root:new node validate average_precision, 0.5646
INFO:root:new node validate roc_auc, 0.5643
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 27, learning rate: 3.870929463473711e-05, train loss: 0.5001
INFO:root:train average_precision, 0.6997
INFO:root:train roc_auc, 0.7694
INFO:root:validate loss: 0.4804
INFO:root:validate average_precision, 0.7346
INFO:root:validate roc_auc, 0.8017
INFO:root:new node validate loss: 0.7539
INFO:root:new node validate average_precision, 0.5696
INFO:root:new node validate roc_auc, 0.5653
INFO:root:Epoch: 28, learning rate: 0.00011873813145862787, train loss: 0.4976
INFO:root:train average_precision, 0.7014
INFO:root:train roc_auc, 0.7705
INFO:root:validate loss: 0.4709
INFO:root:validate average_precision, 0.7355
INFO:root:validate roc_auc, 0.8037
INFO:root:new node validate loss: 0.7384
INFO:root:new node validate average_precision, 0.5481
INFO:root:new node validate roc_auc, 0.5476
INFO:root:Epoch: 29, learning rate: 0.00018607420270039493, train loss: 0.4960
INFO:root:train average_precision, 0.7053
INFO:root:train roc_auc, 0.7726
INFO:root:validate loss: 0.4772
INFO:root:validate average_precision, 0.7317
INFO:root:validate roc_auc, 0.7987
INFO:root:new node validate loss: 0.7179
INFO:root:new node validate average_precision, 0.5797
INFO:root:new node validate roc_auc, 0.5585
INFO:root:Epoch: 30, learning rate: 0.00019510565162977856, train loss: 0.4948
INFO:root:train average_precision, 0.7048
INFO:root:train roc_auc, 0.7732
INFO:root:validate loss: 0.4685
INFO:root:validate average_precision, 0.7367
INFO:root:validate roc_auc, 0.8044
INFO:root:new node validate loss: 0.7133
INFO:root:new node validate average_precision, 0.5876
INFO:root:new node validate roc_auc, 0.5727
INFO:root:test loss: 0.4818
INFO:root:test average_precision, 0.7436
INFO:root:test roc_auc, 0.8094
INFO:root:new node test loss: 0.7360
INFO:root:new node test average_precision, 0.5803
INFO:root:new node test roc_auc, 0.5899
INFO:root:Epoch: 31, learning rate: 0.000139714789063601, train loss: 0.4973
INFO:root:train average_precision, 0.7033
INFO:root:train roc_auc, 0.7732
INFO:root:validate loss: 0.4725
INFO:root:validate average_precision, 0.7352
INFO:root:validate roc_auc, 0.8033
INFO:root:new node validate loss: 0.7192
INFO:root:new node validate average_precision, 0.5851
INFO:root:new node validate roc_auc, 0.5703
INFO:root:Epoch: 32, learning rate: 5.7422070843516444e-05, train loss: 0.4979
INFO:root:train average_precision, 0.6996
INFO:root:train roc_auc, 0.7702
INFO:root:validate loss: 0.4622
INFO:root:validate average_precision, 0.7386
INFO:root:validate roc_auc, 0.8089
INFO:root:new node validate loss: 0.7295
INFO:root:new node validate average_precision, 0.5816
INFO:root:new node validate roc_auc, 0.5842
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 33, learning rate: 3.970631432305205e-06, train loss: 0.4966
INFO:root:train average_precision, 0.7030
INFO:root:train roc_auc, 0.7734
INFO:root:validate loss: 0.4659
INFO:root:validate average_precision, 0.7360
INFO:root:validate roc_auc, 0.8073
INFO:root:new node validate loss: 0.7401
INFO:root:new node validate average_precision, 0.5758
INFO:root:new node validate roc_auc, 0.5714
INFO:root:Epoch: 34, learning rate: 1.556720744979912e-05, train loss: 0.4953
INFO:root:train average_precision, 0.7044
INFO:root:train roc_auc, 0.7744
INFO:root:validate loss: 0.4611
INFO:root:validate average_precision, 0.7393
INFO:root:validate roc_auc, 0.8084
INFO:root:new node validate loss: 0.7498
INFO:root:new node validate average_precision, 0.5677
INFO:root:new node validate roc_auc, 0.5694
INFO:root:Epoch: 35, learning rate: 8.43565534959395e-05, train loss: 0.4939
INFO:root:train average_precision, 0.7068
INFO:root:train roc_auc, 0.7758
INFO:root:validate loss: 0.4695
INFO:root:validate average_precision, 0.7358
INFO:root:validate roc_auc, 0.8026
INFO:root:new node validate loss: 0.7300
INFO:root:new node validate average_precision, 0.5765
INFO:root:new node validate roc_auc, 0.5588
INFO:root:Epoch: 36, learning rate: 0.00016374239897501834, train loss: 0.4945
INFO:root:train average_precision, 0.7024
INFO:root:train roc_auc, 0.7721
INFO:root:validate loss: 0.4737
INFO:root:validate average_precision, 0.7320
INFO:root:validate roc_auc, 0.7990
INFO:root:new node validate loss: 0.7221
INFO:root:new node validate average_precision, 0.5757
INFO:root:new node validate roc_auc, 0.5526
INFO:root:Epoch: 37, learning rate: 0.00019995065603666313, train loss: 0.4937
INFO:root:train average_precision, 0.7006
INFO:root:train roc_auc, 0.7710
INFO:root:validate loss: 0.4807
INFO:root:validate average_precision, 0.7327
INFO:root:validate roc_auc, 0.7985
INFO:root:new node validate loss: 0.7222
INFO:root:new node validate average_precision, 0.5800
INFO:root:new node validate roc_auc, 0.5585
INFO:root:Epoch: 38, learning rate: 0.00016845471059286798, train loss: 0.4977
INFO:root:train average_precision, 0.6998
INFO:root:train roc_auc, 0.7699
INFO:root:validate loss: 0.4795
INFO:root:validate average_precision, 0.7389
INFO:root:validate roc_auc, 0.8067
INFO:root:new node validate loss: 0.7182
INFO:root:new node validate average_precision, 0.5925
INFO:root:new node validate roc_auc, 0.5796
INFO:root:Epoch: 39, learning rate: 9.0589168668107e-05, train loss: 0.4987
INFO:root:train average_precision, 0.7027
INFO:root:train roc_auc, 0.7717
INFO:root:validate loss: 0.4712
INFO:root:validate average_precision, 0.7373
INFO:root:validate roc_auc, 0.8058
INFO:root:new node validate loss: 0.7411
INFO:root:new node validate average_precision, 0.5717
INFO:root:new node validate roc_auc, 0.5668
INFO:root:Epoch: 40, learning rate: 1.9098300562492276e-05, train loss: 0.4969
INFO:root:train average_precision, 0.7016
INFO:root:train roc_auc, 0.7706
INFO:root:validate loss: 0.4586
INFO:root:validate average_precision, 0.7393
INFO:root:validate roc_auc, 0.8092
INFO:root:new node validate loss: 0.7339
INFO:root:new node validate average_precision, 0.5864
INFO:root:new node validate roc_auc, 0.5843
INFO:root:test loss: 0.4807
INFO:root:test average_precision, 0.7502
INFO:root:test roc_auc, 0.8146
INFO:root:new node test loss: 0.7793
INFO:root:new node test average_precision, 0.5652
INFO:root:new node test roc_auc, 0.5791
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 41, learning rate: 2.4083238061241416e-06, train loss: 0.4950
INFO:root:train average_precision, 0.7050
INFO:root:train roc_auc, 0.7748
INFO:root:validate loss: 0.4550
INFO:root:validate average_precision, 0.7423
INFO:root:validate roc_auc, 0.8115
INFO:root:new node validate loss: 0.7307
INFO:root:new node validate average_precision, 0.5834
INFO:root:new node validate roc_auc, 0.5853
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 42, learning rate: 5.182463258977168e-05, train loss: 0.5000
INFO:root:train average_precision, 0.7009
INFO:root:train roc_auc, 0.7704
INFO:root:validate loss: 0.4758
INFO:root:validate average_precision, 0.7353
INFO:root:validate roc_auc, 0.7997
INFO:root:new node validate loss: 0.7325
INFO:root:new node validate average_precision, 0.5752
INFO:root:new node validate roc_auc, 0.5591
INFO:root:Epoch: 43, learning rate: 0.00013387379202480098, train loss: 0.4928
INFO:root:train average_precision, 0.7034
INFO:root:train roc_auc, 0.7736
INFO:root:validate loss: 0.4974
INFO:root:validate average_precision, 0.7231
INFO:root:validate roc_auc, 0.7869
INFO:root:new node validate loss: 0.7321
INFO:root:new node validate average_precision, 0.5511
INFO:root:new node validate roc_auc, 0.5351
INFO:root:Epoch: 44, learning rate: 0.0001929776485891291, train loss: 0.4949
INFO:root:train average_precision, 0.7017
INFO:root:train roc_auc, 0.7705
INFO:root:validate loss: 0.5089
INFO:root:validate average_precision, 0.7131
INFO:root:validate roc_auc, 0.7744
INFO:root:new node validate loss: 0.7421
INFO:root:new node validate average_precision, 0.5660
INFO:root:new node validate roc_auc, 0.5344
INFO:root:Epoch: 45, learning rate: 0.00018910065241904827, train loss: 0.4972
INFO:root:train average_precision, 0.7013
INFO:root:train roc_auc, 0.7689
INFO:root:validate loss: 0.4830
INFO:root:validate average_precision, 0.7377
INFO:root:validate roc_auc, 0.8049
INFO:root:new node validate loss: 0.7152
INFO:root:new node validate average_precision, 0.5882
INFO:root:new node validate roc_auc, 0.5824
INFO:root:Epoch: 46, learning rate: 0.0001248689887165679, train loss: 0.4965
INFO:root:train average_precision, 0.7048
INFO:root:train roc_auc, 0.7722
INFO:root:validate loss: 0.4725
INFO:root:validate average_precision, 0.7386
INFO:root:validate roc_auc, 0.8049
INFO:root:new node validate loss: 0.7344
INFO:root:new node validate average_precision, 0.5770
INFO:root:new node validate roc_auc, 0.5678
INFO:root:Epoch: 47, learning rate: 4.379166221479566e-05, train loss: 0.4957
INFO:root:train average_precision, 0.7033
INFO:root:train roc_auc, 0.7721
INFO:root:validate loss: 0.4597
INFO:root:validate average_precision, 0.7395
INFO:root:validate roc_auc, 0.8089
INFO:root:new node validate loss: 0.7184
INFO:root:new node validate average_precision, 0.5772
INFO:root:new node validate roc_auc, 0.5810
INFO:root:Epoch: 48, learning rate: 7.885298685523015e-07, train loss: 0.4981
INFO:root:train average_precision, 0.7029
INFO:root:train roc_auc, 0.7720
INFO:root:validate loss: 0.4577
INFO:root:validate average_precision, 0.7407
INFO:root:validate roc_auc, 0.8104
INFO:root:new node validate loss: 0.7327
INFO:root:new node validate average_precision, 0.5859
INFO:root:new node validate roc_auc, 0.5905
INFO:root:Epoch: 49, learning rate: 2.498889303694848e-05, train loss: 0.4885
INFO:root:train average_precision, 0.7102
INFO:root:train roc_auc, 0.7783
INFO:root:validate loss: 0.4605
INFO:root:validate average_precision, 0.7379
INFO:root:validate roc_auc, 0.8064
INFO:root:new node validate loss: 0.7367
INFO:root:new node validate average_precision, 0.5797
INFO:root:new node validate roc_auc, 0.5703
INFO:root:Epoch: 50, learning rate: 0.00010000000000011486, train loss: 0.4889
INFO:root:train average_precision, 0.7106
INFO:root:train roc_auc, 0.7788
INFO:root:validate loss: 0.4732
INFO:root:validate average_precision, 0.7275
INFO:root:validate roc_auc, 0.7959
INFO:root:new node validate loss: 0.7264
INFO:root:new node validate average_precision, 0.5686
INFO:root:new node validate roc_auc, 0.5597
INFO:root:test loss: 0.4822
INFO:root:test average_precision, 0.7304
INFO:root:test roc_auc, 0.8010
INFO:root:new node test loss: 0.7417
INFO:root:new node test average_precision, 0.5636
INFO:root:new node test roc_auc, 0.5752
INFO:root:Epoch: 51, learning rate: 0.00017501110696348246, train loss: 0.4908
INFO:root:train average_precision, 0.7085
INFO:root:train roc_auc, 0.7763
INFO:root:validate loss: 0.4856
INFO:root:validate average_precision, 0.7244
INFO:root:validate roc_auc, 0.7927
INFO:root:new node validate loss: 0.7380
INFO:root:new node validate average_precision, 0.5343
INFO:root:new node validate roc_auc, 0.5149
INFO:root:Epoch: 52, learning rate: 0.0001992114701314927, train loss: 0.4917
INFO:root:train average_precision, 0.7061
INFO:root:train roc_auc, 0.7744
INFO:root:validate loss: 0.4686
INFO:root:validate average_precision, 0.7348
INFO:root:validate roc_auc, 0.8033
INFO:root:new node validate loss: 0.7199
INFO:root:new node validate average_precision, 0.5624
INFO:root:new node validate roc_auc, 0.5520
INFO:root:Epoch: 53, learning rate: 0.0001562083377854611, train loss: 0.4897
INFO:root:train average_precision, 0.7067
INFO:root:train roc_auc, 0.7755
INFO:root:validate loss: 0.4808
INFO:root:validate average_precision, 0.7369
INFO:root:validate roc_auc, 0.8048
INFO:root:new node validate loss: 0.7393
INFO:root:new node validate average_precision, 0.5761
INFO:root:new node validate roc_auc, 0.5679
INFO:root:Epoch: 54, learning rate: 7.513101128346403e-05, train loss: 0.4930
INFO:root:train average_precision, 0.7038
INFO:root:train roc_auc, 0.7738
INFO:root:validate loss: 0.4658
INFO:root:validate average_precision, 0.7399
INFO:root:validate roc_auc, 0.8076
INFO:root:new node validate loss: 0.7264
INFO:root:new node validate average_precision, 0.5808
INFO:root:new node validate roc_auc, 0.5818
INFO:root:Epoch: 55, learning rate: 1.0899347581169677e-05, train loss: 0.4925
INFO:root:train average_precision, 0.7044
INFO:root:train roc_auc, 0.7745
INFO:root:validate loss: 0.4561
INFO:root:validate average_precision, 0.7442
INFO:root:validate roc_auc, 0.8151
INFO:root:new node validate loss: 0.7235
INFO:root:new node validate average_precision, 0.5646
INFO:root:new node validate roc_auc, 0.5797
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 56, learning rate: 7.022351411181132e-06, train loss: 0.4895
INFO:root:train average_precision, 0.7079
INFO:root:train roc_auc, 0.7781
INFO:root:validate loss: 0.4555
INFO:root:validate average_precision, 0.7404
INFO:root:validate roc_auc, 0.8123
INFO:root:new node validate loss: 0.7318
INFO:root:new node validate average_precision, 0.5489
INFO:root:new node validate roc_auc, 0.5648
INFO:root:Epoch: 57, learning rate: 6.612620797562036e-05, train loss: 0.4932
INFO:root:train average_precision, 0.7053
INFO:root:train roc_auc, 0.7741
INFO:root:validate loss: 0.4668
INFO:root:validate average_precision, 0.7301
INFO:root:validate roc_auc, 0.8033
INFO:root:new node validate loss: 0.7290
INFO:root:new node validate average_precision, 0.5284
INFO:root:new node validate roc_auc, 0.5411
INFO:root:Epoch: 58, learning rate: 0.00014817536741017415, train loss: 0.4911
INFO:root:train average_precision, 0.7077
INFO:root:train roc_auc, 0.7762
INFO:root:validate loss: 0.4832
INFO:root:validate average_precision, 0.7237
INFO:root:validate roc_auc, 0.7945
INFO:root:new node validate loss: 0.7284
INFO:root:new node validate average_precision, 0.5376
INFO:root:new node validate roc_auc, 0.5395
INFO:root:Epoch: 59, learning rate: 0.0001975916761941429, train loss: 0.4877
INFO:root:train average_precision, 0.7096
INFO:root:train roc_auc, 0.7779
INFO:root:validate loss: 0.4978
INFO:root:validate average_precision, 0.7059
INFO:root:validate roc_auc, 0.7765
INFO:root:new node validate loss: 0.7368
INFO:root:new node validate average_precision, 0.5282
INFO:root:new node validate roc_auc, 0.5262
INFO:root:Epoch: 60, learning rate: 0.00018090169943733105, train loss: 0.4887
INFO:root:train average_precision, 0.7089
INFO:root:train roc_auc, 0.7760
INFO:root:validate loss: 0.4816
INFO:root:validate average_precision, 0.7328
INFO:root:validate roc_auc, 0.8037
INFO:root:new node validate loss: 0.7310
INFO:root:new node validate average_precision, 0.5559
INFO:root:new node validate roc_auc, 0.5630
INFO:root:test loss: 0.4924
INFO:root:test average_precision, 0.7233
INFO:root:test roc_auc, 0.7990
INFO:root:new node test loss: 0.7476
INFO:root:new node test average_precision, 0.5566
INFO:root:new node test roc_auc, 0.5721
INFO:root:Epoch: 61, learning rate: 0.00010941083133190251, train loss: 0.4916
INFO:root:train average_precision, 0.7058
INFO:root:train roc_auc, 0.7756
INFO:root:validate loss: 0.4639
INFO:root:validate average_precision, 0.7442
INFO:root:validate roc_auc, 0.8130
INFO:root:new node validate loss: 0.7237
INFO:root:new node validate average_precision, 0.5712
INFO:root:new node validate roc_auc, 0.5735
INFO:root:Epoch: 62, learning rate: 3.154528940706994e-05, train loss: 0.4916
INFO:root:train average_precision, 0.7076
INFO:root:train roc_auc, 0.7775
INFO:root:validate loss: 0.4586
INFO:root:validate average_precision, 0.7436
INFO:root:validate roc_auc, 0.8145
INFO:root:new node validate loss: 0.7149
INFO:root:new node validate average_precision, 0.5534
INFO:root:new node validate roc_auc, 0.5729
INFO:root:Epoch: 63, learning rate: 4.934396342683992e-08, train loss: 0.4916
INFO:root:train average_precision, 0.7068
INFO:root:train roc_auc, 0.7770
INFO:root:validate loss: 0.4579
INFO:root:validate average_precision, 0.7445
INFO:root:validate roc_auc, 0.8134
INFO:root:new node validate loss: 0.7297
INFO:root:new node validate average_precision, 0.5429
INFO:root:new node validate roc_auc, 0.5555
INFO:root:Epoch: 64, learning rate: 3.6257601025118355e-05, train loss: 0.4860
INFO:root:train average_precision, 0.7129
INFO:root:train roc_auc, 0.7792
INFO:root:validate loss: 0.4628
INFO:root:validate average_precision, 0.7347
INFO:root:validate roc_auc, 0.8040
INFO:root:new node validate loss: 0.7285
INFO:root:new node validate average_precision, 0.5557
INFO:root:new node validate roc_auc, 0.5599
INFO:root:Epoch: 65, learning rate: 0.00011564344650412834, train loss: 0.4862
INFO:root:train average_precision, 0.7127
INFO:root:train roc_auc, 0.7798
INFO:root:validate loss: 0.4685
INFO:root:validate average_precision, 0.7363
INFO:root:validate roc_auc, 0.8076
INFO:root:new node validate loss: 0.7379
INFO:root:new node validate average_precision, 0.5177
INFO:root:new node validate roc_auc, 0.5261
INFO:root:Epoch: 66, learning rate: 0.00018443279254995456, train loss: 0.4854
INFO:root:train average_precision, 0.7144
INFO:root:train roc_auc, 0.7821
INFO:root:validate loss: 0.4838
INFO:root:validate average_precision, 0.7285
INFO:root:validate roc_auc, 0.7968
INFO:root:new node validate loss: 0.7251
INFO:root:new node validate average_precision, 0.5454
INFO:root:new node validate roc_auc, 0.5460
INFO:root:Epoch: 67, learning rate: 0.00019602936856839986, train loss: 0.4864
INFO:root:train average_precision, 0.7106
INFO:root:train roc_auc, 0.7795
INFO:root:validate loss: 0.4815
INFO:root:validate average_precision, 0.7389
INFO:root:validate roc_auc, 0.8057
INFO:root:new node validate loss: 0.7092
INFO:root:new node validate average_precision, 0.5704
INFO:root:new node validate roc_auc, 0.5760
INFO:root:Epoch: 68, learning rate: 0.00014257792915669772, train loss: 0.4859
INFO:root:train average_precision, 0.7118
INFO:root:train roc_auc, 0.7809
INFO:root:validate loss: 0.4790
INFO:root:validate average_precision, 0.7363
INFO:root:validate roc_auc, 0.8062
INFO:root:new node validate loss: 0.7140
INFO:root:new node validate average_precision, 0.5470
INFO:root:new node validate roc_auc, 0.5635
INFO:root:Epoch: 69, learning rate: 6.028521093668586e-05, train loss: 0.4879
INFO:root:train average_precision, 0.7135
INFO:root:train roc_auc, 0.7820
INFO:root:validate loss: 0.4587
INFO:root:validate average_precision, 0.7464
INFO:root:validate roc_auc, 0.8153
INFO:root:new node validate loss: 0.7285
INFO:root:new node validate average_precision, 0.5301
INFO:root:new node validate roc_auc, 0.5458
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 70, learning rate: 4.894348370486552e-06, train loss: 0.4911
INFO:root:train average_precision, 0.7106
INFO:root:train roc_auc, 0.7791
INFO:root:validate loss: 0.4588
INFO:root:validate average_precision, 0.7446
INFO:root:validate roc_auc, 0.8144
INFO:root:new node validate loss: 0.7227
INFO:root:new node validate average_precision, 0.5583
INFO:root:new node validate roc_auc, 0.5753
INFO:root:test loss: 0.4757
INFO:root:test average_precision, 0.7431
INFO:root:test roc_auc, 0.8133
INFO:root:new node test loss: 0.7740
INFO:root:new node test average_precision, 0.5502
INFO:root:new node test roc_auc, 0.5651
INFO:root:Epoch: 71, learning rate: 1.392579729961352e-05, train loss: 0.4862
INFO:root:train average_precision, 0.7131
INFO:root:train roc_auc, 0.7813
INFO:root:validate loss: 0.4586
INFO:root:validate average_precision, 0.7335
INFO:root:validate roc_auc, 0.8061
INFO:root:new node validate loss: 0.7315
INFO:root:new node validate average_precision, 0.5334
INFO:root:new node validate roc_auc, 0.5452
INFO:root:Epoch: 72, learning rate: 8.126186854157901e-05, train loss: 0.4841
INFO:root:train average_precision, 0.7133
INFO:root:train roc_auc, 0.7811
INFO:root:validate loss: 0.4802
INFO:root:validate average_precision, 0.7345
INFO:root:validate roc_auc, 0.8044
INFO:root:new node validate loss: 0.7268
INFO:root:new node validate average_precision, 0.5426
INFO:root:new node validate roc_auc, 0.5511
INFO:root:Epoch: 73, learning rate: 0.00016129070536522648, train loss: 0.4836
INFO:root:train average_precision, 0.7115
INFO:root:train roc_auc, 0.7813
INFO:root:validate loss: 0.4996
INFO:root:validate average_precision, 0.7116
INFO:root:validate roc_auc, 0.7804
INFO:root:new node validate loss: 0.7584
INFO:root:new node validate average_precision, 0.5077
INFO:root:new node validate roc_auc, 0.4917
INFO:root:Epoch: 74, learning rate: 0.00019980267284305187, train loss: 0.4849
INFO:root:train average_precision, 0.7139
INFO:root:train roc_auc, 0.7822
INFO:root:validate loss: 0.4851
INFO:root:validate average_precision, 0.7359
INFO:root:validate roc_auc, 0.8027
INFO:root:new node validate loss: 0.7190
INFO:root:new node validate average_precision, 0.5402
INFO:root:new node validate roc_auc, 0.5434
INFO:root:Epoch: 75, learning rate: 0.00017071067811846234, train loss: 0.4875
INFO:root:train average_precision, 0.7101
INFO:root:train roc_auc, 0.7782
INFO:root:validate loss: 0.4777
INFO:root:validate average_precision, 0.7414
INFO:root:validate roc_auc, 0.8112
INFO:root:new node validate loss: 0.7131
INFO:root:new node validate average_precision, 0.5547
INFO:root:new node validate roc_auc, 0.5688
INFO:root:Epoch: 76, learning rate: 9.372094804708691e-05, train loss: 0.4855
INFO:root:train average_precision, 0.7104
INFO:root:train roc_auc, 0.7786
INFO:root:validate loss: 0.4610
INFO:root:validate average_precision, 0.7477
INFO:root:validate roc_auc, 0.8160
INFO:root:new node validate loss: 0.7177
INFO:root:new node validate average_precision, 0.5724
INFO:root:new node validate roc_auc, 0.5797
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 77, learning rate: 2.0984498762464415e-05, train loss: 0.4880
INFO:root:train average_precision, 0.7060
INFO:root:train roc_auc, 0.7747
INFO:root:validate loss: 0.4660
INFO:root:validate average_precision, 0.7441
INFO:root:validate roc_auc, 0.8125
INFO:root:new node validate loss: 0.7334
INFO:root:new node validate average_precision, 0.5660
INFO:root:new node validate roc_auc, 0.5650
INFO:root:Epoch: 78, learning rate: 1.771274927134204e-06, train loss: 0.4848
INFO:root:train average_precision, 0.7125
INFO:root:train roc_auc, 0.7792
INFO:root:validate loss: 0.4576
INFO:root:validate average_precision, 0.7404
INFO:root:validate roc_auc, 0.8110
INFO:root:new node validate loss: 0.7354
INFO:root:new node validate average_precision, 0.5484
INFO:root:new node validate roc_auc, 0.5555
INFO:root:Epoch: 79, learning rate: 4.9095858424928075e-05, train loss: 0.4859
INFO:root:train average_precision, 0.7076
INFO:root:train roc_auc, 0.7782
INFO:root:validate loss: 0.4645
INFO:root:validate average_precision, 0.7351
INFO:root:validate roc_auc, 0.8063
INFO:root:new node validate loss: 0.7268
INFO:root:new node validate average_precision, 0.5220
INFO:root:new node validate roc_auc, 0.5313
INFO:root:Epoch: 80, learning rate: 0.00013090169943758348, train loss: 0.4862
INFO:root:train average_precision, 0.7089
INFO:root:train roc_auc, 0.7780
INFO:root:validate loss: 0.4794
INFO:root:validate average_precision, 0.7313
INFO:root:validate roc_auc, 0.8016
INFO:root:new node validate loss: 0.7263
INFO:root:new node validate average_precision, 0.5326
INFO:root:new node validate roc_auc, 0.5372
INFO:root:test loss: 0.4755
INFO:root:test average_precision, 0.7317
INFO:root:test roc_auc, 0.8049
INFO:root:new node test loss: 0.7399
INFO:root:new node test average_precision, 0.5497
INFO:root:new node test roc_auc, 0.5683
INFO:root:Epoch: 81, learning rate: 0.00019177546256809677, train loss: 0.4863
INFO:root:train average_precision, 0.7125
INFO:root:train roc_auc, 0.7796
INFO:root:validate loss: 0.4871
INFO:root:validate average_precision, 0.7261
INFO:root:validate roc_auc, 0.7928
INFO:root:new node validate loss: 0.7097
INFO:root:new node validate average_precision, 0.5415
INFO:root:new node validate roc_auc, 0.5525
INFO:root:Epoch: 82, learning rate: 0.00019048270524724283, train loss: 0.4861
INFO:root:train average_precision, 0.7085
INFO:root:train roc_auc, 0.7770
INFO:root:validate loss: 0.4937
INFO:root:validate average_precision, 0.7209
INFO:root:validate roc_auc, 0.7855
INFO:root:new node validate loss: 0.7239
INFO:root:new node validate average_precision, 0.5336
INFO:root:new node validate roc_auc, 0.5366
INFO:root:Epoch: 83, learning rate: 0.0001278991106040657, train loss: 0.4809
INFO:root:train average_precision, 0.7120
INFO:root:train roc_auc, 0.7824
INFO:root:validate loss: 0.4703
INFO:root:validate average_precision, 0.7446
INFO:root:validate roc_auc, 0.8143
INFO:root:new node validate loss: 0.7183
INFO:root:new node validate average_precision, 0.5384
INFO:root:new node validate roc_auc, 0.5588
INFO:root:Epoch: 84, learning rate: 4.641732050221234e-05, train loss: 0.4861
INFO:root:train average_precision, 0.7124
INFO:root:train roc_auc, 0.7808
INFO:root:validate loss: 0.4624
INFO:root:validate average_precision, 0.7400
INFO:root:validate roc_auc, 0.8080
INFO:root:new node validate loss: 0.7303
INFO:root:new node validate average_precision, 0.5109
INFO:root:new node validate roc_auc, 0.5226
INFO:root:Epoch: 85, learning rate: 1.231165940486511e-06, train loss: 0.4867
INFO:root:train average_precision, 0.7126
INFO:root:train roc_auc, 0.7811
INFO:root:validate loss: 0.4612
INFO:root:validate average_precision, 0.7397
INFO:root:validate roc_auc, 0.8091
INFO:root:new node validate loss: 0.7360
INFO:root:new node validate average_precision, 0.5327
INFO:root:new node validate roc_auc, 0.5430
INFO:root:Epoch: 86, learning rate: 2.294867572242764e-05, train loss: 0.4833
INFO:root:train average_precision, 0.7115
INFO:root:train roc_auc, 0.7800
INFO:root:validate loss: 0.4614
INFO:root:validate average_precision, 0.7392
INFO:root:validate roc_auc, 0.8100
INFO:root:new node validate loss: 0.7202
INFO:root:new node validate average_precision, 0.5541
INFO:root:new node validate roc_auc, 0.5610
INFO:root:Epoch: 87, learning rate: 9.685892409233848e-05, train loss: 0.4823
INFO:root:train average_precision, 0.7109
INFO:root:train roc_auc, 0.7815
INFO:root:validate loss: 0.4638
INFO:root:validate average_precision, 0.7400
INFO:root:validate roc_auc, 0.8091
INFO:root:new node validate loss: 0.7137
INFO:root:new node validate average_precision, 0.5506
INFO:root:new node validate roc_auc, 0.5598
INFO:root:Epoch: 88, learning rate: 0.0001728968627420249, train loss: 0.4821
INFO:root:train average_precision, 0.7140
INFO:root:train roc_auc, 0.7839
INFO:root:validate loss: 0.4935
INFO:root:validate average_precision, 0.7355
INFO:root:validate roc_auc, 0.8001
INFO:root:new node validate loss: 0.7197
INFO:root:new node validate average_precision, 0.5311
INFO:root:new node validate roc_auc, 0.5439
INFO:root:Epoch: 89, learning rate: 0.000199556196460443, train loss: 0.4875
INFO:root:train average_precision, 0.7129
INFO:root:train roc_auc, 0.7809
INFO:root:validate loss: 0.4982
INFO:root:validate average_precision, 0.7031
INFO:root:validate roc_auc, 0.7679
INFO:root:new node validate loss: 0.7278
INFO:root:new node validate average_precision, 0.5445
INFO:root:new node validate roc_auc, 0.5417
INFO:root:Epoch: 90, learning rate: 0.00015877852522960044, train loss: 0.4823
INFO:root:train average_precision, 0.7148
INFO:root:train roc_auc, 0.7843
INFO:root:validate loss: 0.4711
INFO:root:validate average_precision, 0.7445
INFO:root:validate roc_auc, 0.8119
INFO:root:new node validate loss: 0.7103
INFO:root:new node validate average_precision, 0.5536
INFO:root:new node validate roc_auc, 0.5713
INFO:root:test loss: 0.4724
INFO:root:test average_precision, 0.7464
INFO:root:test roc_auc, 0.8152
INFO:root:new node test loss: 0.7549
INFO:root:new node test average_precision, 0.5690
INFO:root:new node test roc_auc, 0.5877
INFO:root:Epoch: 91, learning rate: 7.818567586034398e-05, train loss: 0.4841
INFO:root:train average_precision, 0.7114
INFO:root:train roc_auc, 0.7797
INFO:root:validate loss: 0.4580
INFO:root:validate average_precision, 0.7475
INFO:root:validate roc_auc, 0.8170
INFO:root:new node validate loss: 0.7252
INFO:root:new node validate average_precision, 0.5772
INFO:root:new node validate roc_auc, 0.5915
INFO:root:Epoch: 92, learning rate: 1.2369331995628408e-05, train loss: 0.4859
INFO:root:train average_precision, 0.7100
INFO:root:train roc_auc, 0.7791
INFO:root:validate loss: 0.4662
INFO:root:validate average_precision, 0.7428
INFO:root:validate roc_auc, 0.8109
INFO:root:new node validate loss: 0.7275
INFO:root:new node validate average_precision, 0.5251
INFO:root:new node validate roc_auc, 0.5432
INFO:root:Epoch: 93, learning rate: 5.911923104585612e-06, train loss: 0.4849
INFO:root:train average_precision, 0.7103
INFO:root:train roc_auc, 0.7793
INFO:root:validate loss: 0.4628
INFO:root:validate average_precision, 0.7387
INFO:root:validate roc_auc, 0.8102
INFO:root:new node validate loss: 0.7325
INFO:root:new node validate average_precision, 0.5267
INFO:root:new node validate roc_auc, 0.5392
INFO:root:Epoch: 94, learning rate: 6.318754473147785e-05, train loss: 0.4818
INFO:root:train average_precision, 0.7148
INFO:root:train roc_auc, 0.7841
INFO:root:validate loss: 0.4789
INFO:root:validate average_precision, 0.7389
INFO:root:validate roc_auc, 0.8056
INFO:root:new node validate loss: 0.7299
INFO:root:new node validate average_precision, 0.5349
INFO:root:new node validate roc_auc, 0.5426
INFO:root:Epoch: 95, learning rate: 0.00014539904997401933, train loss: 0.4838
INFO:root:train average_precision, 0.7133
INFO:root:train roc_auc, 0.7805
INFO:root:validate loss: 0.4817
INFO:root:validate average_precision, 0.7243
INFO:root:validate roc_auc, 0.7946
INFO:root:new node validate loss: 0.7191
INFO:root:new node validate average_precision, 0.5219
INFO:root:new node validate roc_auc, 0.5200
INFO:root:Epoch: 96, learning rate: 0.00019685831611321615, train loss: 0.4919
INFO:root:train average_precision, 0.7047
INFO:root:train roc_auc, 0.7730
INFO:root:validate loss: 0.4865
INFO:root:validate average_precision, 0.7351
INFO:root:validate roc_auc, 0.8033
INFO:root:new node validate loss: 0.7204
INFO:root:new node validate average_precision, 0.5152
INFO:root:new node validate roc_auc, 0.5122
INFO:root:load model ./saved_models/TGN/USLegis/TGN_seed3/TGN_seed3.pkl
INFO:root:get final performance on dataset USLegis...
INFO:root:test loss: 0.4740
INFO:root:test average_precision, 0.7431
INFO:root:test roc_auc, 0.8152
INFO:root:new node test loss: 0.7622
INFO:root:new node test average_precision, 0.5653
INFO:root:new node test roc_auc, 0.5872
INFO:root:Run 4 cost 25947.13 seconds.
INFO:root:********** Run 5 starts. **********
INFO:root:configuration is Namespace(dataset_name='USLegis', batch_size=200, model_name='TGN', gpu=0, num_neighbors=20, sample_neighbor_strategy='time_interval_aware', time_scaling_factor=1e-06, num_walk_heads=8, num_heads=2, num_layers=2, walk_length=1, time_gap=2000, time_feat_dim=100, position_feat_dim=172, edge_bank_memory_mode='unlimited_memory', time_window_mode='fixed_proportion', patch_size=200, channel_embedding_dim=50, max_input_sequence_length=64, learning_rate=0.0001, dropout=0.1, num_epochs=100, optimizer='Adam', weight_decay=0.0, patience=20, val_ratio=0.15, test_ratio=0.15, num_runs=5, test_interval_epochs=10, negative_sample_strategy='random', load_best_configs=False, device='cuda:0', seed=4, save_model_name='TGN_seed4')
INFO:root:model -> Sequential(
  (0): MemoryModel(
    (src_memory_encoder): Linear(in_features=172, out_features=172, bias=True)
    (dst_memory_encoder): Linear(in_features=172, out_features=172, bias=True)
    (edge_encoder): Linear(in_features=172, out_features=172, bias=True)
    (channel_attention): ChannelAttentionTemporal(
      (avg_pool): AdaptiveAvgPool1d(output_size=1)
      (max_pool): AdaptiveMaxPool1d(output_size=1)
      (fc1): Linear(in_features=4, out_features=0, bias=False)
      (relu1): ReLU()
      (fc2): Linear(in_features=0, out_features=4, bias=False)
      (sigmoid): Sigmoid()
    )
    (time_encoder): TimeEncoder(
      (w): Linear(in_features=1, out_features=100, bias=True)
    )
    (message_aggregator): MessageAggregator()
    (memory_bank): MemoryBank(num_nodes=226, memory_dim=172)
    (memory_updater): CFCMemoryUpdater(
      (memory_bank): MemoryBank(num_nodes=226, memory_dim=172)
      (memory_updater): MoE(
        (mixer): Linear(in_features=788, out_features=616, bias=True)
        (relu): ReLU(inplace=True)
        (experts): ModuleList(
          (0-5): 6 x rnnmodule(
            (cell): GRUCell(616, 172)
            (relu): ReLU()
          )
        )
        (softplus): Softplus(beta=1.0, threshold=20.0)
        (softmax): Softmax(dim=1)
      )
    )
    (embedding_module): GraphAttentionEmbedding(
      (time_encoder): TimeEncoder(
        (w): Linear(in_features=1, out_features=100, bias=True)
      )
      (temporal_conv_layers): ModuleList(
        (0-1): 2 x MultiHeadAttention(
          (query_projection): Linear(in_features=272, out_features=272, bias=False)
          (key_projection): Linear(in_features=444, out_features=272, bias=False)
          (value_projection): Linear(in_features=444, out_features=272, bias=False)
          (layer_norm): LayerNorm((272,), eps=1e-05, elementwise_affine=True)
          (residual_fc): Linear(in_features=272, out_features=272, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (merge_layers): ModuleList(
        (0-1): 2 x MergeLayer(
          (fc1): Linear(in_features=444, out_features=172, bias=True)
          (fc2): Linear(in_features=172, out_features=172, bias=True)
          (act): ReLU()
        )
      )
    )
  )
  (1): MergeLayer(
    (fc1): Linear(in_features=344, out_features=172, bias=True)
    (fc2): Linear(in_features=172, out_features=1, bias=True)
    (act): ReLU()
  )
)
INFO:root:model name: TGN, #parameters: 16325876 B, 15943.23828125 KB, 15.569568634033203 MB.
INFO:root:Epoch: 1, learning rate: 0.00016613118653236524, train loss: 0.5885
INFO:root:train average_precision, 0.6543
INFO:root:train roc_auc, 0.7134
INFO:root:validate loss: 0.5912
INFO:root:validate average_precision, 0.7037
INFO:root:validate roc_auc, 0.7641
INFO:root:new node validate loss: 0.7329
INFO:root:new node validate average_precision, 0.5945
INFO:root:new node validate roc_auc, 0.5824
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed4/TGN_seed4.pkl
INFO:root:Epoch: 2, learning rate: 8.746667664356936e-05, train loss: 0.5836
INFO:root:train average_precision, 0.6438
INFO:root:train roc_auc, 0.7097
INFO:root:validate loss: 0.6169
INFO:root:validate average_precision, 0.6449
INFO:root:validate roc_auc, 0.6952
INFO:root:new node validate loss: 0.6700
INFO:root:new node validate average_precision, 0.5931
INFO:root:new node validate roc_auc, 0.5882
INFO:root:Epoch: 3, learning rate: 1.7291942572543902e-05, train loss: 0.5537
INFO:root:train average_precision, 0.6554
INFO:root:train roc_auc, 0.7213
INFO:root:validate loss: 0.5915
INFO:root:validate average_precision, 0.6449
INFO:root:validate roc_auc, 0.6960
INFO:root:new node validate loss: 0.6945
INFO:root:new node validate average_precision, 0.5872
INFO:root:new node validate roc_auc, 0.5790
INFO:root:Epoch: 4, learning rate: 3.1416838871369568e-06, train loss: 0.5452
INFO:root:train average_precision, 0.6665
INFO:root:train roc_auc, 0.7324
INFO:root:validate loss: 0.5829
INFO:root:validate average_precision, 0.6785
INFO:root:validate roc_auc, 0.7238
INFO:root:new node validate loss: 0.7044
INFO:root:new node validate average_precision, 0.5871
INFO:root:new node validate roc_auc, 0.5700
INFO:root:Epoch: 5, learning rate: 5.4600950026033074e-05, train loss: 0.5322
INFO:root:train average_precision, 0.6856
INFO:root:train roc_auc, 0.7531
INFO:root:validate loss: 0.5695
INFO:root:validate average_precision, 0.7117
INFO:root:validate roc_auc, 0.7644
INFO:root:new node validate loss: 0.8209
INFO:root:new node validate average_precision, 0.5608
INFO:root:new node validate roc_auc, 0.5383
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed4/TGN_seed4.pkl
INFO:root:Epoch: 6, learning rate: 0.000136812455268468, train loss: 0.5406
INFO:root:train average_precision, 0.6872
INFO:root:train roc_auc, 0.7533
INFO:root:validate loss: 0.5592
INFO:root:validate average_precision, 0.7150
INFO:root:validate roc_auc, 0.7744
INFO:root:new node validate loss: 0.8674
INFO:root:new node validate average_precision, 0.5329
INFO:root:new node validate roc_auc, 0.5102
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed4/TGN_seed4.pkl
INFO:root:Epoch: 7, learning rate: 0.00019408807689546632, train loss: 0.5430
INFO:root:train average_precision, 0.6782
INFO:root:train roc_auc, 0.7414
INFO:root:validate loss: 0.5114
INFO:root:validate average_precision, 0.7265
INFO:root:validate roc_auc, 0.7933
INFO:root:new node validate loss: 0.7854
INFO:root:new node validate average_precision, 0.5062
INFO:root:new node validate roc_auc, 0.5029
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed4/TGN_seed4.pkl
INFO:root:Epoch: 8, learning rate: 0.00018763066800442832, train loss: 0.5279
INFO:root:train average_precision, 0.6873
INFO:root:train roc_auc, 0.7544
INFO:root:validate loss: 0.5139
INFO:root:validate average_precision, 0.7293
INFO:root:validate roc_auc, 0.7939
INFO:root:new node validate loss: 0.7964
INFO:root:new node validate average_precision, 0.5619
INFO:root:new node validate roc_auc, 0.5350
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed4/TGN_seed4.pkl
INFO:root:Epoch: 9, learning rate: 0.0001218143241396262, train loss: 0.5258
INFO:root:train average_precision, 0.6874
INFO:root:train roc_auc, 0.7555
INFO:root:validate loss: 0.5239
INFO:root:validate average_precision, 0.7244
INFO:root:validate roc_auc, 0.7902
INFO:root:new node validate loss: 0.7612
INFO:root:new node validate average_precision, 0.5893
INFO:root:new node validate roc_auc, 0.5667
INFO:root:Epoch: 10, learning rate: 4.1221474770761954e-05, train loss: 0.5154
INFO:root:train average_precision, 0.6870
INFO:root:train roc_auc, 0.7600
INFO:root:validate loss: 0.4906
INFO:root:validate average_precision, 0.7350
INFO:root:validate roc_auc, 0.8041
INFO:root:new node validate loss: 0.7650
INFO:root:new node validate average_precision, 0.5714
INFO:root:new node validate roc_auc, 0.5605
INFO:root:test loss: 0.4808
INFO:root:test average_precision, 0.7390
INFO:root:test roc_auc, 0.8067
INFO:root:new node test loss: 0.7467
INFO:root:new node test average_precision, 0.5591
INFO:root:new node test roc_auc, 0.5739
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed4/TGN_seed4.pkl
INFO:root:Epoch: 11, learning rate: 4.438035396920891e-07, train loss: 0.5119
INFO:root:train average_precision, 0.6898
INFO:root:train roc_auc, 0.7628
INFO:root:validate loss: 0.4695
INFO:root:validate average_precision, 0.7367
INFO:root:validate roc_auc, 0.8078
INFO:root:new node validate loss: 0.7587
INFO:root:new node validate average_precision, 0.5696
INFO:root:new node validate roc_auc, 0.5652
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed4/TGN_seed4.pkl
INFO:root:Epoch: 12, learning rate: 2.71031372578646e-05, train loss: 0.5053
INFO:root:train average_precision, 0.6951
INFO:root:train roc_auc, 0.7670
INFO:root:validate loss: 0.4820
INFO:root:validate average_precision, 0.7348
INFO:root:validate roc_auc, 0.8015
INFO:root:new node validate loss: 0.7466
INFO:root:new node validate average_precision, 0.5814
INFO:root:new node validate roc_auc, 0.5691
INFO:root:Epoch: 13, learning rate: 0.00010314107590778983, train loss: 0.5025
INFO:root:train average_precision, 0.6986
INFO:root:train roc_auc, 0.7691
INFO:root:validate loss: 0.5032
INFO:root:validate average_precision, 0.7239
INFO:root:validate roc_auc, 0.7902
INFO:root:new node validate loss: 0.7729
INFO:root:new node validate average_precision, 0.5485
INFO:root:new node validate roc_auc, 0.5330
INFO:root:Epoch: 14, learning rate: 0.00017705132427761958, train loss: 0.5037
INFO:root:train average_precision, 0.6993
INFO:root:train roc_auc, 0.7669
INFO:root:validate loss: 0.4882
INFO:root:validate average_precision, 0.7307
INFO:root:validate roc_auc, 0.7972
INFO:root:new node validate loss: 0.7447
INFO:root:new node validate average_precision, 0.5803
INFO:root:new node validate roc_auc, 0.5509
INFO:root:Epoch: 15, learning rate: 0.00019876883405964778, train loss: 0.5009
INFO:root:train average_precision, 0.7013
INFO:root:train roc_auc, 0.7700
INFO:root:validate loss: 0.4877
INFO:root:validate average_precision, 0.7303
INFO:root:validate roc_auc, 0.7972
INFO:root:new node validate loss: 0.7427
INFO:root:new node validate average_precision, 0.5551
INFO:root:new node validate roc_auc, 0.5450
INFO:root:Epoch: 16, learning rate: 0.00015358267949793335, train loss: 0.5054
INFO:root:train average_precision, 0.6949
INFO:root:train roc_auc, 0.7656
INFO:root:validate loss: 0.4746
INFO:root:validate average_precision, 0.7383
INFO:root:validate roc_auc, 0.8057
INFO:root:new node validate loss: 0.7246
INFO:root:new node validate average_precision, 0.5836
INFO:root:new node validate roc_auc, 0.5631
INFO:root:Epoch: 17, learning rate: 7.21008893960603e-05, train loss: 0.5029
INFO:root:train average_precision, 0.6976
INFO:root:train roc_auc, 0.7689
INFO:root:validate loss: 0.4802
INFO:root:validate average_precision, 0.7357
INFO:root:validate roc_auc, 0.8032
INFO:root:new node validate loss: 0.7554
INFO:root:new node validate average_precision, 0.5785
INFO:root:new node validate roc_auc, 0.5549
INFO:root:Epoch: 18, learning rate: 9.517294753399618e-06, train loss: 0.5085
INFO:root:train average_precision, 0.6951
INFO:root:train roc_auc, 0.7672
INFO:root:validate loss: 0.4669
INFO:root:validate average_precision, 0.7378
INFO:root:validate roc_auc, 0.8082
INFO:root:new node validate loss: 0.7602
INFO:root:new node validate average_precision, 0.5698
INFO:root:new node validate roc_auc, 0.5596
INFO:root:save model ./saved_models/TGN/USLegis/TGN_seed4/TGN_seed4.pkl
INFO:root:Epoch: 19, learning rate: 8.224537431604012e-06, train loss: 0.4986
INFO:root:train average_precision, 0.7012
INFO:root:train roc_auc, 0.7709
INFO:root:validate loss: 0.4661
INFO:root:validate average_precision, 0.7373
INFO:root:validate roc_auc, 0.8086
INFO:root:new node validate loss: 0.7689
INFO:root:new node validate average_precision, 0.5502
INFO:root:new node validate roc_auc, 0.5544
INFO:root:Epoch: 20, learning rate: 6.909830056255193e-05, train loss: 0.5003
INFO:root:train average_precision, 0.7022
INFO:root:train roc_auc, 0.7723
INFO:root:validate loss: 0.4805
INFO:root:validate average_precision, 0.7358
INFO:root:validate roc_auc, 0.8020
INFO:root:new node validate loss: 0.7420
INFO:root:new node validate average_precision, 0.5811
INFO:root:new node validate roc_auc, 0.5674
INFO:root:test loss: 0.4960
INFO:root:test average_precision, 0.7424
INFO:root:test roc_auc, 0.8078
INFO:root:new node test loss: 0.7573
INFO:root:new node test average_precision, 0.5697
INFO:root:new node test roc_auc, 0.5836
INFO:root:Epoch: 21, learning rate: 0.00015090414157507186, train loss: 0.5010
INFO:root:train average_precision, 0.6999
INFO:root:train roc_auc, 0.7678
INFO:root:validate loss: 0.4790
INFO:root:validate average_precision, 0.7343
INFO:root:validate roc_auc, 0.8024
INFO:root:new node validate loss: 0.7505
INFO:root:new node validate average_precision, 0.5242
INFO:root:new node validate roc_auc, 0.5203
INFO:root:Epoch: 22, learning rate: 0.00019822872507282462, train loss: 0.5006
INFO:root:train average_precision, 0.7022
INFO:root:train roc_auc, 0.7690
INFO:root:validate loss: 0.4796
INFO:root:validate average_precision, 0.7365
INFO:root:validate roc_auc, 0.8028
INFO:root:new node validate loss: 0.7307
INFO:root:new node validate average_precision, 0.5794
INFO:root:new node validate roc_auc, 0.5621
INFO:root:Epoch: 23, learning rate: 0.00017901550123764875, train loss: 0.5012
INFO:root:train average_precision, 0.6956
INFO:root:train roc_auc, 0.7665
INFO:root:validate loss: 0.4773
INFO:root:validate average_precision, 0.7365
INFO:root:validate roc_auc, 0.8036
INFO:root:new node validate loss: 0.7243
INFO:root:new node validate average_precision, 0.5819
INFO:root:new node validate roc_auc, 0.5663
INFO:root:Epoch: 24, learning rate: 0.00010627905195293241, train loss: 0.5005
INFO:root:train average_precision, 0.6985
INFO:root:train roc_auc, 0.7689
INFO:root:validate loss: 0.4746
INFO:root:validate average_precision, 0.7354
INFO:root:validate roc_auc, 0.8029
INFO:root:new node validate loss: 0.7382
INFO:root:new node validate average_precision, 0.5808
INFO:root:new node validate roc_auc, 0.5597
INFO:root:Epoch: 25, learning rate: 2.928932188133125e-05, train loss: 0.4998
INFO:root:train average_precision, 0.6956
INFO:root:train roc_auc, 0.7670
INFO:root:validate loss: 0.4627
INFO:root:validate average_precision, 0.7336
INFO:root:validate roc_auc, 0.8071
INFO:root:new node validate loss: 0.7630
INFO:root:new node validate average_precision, 0.5598
INFO:root:new node validate roc_auc, 0.5566
INFO:root:Epoch: 26, learning rate: 1.9732715717278847e-07, train loss: 0.5028
INFO:root:train average_precision, 0.6937
INFO:root:train roc_auc, 0.7647
INFO:root:validate loss: 0.4601
INFO:root:validate average_precision, 0.7368
INFO:root:validate roc_auc, 0.8084
INFO:root:new node validate loss: 0.7435
INFO:root:new node validate average_precision, 0.5843
INFO:root:new node validate roc_auc, 0.5788
INFO:root:Epoch: 27, learning rate: 3.870929463473711e-05, train loss: 0.5007
INFO:root:train average_precision, 0.6985
INFO:root:train roc_auc, 0.7704
INFO:root:validate loss: 0.4729
INFO:root:validate average_precision, 0.7342
INFO:root:validate roc_auc, 0.8033
INFO:root:new node validate loss: 0.7467
INFO:root:new node validate average_precision, 0.5686
INFO:root:new node validate roc_auc, 0.5643
INFO:root:Epoch: 28, learning rate: 0.00011873813145862787, train loss: 0.5009
INFO:root:train average_precision, 0.7010
INFO:root:train roc_auc, 0.7695
INFO:root:validate loss: 0.4820
INFO:root:validate average_precision, 0.7304
INFO:root:validate roc_auc, 0.7975
INFO:root:new node validate loss: 0.7354
INFO:root:new node validate average_precision, 0.5728
INFO:root:new node validate roc_auc, 0.5603
INFO:root:Epoch: 29, learning rate: 0.00018607420270039493, train loss: 0.5000
INFO:root:train average_precision, 0.7001
INFO:root:train roc_auc, 0.7678
INFO:root:validate loss: 0.4837
INFO:root:validate average_precision, 0.7320
INFO:root:validate roc_auc, 0.7984
INFO:root:new node validate loss: 0.7214
INFO:root:new node validate average_precision, 0.5792
INFO:root:new node validate roc_auc, 0.5583
INFO:root:Epoch: 30, learning rate: 0.00019510565162977856, train loss: 0.5010
INFO:root:train average_precision, 0.6943
INFO:root:train roc_auc, 0.7642
INFO:root:validate loss: 0.4788
INFO:root:validate average_precision, 0.7307
INFO:root:validate roc_auc, 0.7982
INFO:root:new node validate loss: 0.7214
INFO:root:new node validate average_precision, 0.5829
INFO:root:new node validate roc_auc, 0.5613
INFO:root:test loss: 0.4876
INFO:root:test average_precision, 0.7382
INFO:root:test roc_auc, 0.8036
INFO:root:new node test loss: 0.7430
INFO:root:new node test average_precision, 0.5831
INFO:root:new node test roc_auc, 0.5848
INFO:root:Epoch: 31, learning rate: 0.000139714789063601, train loss: 0.4986
INFO:root:train average_precision, 0.6979
INFO:root:train roc_auc, 0.7668
INFO:root:validate loss: 0.4739
INFO:root:validate average_precision, 0.7360
INFO:root:validate roc_auc, 0.8045
INFO:root:new node validate loss: 0.7198
INFO:root:new node validate average_precision, 0.5825
INFO:root:new node validate roc_auc, 0.5656
INFO:root:Epoch: 32, learning rate: 5.7422070843516444e-05, train loss: 0.5012
INFO:root:train average_precision, 0.6921
INFO:root:train roc_auc, 0.7645
INFO:root:validate loss: 0.4681
INFO:root:validate average_precision, 0.7337
INFO:root:validate roc_auc, 0.8062
INFO:root:new node validate loss: 0.7304
INFO:root:new node validate average_precision, 0.5740
INFO:root:new node validate roc_auc, 0.5754
INFO:root:Epoch: 33, learning rate: 3.970631432305205e-06, train loss: 0.4992
INFO:root:train average_precision, 0.6948
INFO:root:train roc_auc, 0.7667
INFO:root:validate loss: 0.4696
INFO:root:validate average_precision, 0.7350
INFO:root:validate roc_auc, 0.8075
INFO:root:new node validate loss: 0.7467
INFO:root:new node validate average_precision, 0.5687
INFO:root:new node validate roc_auc, 0.5704
INFO:root:Epoch: 34, learning rate: 1.556720744979912e-05, train loss: 0.4999
INFO:root:train average_precision, 0.6983
INFO:root:train roc_auc, 0.7681
INFO:root:validate loss: 0.4681
INFO:root:validate average_precision, 0.7332
INFO:root:validate roc_auc, 0.8037
INFO:root:new node validate loss: 0.7546
INFO:root:new node validate average_precision, 0.5613
INFO:root:new node validate roc_auc, 0.5654
INFO:root:Epoch: 35, learning rate: 8.43565534959395e-05, train loss: 0.4987
INFO:root:train average_precision, 0.7023
INFO:root:train roc_auc, 0.7714
INFO:root:validate loss: 0.4718
INFO:root:validate average_precision, 0.7300
INFO:root:validate roc_auc, 0.8004
INFO:root:new node validate loss: 0.7253
INFO:root:new node validate average_precision, 0.5576
INFO:root:new node validate roc_auc, 0.5498
INFO:root:Epoch: 36, learning rate: 0.00016374239897501834, train loss: 0.4994
INFO:root:train average_precision, 0.6976
INFO:root:train roc_auc, 0.7680
INFO:root:validate loss: 0.4772
INFO:root:validate average_precision, 0.7263
INFO:root:validate roc_auc, 0.7946
INFO:root:new node validate loss: 0.7263
INFO:root:new node validate average_precision, 0.5711
INFO:root:new node validate roc_auc, 0.5545
INFO:root:Epoch: 37, learning rate: 0.00019995065603666313, train loss: 0.4947
INFO:root:train average_precision, 0.7004
INFO:root:train roc_auc, 0.7705
INFO:root:validate loss: 0.4809
INFO:root:validate average_precision, 0.7328
INFO:root:validate roc_auc, 0.8011
INFO:root:new node validate loss: 0.7295
INFO:root:new node validate average_precision, 0.5728
INFO:root:new node validate roc_auc, 0.5601
INFO:root:Epoch: 38, learning rate: 0.00016845471059286798, train loss: 0.4948
INFO:root:train average_precision, 0.6996
INFO:root:train roc_auc, 0.7709
INFO:root:validate loss: 0.4768
INFO:root:validate average_precision, 0.7353
INFO:root:validate roc_auc, 0.8036
INFO:root:new node validate loss: 0.7283
INFO:root:new node validate average_precision, 0.5831
INFO:root:new node validate roc_auc, 0.5688
INFO:root:load model ./saved_models/TGN/USLegis/TGN_seed4/TGN_seed4.pkl
INFO:root:get final performance on dataset USLegis...
INFO:root:test loss: 0.4878
INFO:root:test average_precision, 0.7420
INFO:root:test roc_auc, 0.8053
INFO:root:new node test loss: 0.7819
INFO:root:new node test average_precision, 0.5585
INFO:root:new node test roc_auc, 0.5572
INFO:root:Run 5 cost 9919.02 seconds.
INFO:root:metrics over 5 runs:
INFO:root:test average_precision, [np.float64(0.7468902626449285), np.float64(0.740280950963825), np.float64(0.7488541762889213), np.float64(0.7431316689428487), np.float64(0.7420207381472946)]
INFO:root:average test average_precision, 0.7442 ± 0.0035
INFO:root:test roc_auc, [np.float64(0.8131750555555557), np.float64(0.8073894999999999), np.float64(0.8158911666666665), np.float64(0.815235111111111), np.float64(0.8052780555555556)]
INFO:root:average test roc_auc, 0.8114 ± 0.0048
INFO:root:new node test average_precision, [np.float64(0.5484293756863359), np.float64(0.5461433760907423), np.float64(0.557563951540446), np.float64(0.5652792574781442), np.float64(0.5585270969836368)]
INFO:root:average new node test average_precision, 0.5552 ± 0.0078
INFO:root:new node test roc_auc, [np.float64(0.5701528807804113), np.float64(0.5681266450795194), np.float64(0.5710537595616758), np.float64(0.5872317701874138), np.float64(0.5572078347454684)]
INFO:root:average new node test roc_auc, 0.5708 ± 0.0108
The dataset has 60396 interactions, involving 225 different nodes
The training dataset has 34512 interactions, involving 172 different nodes
The validation dataset has 10005 interactions, involving 113 different nodes
The test dataset has 4950 interactions, involving 100 different nodes
The new node validation dataset has 5433 interactions, involving 113 different nodes
The new node test dataset has 3354 interactions, involving 100 different nodes
22 nodes were used for the inductive testing, i.e. are never seen during training
