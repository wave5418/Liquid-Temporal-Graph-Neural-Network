INFO:root:********** Run 1 starts. **********
INFO:root:configuration is Namespace(dataset_name='uci', batch_size=200, model_name='TGN', gpu=0, num_neighbors=10, sample_neighbor_strategy='recent', time_scaling_factor=1e-06, num_walk_heads=8, num_heads=2, num_layers=2, walk_length=1, time_gap=2000, time_feat_dim=100, position_feat_dim=172, edge_bank_memory_mode='unlimited_memory', time_window_mode='fixed_proportion', patch_size=200, channel_embedding_dim=50, max_input_sequence_length=64, learning_rate=0.0001, dropout=0.1, num_epochs=100, optimizer='Adam', weight_decay=0.0, patience=20, val_ratio=0.15, test_ratio=0.15, num_runs=5, test_interval_epochs=10, negative_sample_strategy='random', load_best_configs=False, device='cuda:0', seed=0, save_model_name='TGN_seed0')
INFO:root:model -> Sequential(
  (0): MemoryModel(
    (src_memory_encoder): Linear(in_features=172, out_features=172, bias=True)
    (dst_memory_encoder): Linear(in_features=172, out_features=172, bias=True)
    (edge_encoder): Linear(in_features=172, out_features=172, bias=True)
    (channel_attention): ChannelAttentionTemporal(
      (avg_pool): AdaptiveAvgPool1d(output_size=1)
      (max_pool): AdaptiveMaxPool1d(output_size=1)
      (fc1): Linear(in_features=4, out_features=0, bias=False)
      (relu1): ReLU()
      (fc2): Linear(in_features=0, out_features=4, bias=False)
      (sigmoid): Sigmoid()
    )
    (time_encoder): TimeEncoder(
      (w): Linear(in_features=1, out_features=100, bias=True)
    )
    (message_aggregator): MessageAggregator()
    (memory_bank): MemoryBank(num_nodes=1900, memory_dim=172)
    (memory_updater): CFCMemoryUpdater(
      (memory_bank): MemoryBank(num_nodes=1900, memory_dim=172)
      (memory_updater): MoE(
        (mixer): Linear(in_features=788, out_features=616, bias=True)
        (relu): ReLU(inplace=True)
        (experts): ModuleList(
          (0-2): 3 x rnnmodule(
            (cell): GRUCell(616, 172)
            (relu): ReLU()
          )
          (3-5): 3 x cfcmodule(
            (cell): cfcbundle(
              (rnn_cell): CfCCell(
                (backbone): Sequential(
                  (0): Linear(in_features=788, out_features=128, bias=True)
                  (1): LeCun(
                    (tanh): Tanh()
                  )
                )
                (tanh): Tanh()
                (sigmoid): Sigmoid()
                (ff1): Linear(in_features=128, out_features=172, bias=True)
                (ff2): Linear(in_features=128, out_features=172, bias=True)
                (time_a): Linear(in_features=128, out_features=172, bias=True)
                (time_b): Linear(in_features=128, out_features=172, bias=True)
              )
              (leaky_factor): Linear(in_features=616, out_features=172, bias=True)
            )
            (relu): ReLU()
          )
        )
        (softplus): Softplus(beta=1.0, threshold=20.0)
        (softmax): Softmax(dim=1)
      )
    )
    (embedding_module): GraphAttentionEmbedding(
      (time_encoder): TimeEncoder(
        (w): Linear(in_features=1, out_features=100, bias=True)
      )
      (temporal_conv_layers): ModuleList(
        (0-1): 2 x MultiHeadAttention(
          (query_projection): Linear(in_features=272, out_features=272, bias=False)
          (key_projection): Linear(in_features=444, out_features=272, bias=False)
          (value_projection): Linear(in_features=444, out_features=272, bias=False)
          (layer_norm): LayerNorm((272,), eps=1e-05, elementwise_affine=True)
          (residual_fc): Linear(in_features=272, out_features=272, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (merge_layers): ModuleList(
        (0-1): 2 x MergeLayer(
          (fc1): Linear(in_features=444, out_features=172, bias=True)
          (fc2): Linear(in_features=172, out_features=172, bias=True)
          (act): ReLU()
        )
      )
    )
  )
  (1): MergeLayer(
    (fc1): Linear(in_features=344, out_features=172, bias=True)
    (fc2): Linear(in_features=172, out_features=1, bias=True)
    (act): ReLU()
  )
)
INFO:root:model name: TGN, #parameters: 14984612 B, 14633.41015625 KB, 14.29043960571289 MB.
INFO:root:Epoch: 1, learning rate: 0.00016374239897486902, train loss: 0.4418
INFO:root:train average_precision, 0.8903
INFO:root:train roc_auc, 0.8827
INFO:root:validate loss: 0.5149
INFO:root:validate average_precision, 0.8315
INFO:root:validate roc_auc, 0.8165
INFO:root:new node validate loss: 0.5813
INFO:root:new node validate average_precision, 0.7882
INFO:root:new node validate roc_auc, 0.7485
INFO:root:save model ./saved_models/TGN/uci/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 2, learning rate: 8.126186854142736e-05, train loss: 0.3947
INFO:root:train average_precision, 0.9045
INFO:root:train roc_auc, 0.8982
INFO:root:validate loss: 0.5008
INFO:root:validate average_precision, 0.8304
INFO:root:validate roc_auc, 0.8181
INFO:root:new node validate loss: 0.5913
INFO:root:new node validate average_precision, 0.7767
INFO:root:new node validate roc_auc, 0.7358
INFO:root:Epoch: 3, learning rate: 1.2369331995613646e-05, train loss: 0.3802
INFO:root:train average_precision, 0.9099
INFO:root:train roc_auc, 0.9052
INFO:root:validate loss: 0.5040
INFO:root:validate average_precision, 0.8240
INFO:root:validate roc_auc, 0.8155
INFO:root:new node validate loss: 0.5879
INFO:root:new node validate average_precision, 0.7730
INFO:root:new node validate roc_auc, 0.7355
INFO:root:Epoch: 4, learning rate: 7.022351411174938e-06, train loss: 0.3748
INFO:root:train average_precision, 0.9161
INFO:root:train roc_auc, 0.9105
INFO:root:validate loss: 0.4919
INFO:root:validate average_precision, 0.8339
INFO:root:validate roc_auc, 0.8260
INFO:root:new node validate loss: 0.5810
INFO:root:new node validate average_precision, 0.7800
INFO:root:new node validate roc_auc, 0.7406
INFO:root:save model ./saved_models/TGN/uci/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 5, learning rate: 6.909830056248985e-05, train loss: 0.3750
INFO:root:train average_precision, 0.9190
INFO:root:train roc_auc, 0.9122
INFO:root:validate loss: 0.4935
INFO:root:validate average_precision, 0.8349
INFO:root:validate roc_auc, 0.8257
INFO:root:new node validate loss: 0.5984
INFO:root:new node validate average_precision, 0.7745
INFO:root:new node validate roc_auc, 0.7324
INFO:root:Epoch: 6, learning rate: 0.00015358267949790012, train loss: 0.3649
INFO:root:train average_precision, 0.9201
INFO:root:train roc_auc, 0.9136
INFO:root:validate loss: 0.4758
INFO:root:validate average_precision, 0.8526
INFO:root:validate roc_auc, 0.8414
INFO:root:new node validate loss: 0.5810
INFO:root:new node validate average_precision, 0.7831
INFO:root:new node validate roc_auc, 0.7409
INFO:root:save model ./saved_models/TGN/uci/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 7, learning rate: 0.00019921147013149252, train loss: 0.3638
INFO:root:train average_precision, 0.9193
INFO:root:train roc_auc, 0.9132
INFO:root:validate loss: 0.4844
INFO:root:validate average_precision, 0.8402
INFO:root:validate roc_auc, 0.8316
INFO:root:new node validate loss: 0.5841
INFO:root:new node validate average_precision, 0.7808
INFO:root:new node validate roc_auc, 0.7396
INFO:root:Epoch: 8, learning rate: 0.00017289686274217977, train loss: 0.3641
INFO:root:train average_precision, 0.9196
INFO:root:train roc_auc, 0.9138
INFO:root:validate loss: 0.4751
INFO:root:validate average_precision, 0.8493
INFO:root:validate roc_auc, 0.8409
INFO:root:new node validate loss: 0.5819
INFO:root:new node validate average_precision, 0.7895
INFO:root:new node validate roc_auc, 0.7510
INFO:root:Epoch: 9, learning rate: 9.372094804704758e-05, train loss: 0.3560
INFO:root:train average_precision, 0.9228
INFO:root:train roc_auc, 0.9169
INFO:root:validate loss: 0.4638
INFO:root:validate average_precision, 0.8601
INFO:root:validate roc_auc, 0.8515
INFO:root:new node validate loss: 0.5803
INFO:root:new node validate average_precision, 0.7942
INFO:root:new node validate roc_auc, 0.7578
INFO:root:save model ./saved_models/TGN/uci/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 10, learning rate: 1.9098300562509427e-05, train loss: 0.3563
INFO:root:train average_precision, 0.9215
INFO:root:train roc_auc, 0.9163
INFO:root:validate loss: 0.4713
INFO:root:validate average_precision, 0.8524
INFO:root:validate roc_auc, 0.8439
INFO:root:new node validate loss: 0.5681
INFO:root:new node validate average_precision, 0.7990
INFO:root:new node validate roc_auc, 0.7635
INFO:root:test loss: 0.4649
INFO:root:test average_precision, 0.8612
INFO:root:test roc_auc, 0.8539
INFO:root:new node test loss: 0.5220
INFO:root:new node test average_precision, 0.8149
INFO:root:new node test roc_auc, 0.7947
INFO:root:Epoch: 11, learning rate: 3.1416838871375353e-06, train loss: 0.3555
INFO:root:train average_precision, 0.9235
INFO:root:train roc_auc, 0.9182
INFO:root:validate loss: 0.4702
INFO:root:validate average_precision, 0.8516
INFO:root:validate roc_auc, 0.8464
INFO:root:new node validate loss: 0.5810
INFO:root:new node validate average_precision, 0.7861
INFO:root:new node validate roc_auc, 0.7473
INFO:root:Epoch: 12, learning rate: 5.742207084350565e-05, train loss: 0.3630
INFO:root:train average_precision, 0.9211
INFO:root:train roc_auc, 0.9156
INFO:root:validate loss: 0.4619
INFO:root:validate average_precision, 0.8553
INFO:root:validate roc_auc, 0.8516
INFO:root:new node validate loss: 0.5877
INFO:root:new node validate average_precision, 0.7882
INFO:root:new node validate roc_auc, 0.7518
INFO:root:Epoch: 13, learning rate: 0.00014257792915647467, train loss: 0.3596
INFO:root:train average_precision, 0.9209
INFO:root:train roc_auc, 0.9168
INFO:root:validate loss: 0.4511
INFO:root:validate average_precision, 0.8612
INFO:root:validate roc_auc, 0.8605
INFO:root:new node validate loss: 0.5932
INFO:root:new node validate average_precision, 0.7838
INFO:root:new node validate roc_auc, 0.7403
INFO:root:save model ./saved_models/TGN/uci/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 14, learning rate: 0.00019685831611290764, train loss: 0.3528
INFO:root:train average_precision, 0.9233
INFO:root:train roc_auc, 0.9192
INFO:root:validate loss: 0.4772
INFO:root:validate average_precision, 0.8425
INFO:root:validate roc_auc, 0.8407
INFO:root:new node validate loss: 0.6055
INFO:root:new node validate average_precision, 0.7772
INFO:root:new node validate roc_auc, 0.7305
INFO:root:Epoch: 15, learning rate: 0.0001809016994376168, train loss: 0.3533
INFO:root:train average_precision, 0.9216
INFO:root:train roc_auc, 0.9184
INFO:root:validate loss: 0.4423
INFO:root:validate average_precision, 0.8694
INFO:root:validate roc_auc, 0.8694
INFO:root:new node validate loss: 0.5823
INFO:root:new node validate average_precision, 0.7940
INFO:root:new node validate roc_auc, 0.7612
INFO:root:save model ./saved_models/TGN/uci/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 16, learning rate: 0.00010627905195295439, train loss: 0.3454
INFO:root:train average_precision, 0.9265
INFO:root:train roc_auc, 0.9231
INFO:root:validate loss: 0.4491
INFO:root:validate average_precision, 0.8617
INFO:root:validate roc_auc, 0.8605
INFO:root:new node validate loss: 0.5918
INFO:root:new node validate average_precision, 0.7872
INFO:root:new node validate roc_auc, 0.7510
INFO:root:Epoch: 17, learning rate: 2.7103137257852454e-05, train loss: 0.3448
INFO:root:train average_precision, 0.9260
INFO:root:train roc_auc, 0.9227
INFO:root:validate loss: 0.4516
INFO:root:validate average_precision, 0.8621
INFO:root:validate roc_auc, 0.8597
INFO:root:new node validate loss: 0.5823
INFO:root:new node validate average_precision, 0.7895
INFO:root:new node validate roc_auc, 0.7540
INFO:root:Epoch: 18, learning rate: 7.885298685520349e-07, train loss: 0.3438
INFO:root:train average_precision, 0.9272
INFO:root:train roc_auc, 0.9240
INFO:root:validate loss: 0.4480
INFO:root:validate average_precision, 0.8620
INFO:root:validate roc_auc, 0.8621
INFO:root:new node validate loss: 0.5870
INFO:root:new node validate average_precision, 0.7956
INFO:root:new node validate roc_auc, 0.7629
INFO:root:Epoch: 19, learning rate: 4.641732050211155e-05, train loss: 0.3463
INFO:root:train average_precision, 0.9270
INFO:root:train roc_auc, 0.9236
INFO:root:validate loss: 0.4441
INFO:root:validate average_precision, 0.8655
INFO:root:validate roc_auc, 0.8658
INFO:root:new node validate loss: 0.5871
INFO:root:new node validate average_precision, 0.8046
INFO:root:new node validate roc_auc, 0.7723
INFO:root:Epoch: 20, learning rate: 0.00013090169943758345, train loss: 0.3410
INFO:root:train average_precision, 0.9277
INFO:root:train roc_auc, 0.9249
INFO:root:validate loss: 0.4418
INFO:root:validate average_precision, 0.8703
INFO:root:validate roc_auc, 0.8717
INFO:root:new node validate loss: 0.5896
INFO:root:new node validate average_precision, 0.8040
INFO:root:new node validate roc_auc, 0.7720
INFO:root:test loss: 0.4121
INFO:root:test average_precision, 0.8934
INFO:root:test roc_auc, 0.8965
INFO:root:new node test loss: 0.5209
INFO:root:new node test average_precision, 0.8374
INFO:root:new node test roc_auc, 0.8263
INFO:root:save model ./saved_models/TGN/uci/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 21, learning rate: 0.0001929776485888686, train loss: 0.3410
INFO:root:train average_precision, 0.9270
INFO:root:train roc_auc, 0.9247
INFO:root:validate loss: 0.4287
INFO:root:validate average_precision, 0.8845
INFO:root:validate roc_auc, 0.8853
INFO:root:new node validate loss: 0.5876
INFO:root:new node validate average_precision, 0.8256
INFO:root:new node validate roc_auc, 0.7988
INFO:root:save model ./saved_models/TGN/uci/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 22, learning rate: 0.00018763066800434467, train loss: 0.3385
INFO:root:train average_precision, 0.9286
INFO:root:train roc_auc, 0.9258
INFO:root:validate loss: 0.4411
INFO:root:validate average_precision, 0.8769
INFO:root:validate roc_auc, 0.8781
INFO:root:new node validate loss: 0.5984
INFO:root:new node validate average_precision, 0.8083
INFO:root:new node validate roc_auc, 0.7781
INFO:root:Epoch: 23, learning rate: 0.00011873813145862399, train loss: 0.3375
INFO:root:train average_precision, 0.9288
INFO:root:train roc_auc, 0.9269
INFO:root:validate loss: 0.4343
INFO:root:validate average_precision, 0.8723
INFO:root:validate roc_auc, 0.8722
INFO:root:new node validate loss: 0.5888
INFO:root:new node validate average_precision, 0.7919
INFO:root:new node validate roc_auc, 0.7537
INFO:root:Epoch: 24, learning rate: 3.6257601025131094e-05, train loss: 0.3382
INFO:root:train average_precision, 0.9286
INFO:root:train roc_auc, 0.9263
INFO:root:validate loss: 0.4391
INFO:root:validate average_precision, 0.8694
INFO:root:validate roc_auc, 0.8689
INFO:root:new node validate loss: 0.5696
INFO:root:new node validate average_precision, 0.8069
INFO:root:new node validate roc_auc, 0.7752
INFO:root:Epoch: 25, learning rate: 0.0, train loss: 0.3371
INFO:root:train average_precision, 0.9300
INFO:root:train roc_auc, 0.9269
INFO:root:validate loss: 0.4444
INFO:root:validate average_precision, 0.8664
INFO:root:validate roc_auc, 0.8653
INFO:root:new node validate loss: 0.5836
INFO:root:new node validate average_precision, 0.8044
INFO:root:new node validate roc_auc, 0.7703
INFO:root:Epoch: 26, learning rate: 3.625760102511391e-05, train loss: 0.3311
INFO:root:train average_precision, 0.9329
INFO:root:train roc_auc, 0.9303
INFO:root:validate loss: 0.4225
INFO:root:validate average_precision, 0.8798
INFO:root:validate roc_auc, 0.8807
INFO:root:new node validate loss: 0.5990
INFO:root:new node validate average_precision, 0.8143
INFO:root:new node validate roc_auc, 0.7849
INFO:root:Epoch: 27, learning rate: 0.00011873813145868208, train loss: 0.3407
INFO:root:train average_precision, 0.9290
INFO:root:train roc_auc, 0.9258
INFO:root:validate loss: 0.4282
INFO:root:validate average_precision, 0.8790
INFO:root:validate roc_auc, 0.8800
INFO:root:new node validate loss: 0.5873
INFO:root:new node validate average_precision, 0.8140
INFO:root:new node validate roc_auc, 0.7859
INFO:root:Epoch: 28, learning rate: 0.00018763066800447107, train loss: 0.3302
INFO:root:train average_precision, 0.9323
INFO:root:train roc_auc, 0.9296
INFO:root:validate loss: 0.4296
INFO:root:validate average_precision, 0.8761
INFO:root:validate roc_auc, 0.8782
INFO:root:new node validate loss: 0.5926
INFO:root:new node validate average_precision, 0.8142
INFO:root:new node validate roc_auc, 0.7856
INFO:root:Epoch: 29, learning rate: 0.0001929776485888243, train loss: 0.3319
INFO:root:train average_precision, 0.9314
INFO:root:train roc_auc, 0.9290
INFO:root:validate loss: 0.4372
INFO:root:validate average_precision, 0.8762
INFO:root:validate roc_auc, 0.8773
INFO:root:new node validate loss: 0.6087
INFO:root:new node validate average_precision, 0.8043
INFO:root:new node validate roc_auc, 0.7727
INFO:root:Epoch: 30, learning rate: 0.00013090169943767154, train loss: 0.3321
INFO:root:train average_precision, 0.9307
INFO:root:train roc_auc, 0.9286
INFO:root:validate loss: 0.4273
INFO:root:validate average_precision, 0.8780
INFO:root:validate roc_auc, 0.8783
INFO:root:new node validate loss: 0.5799
INFO:root:new node validate average_precision, 0.8117
INFO:root:new node validate roc_auc, 0.7789
INFO:root:test loss: 0.3989
INFO:root:test average_precision, 0.9101
INFO:root:test roc_auc, 0.9087
INFO:root:new node test loss: 0.5047
INFO:root:new node test average_precision, 0.8539
INFO:root:new node test roc_auc, 0.8429
INFO:root:Epoch: 31, learning rate: 4.641732050214138e-05, train loss: 0.3286
INFO:root:train average_precision, 0.9330
INFO:root:train roc_auc, 0.9301
INFO:root:validate loss: 0.4330
INFO:root:validate average_precision, 0.8734
INFO:root:validate roc_auc, 0.8741
INFO:root:new node validate loss: 0.5829
INFO:root:new node validate average_precision, 0.7998
INFO:root:new node validate roc_auc, 0.7605
INFO:root:Epoch: 32, learning rate: 7.885298685523453e-07, train loss: 0.3299
INFO:root:train average_precision, 0.9326
INFO:root:train roc_auc, 0.9296
INFO:root:validate loss: 0.4269
INFO:root:validate average_precision, 0.8772
INFO:root:validate roc_auc, 0.8772
INFO:root:new node validate loss: 0.5962
INFO:root:new node validate average_precision, 0.8065
INFO:root:new node validate roc_auc, 0.7664
INFO:root:Epoch: 33, learning rate: 2.7103137257871025e-05, train loss: 0.3288
INFO:root:train average_precision, 0.9342
INFO:root:train roc_auc, 0.9318
INFO:root:validate loss: 0.4314
INFO:root:validate average_precision, 0.8753
INFO:root:validate roc_auc, 0.8756
INFO:root:new node validate loss: 0.5947
INFO:root:new node validate average_precision, 0.8199
INFO:root:new node validate roc_auc, 0.7905
INFO:root:Epoch: 34, learning rate: 0.00010627905195293237, train loss: 0.3346
INFO:root:train average_precision, 0.9315
INFO:root:train roc_auc, 0.9286
INFO:root:validate loss: 0.4257
INFO:root:validate average_precision, 0.8822
INFO:root:validate roc_auc, 0.8854
INFO:root:new node validate loss: 0.6069
INFO:root:new node validate average_precision, 0.8277
INFO:root:new node validate roc_auc, 0.8035
INFO:root:Epoch: 35, learning rate: 0.00018090169943741467, train loss: 0.3295
INFO:root:train average_precision, 0.9324
INFO:root:train roc_auc, 0.9305
INFO:root:validate loss: 0.4337
INFO:root:validate average_precision, 0.8824
INFO:root:validate roc_auc, 0.8827
INFO:root:new node validate loss: 0.5981
INFO:root:new node validate average_precision, 0.8227
INFO:root:new node validate roc_auc, 0.7949
INFO:root:Epoch: 36, learning rate: 0.00019685831611304034, train loss: 0.3258
INFO:root:train average_precision, 0.9342
INFO:root:train roc_auc, 0.9320
INFO:root:validate loss: 0.4389
INFO:root:validate average_precision, 0.8854
INFO:root:validate roc_auc, 0.8839
INFO:root:new node validate loss: 0.6248
INFO:root:new node validate average_precision, 0.8308
INFO:root:new node validate roc_auc, 0.7977
INFO:root:Epoch: 37, learning rate: 0.00014257792915657063, train loss: 0.3229
INFO:root:train average_precision, 0.9350
INFO:root:train roc_auc, 0.9327
INFO:root:validate loss: 0.4270
INFO:root:validate average_precision, 0.8924
INFO:root:validate roc_auc, 0.8920
INFO:root:new node validate loss: 0.5980
INFO:root:new node validate average_precision, 0.8404
INFO:root:new node validate roc_auc, 0.8130
INFO:root:save model ./saved_models/TGN/uci/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 38, learning rate: 5.742207084349114e-05, train loss: 0.3226
INFO:root:train average_precision, 0.9366
INFO:root:train roc_auc, 0.9334
INFO:root:validate loss: 0.4205
INFO:root:validate average_precision, 0.8845
INFO:root:validate roc_auc, 0.8823
INFO:root:new node validate loss: 0.5698
INFO:root:new node validate average_precision, 0.8255
INFO:root:new node validate roc_auc, 0.7956
INFO:root:Epoch: 39, learning rate: 3.1416838871355007e-06, train loss: 0.3196
INFO:root:train average_precision, 0.9368
INFO:root:train roc_auc, 0.9341
INFO:root:validate loss: 0.4143
INFO:root:validate average_precision, 0.8906
INFO:root:validate roc_auc, 0.8887
INFO:root:new node validate loss: 0.5868
INFO:root:new node validate average_precision, 0.8348
INFO:root:new node validate roc_auc, 0.8053
INFO:root:Epoch: 40, learning rate: 1.909830056249714e-05, train loss: 0.3218
INFO:root:train average_precision, 0.9364
INFO:root:train roc_auc, 0.9342
INFO:root:validate loss: 0.4136
INFO:root:validate average_precision, 0.8882
INFO:root:validate roc_auc, 0.8875
INFO:root:new node validate loss: 0.5768
INFO:root:new node validate average_precision, 0.8411
INFO:root:new node validate roc_auc, 0.8124
INFO:root:test loss: 0.3802
INFO:root:test average_precision, 0.9167
INFO:root:test roc_auc, 0.9142
INFO:root:new node test loss: 0.4876
INFO:root:new node test average_precision, 0.8706
INFO:root:new node test roc_auc, 0.8597
INFO:root:Epoch: 41, learning rate: 9.37209480470043e-05, train loss: 0.3246
INFO:root:train average_precision, 0.9368
INFO:root:train roc_auc, 0.9339
INFO:root:validate loss: 0.4254
INFO:root:validate average_precision, 0.8868
INFO:root:validate roc_auc, 0.8882
INFO:root:new node validate loss: 0.6041
INFO:root:new node validate average_precision, 0.8395
INFO:root:new node validate roc_auc, 0.8127
INFO:root:Epoch: 42, learning rate: 0.00017289686274194672, train loss: 0.3211
INFO:root:train average_precision, 0.9354
INFO:root:train roc_auc, 0.9331
INFO:root:validate loss: 0.4203
INFO:root:validate average_precision, 0.8899
INFO:root:validate roc_auc, 0.8890
INFO:root:new node validate loss: 0.5716
INFO:root:new node validate average_precision, 0.8472
INFO:root:new node validate roc_auc, 0.8208
INFO:root:Epoch: 43, learning rate: 0.00019921147013185085, train loss: 0.3197
INFO:root:train average_precision, 0.9376
INFO:root:train roc_auc, 0.9344
INFO:root:validate loss: 0.4295
INFO:root:validate average_precision, 0.8880
INFO:root:validate roc_auc, 0.8862
INFO:root:new node validate loss: 0.5991
INFO:root:new node validate average_precision, 0.8438
INFO:root:new node validate roc_auc, 0.8163
INFO:root:Epoch: 44, learning rate: 0.0001535826794981424, train loss: 0.3150
INFO:root:train average_precision, 0.9388
INFO:root:train roc_auc, 0.9363
INFO:root:validate loss: 0.4254
INFO:root:validate average_precision, 0.8982
INFO:root:validate roc_auc, 0.8947
INFO:root:new node validate loss: 0.6085
INFO:root:new node validate average_precision, 0.8480
INFO:root:new node validate roc_auc, 0.8195
INFO:root:save model ./saved_models/TGN/uci/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 45, learning rate: 6.909830056258304e-05, train loss: 0.3169
INFO:root:train average_precision, 0.9384
INFO:root:train roc_auc, 0.9351
INFO:root:validate loss: 0.4224
INFO:root:validate average_precision, 0.8859
INFO:root:validate roc_auc, 0.8847
INFO:root:new node validate loss: 0.5812
INFO:root:new node validate average_precision, 0.8310
INFO:root:new node validate roc_auc, 0.8041
INFO:root:Epoch: 46, learning rate: 7.022351411178251e-06, train loss: 0.3147
INFO:root:train average_precision, 0.9387
INFO:root:train roc_auc, 0.9359
INFO:root:validate loss: 0.4207
INFO:root:validate average_precision, 0.8892
INFO:root:validate roc_auc, 0.8872
INFO:root:new node validate loss: 0.5801
INFO:root:new node validate average_precision, 0.8345
INFO:root:new node validate roc_auc, 0.8026
INFO:root:Epoch: 47, learning rate: 1.2369331995621503e-05, train loss: 0.3123
INFO:root:train average_precision, 0.9405
INFO:root:train roc_auc, 0.9373
INFO:root:validate loss: 0.4129
INFO:root:validate average_precision, 0.8911
INFO:root:validate roc_auc, 0.8895
INFO:root:new node validate loss: 0.5863
INFO:root:new node validate average_precision, 0.8381
INFO:root:new node validate roc_auc, 0.8114
INFO:root:Epoch: 48, learning rate: 8.126186854144578e-05, train loss: 0.3213
INFO:root:train average_precision, 0.9374
INFO:root:train roc_auc, 0.9346
INFO:root:validate loss: 0.4218
INFO:root:validate average_precision, 0.8911
INFO:root:validate roc_auc, 0.8890
INFO:root:new node validate loss: 0.5930
INFO:root:new node validate average_precision, 0.8415
INFO:root:new node validate roc_auc, 0.8147
INFO:root:Epoch: 49, learning rate: 0.00016374239897483278, train loss: 0.3163
INFO:root:train average_precision, 0.9379
INFO:root:train roc_auc, 0.9355
INFO:root:validate loss: 0.4283
INFO:root:validate average_precision, 0.8918
INFO:root:validate roc_auc, 0.8903
INFO:root:new node validate loss: 0.6163
INFO:root:new node validate average_precision, 0.8426
INFO:root:new node validate roc_auc, 0.8175
INFO:root:Epoch: 50, learning rate: 0.00020000000000022514, train loss: 0.3141
INFO:root:train average_precision, 0.9400
INFO:root:train roc_auc, 0.9370
INFO:root:validate loss: 0.4254
INFO:root:validate average_precision, 0.8912
INFO:root:validate roc_auc, 0.8902
INFO:root:new node validate loss: 0.6023
INFO:root:new node validate average_precision, 0.8392
INFO:root:new node validate roc_auc, 0.8133
INFO:root:test loss: 0.4060
INFO:root:test average_precision, 0.9230
INFO:root:test roc_auc, 0.9215
INFO:root:new node test loss: 0.5498
INFO:root:new node test average_precision, 0.8712
INFO:root:new node test roc_auc, 0.8608
INFO:root:Epoch: 51, learning rate: 0.00016374239897527237, train loss: 0.3153
INFO:root:train average_precision, 0.9389
INFO:root:train roc_auc, 0.9359
INFO:root:validate loss: 0.4117
INFO:root:validate average_precision, 0.8925
INFO:root:validate roc_auc, 0.8903
INFO:root:new node validate loss: 0.5621
INFO:root:new node validate average_precision, 0.8431
INFO:root:new node validate roc_auc, 0.8162
INFO:root:Epoch: 52, learning rate: 8.126186854144786e-05, train loss: 0.3118
INFO:root:train average_precision, 0.9405
INFO:root:train roc_auc, 0.9374
INFO:root:validate loss: 0.4257
INFO:root:validate average_precision, 0.8911
INFO:root:validate roc_auc, 0.8890
INFO:root:new node validate loss: 0.6128
INFO:root:new node validate average_precision, 0.8388
INFO:root:new node validate roc_auc, 0.8109
INFO:root:Epoch: 53, learning rate: 1.236933199563365e-05, train loss: 0.3096
INFO:root:train average_precision, 0.9411
INFO:root:train roc_auc, 0.9381
INFO:root:validate loss: 0.4132
INFO:root:validate average_precision, 0.8977
INFO:root:validate roc_auc, 0.8949
INFO:root:new node validate loss: 0.5751
INFO:root:new node validate average_precision, 0.8452
INFO:root:new node validate roc_auc, 0.8188
INFO:root:Epoch: 54, learning rate: 7.022351411187958e-06, train loss: 0.3108
INFO:root:train average_precision, 0.9412
INFO:root:train roc_auc, 0.9381
INFO:root:validate loss: 0.4154
INFO:root:validate average_precision, 0.8916
INFO:root:validate roc_auc, 0.8906
INFO:root:new node validate loss: 0.5932
INFO:root:new node validate average_precision, 0.8394
INFO:root:new node validate roc_auc, 0.8128
INFO:root:Epoch: 55, learning rate: 6.909830056245937e-05, train loss: 0.3142
INFO:root:train average_precision, 0.9406
INFO:root:train roc_auc, 0.9374
INFO:root:validate loss: 0.4176
INFO:root:validate average_precision, 0.8923
INFO:root:validate roc_auc, 0.8905
INFO:root:new node validate loss: 0.6011
INFO:root:new node validate average_precision, 0.8426
INFO:root:new node validate roc_auc, 0.8166
INFO:root:Epoch: 56, learning rate: 0.00015358267949800475, train loss: 0.3142
INFO:root:train average_precision, 0.9383
INFO:root:train roc_auc, 0.9361
INFO:root:validate loss: 0.4368
INFO:root:validate average_precision, 0.8909
INFO:root:validate roc_auc, 0.8896
INFO:root:new node validate loss: 0.6362
INFO:root:new node validate average_precision, 0.8446
INFO:root:new node validate roc_auc, 0.8195
INFO:root:Epoch: 57, learning rate: 0.00019921147013189584, train loss: 0.3112
INFO:root:train average_precision, 0.9407
INFO:root:train roc_auc, 0.9375
INFO:root:validate loss: 0.4407
INFO:root:validate average_precision, 0.8868
INFO:root:validate roc_auc, 0.8857
INFO:root:new node validate loss: 0.6366
INFO:root:new node validate average_precision, 0.8358
INFO:root:new node validate roc_auc, 0.8051
INFO:root:Epoch: 58, learning rate: 0.0001728968627421386, train loss: 0.3113
INFO:root:train average_precision, 0.9403
INFO:root:train roc_auc, 0.9375
INFO:root:validate loss: 0.4393
INFO:root:validate average_precision, 0.8940
INFO:root:validate roc_auc, 0.8921
INFO:root:new node validate loss: 0.6447
INFO:root:new node validate average_precision, 0.8402
INFO:root:new node validate roc_auc, 0.8104
INFO:root:Epoch: 59, learning rate: 9.372094804719067e-05, train loss: 0.3111
INFO:root:train average_precision, 0.9410
INFO:root:train roc_auc, 0.9377
INFO:root:validate loss: 0.4261
INFO:root:validate average_precision, 0.8946
INFO:root:validate roc_auc, 0.8912
INFO:root:new node validate loss: 0.6050
INFO:root:new node validate average_precision, 0.8371
INFO:root:new node validate roc_auc, 0.8076
INFO:root:Epoch: 60, learning rate: 1.9098300562488166e-05, train loss: 0.3081
INFO:root:train average_precision, 0.9419
INFO:root:train roc_auc, 0.9389
INFO:root:validate loss: 0.4110
INFO:root:validate average_precision, 0.8956
INFO:root:validate roc_auc, 0.8936
INFO:root:new node validate loss: 0.5900
INFO:root:new node validate average_precision, 0.8452
INFO:root:new node validate roc_auc, 0.8198
INFO:root:test loss: 0.3961
INFO:root:test average_precision, 0.9213
INFO:root:test roc_auc, 0.9183
INFO:root:new node test loss: 0.5219
INFO:root:new node test average_precision, 0.8771
INFO:root:new node test roc_auc, 0.8650
INFO:root:Epoch: 61, learning rate: 3.1416838871342586e-06, train loss: 0.3038
INFO:root:train average_precision, 0.9431
INFO:root:train roc_auc, 0.9405
INFO:root:validate loss: 0.4096
INFO:root:validate average_precision, 0.8947
INFO:root:validate roc_auc, 0.8926
INFO:root:new node validate loss: 0.5912
INFO:root:new node validate average_precision, 0.8441
INFO:root:new node validate roc_auc, 0.8179
INFO:root:Epoch: 62, learning rate: 5.7422070843520144e-05, train loss: 0.3050
INFO:root:train average_precision, 0.9432
INFO:root:train roc_auc, 0.9404
INFO:root:validate loss: 0.4166
INFO:root:validate average_precision, 0.8948
INFO:root:validate roc_auc, 0.8925
INFO:root:new node validate loss: 0.6003
INFO:root:new node validate average_precision, 0.8504
INFO:root:new node validate roc_auc, 0.8237
INFO:root:Epoch: 63, learning rate: 0.00014257792915625287, train loss: 0.3069
INFO:root:train average_precision, 0.9416
INFO:root:train roc_auc, 0.9390
INFO:root:validate loss: 0.4159
INFO:root:validate average_precision, 0.9006
INFO:root:validate roc_auc, 0.8967
INFO:root:new node validate loss: 0.5998
INFO:root:new node validate average_precision, 0.8528
INFO:root:new node validate roc_auc, 0.8261
INFO:root:save model ./saved_models/TGN/uci/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 64, learning rate: 0.00019685831611277526, train loss: 0.3083
INFO:root:train average_precision, 0.9411
INFO:root:train roc_auc, 0.9384
INFO:root:validate loss: 0.4415
INFO:root:validate average_precision, 0.8857
INFO:root:validate roc_auc, 0.8847
INFO:root:new node validate loss: 0.6017
INFO:root:new node validate average_precision, 0.8401
INFO:root:new node validate roc_auc, 0.8154
INFO:root:Epoch: 65, learning rate: 0.00018090169943765484, train loss: 0.3086
INFO:root:train average_precision, 0.9412
INFO:root:train roc_auc, 0.9388
INFO:root:validate loss: 0.4494
INFO:root:validate average_precision, 0.8925
INFO:root:validate roc_auc, 0.8909
INFO:root:new node validate loss: 0.6113
INFO:root:new node validate average_precision, 0.8444
INFO:root:new node validate roc_auc, 0.8189
INFO:root:Epoch: 66, learning rate: 0.00010627905195278804, train loss: 0.3090
INFO:root:train average_precision, 0.9423
INFO:root:train roc_auc, 0.9389
INFO:root:validate loss: 0.4146
INFO:root:validate average_precision, 0.8914
INFO:root:validate roc_auc, 0.8890
INFO:root:new node validate loss: 0.5787
INFO:root:new node validate average_precision, 0.8378
INFO:root:new node validate roc_auc, 0.8142
INFO:root:Epoch: 67, learning rate: 2.7103137257955887e-05, train loss: 0.3014
INFO:root:train average_precision, 0.9448
INFO:root:train roc_auc, 0.9415
INFO:root:validate loss: 0.4087
INFO:root:validate average_precision, 0.8953
INFO:root:validate roc_auc, 0.8928
INFO:root:new node validate loss: 0.5747
INFO:root:new node validate average_precision, 0.8436
INFO:root:new node validate roc_auc, 0.8191
INFO:root:Epoch: 68, learning rate: 7.885298685552731e-07, train loss: 0.3042
INFO:root:train average_precision, 0.9425
INFO:root:train roc_auc, 0.9402
INFO:root:validate loss: 0.4165
INFO:root:validate average_precision, 0.8936
INFO:root:validate roc_auc, 0.8929
INFO:root:new node validate loss: 0.6104
INFO:root:new node validate average_precision, 0.8472
INFO:root:new node validate roc_auc, 0.8215
INFO:root:Epoch: 69, learning rate: 4.64173205021652e-05, train loss: 0.3018
INFO:root:train average_precision, 0.9436
INFO:root:train roc_auc, 0.9409
INFO:root:validate loss: 0.4181
INFO:root:validate average_precision, 0.8920
INFO:root:validate roc_auc, 0.8908
INFO:root:new node validate loss: 0.5975
INFO:root:new node validate average_precision, 0.8451
INFO:root:new node validate roc_auc, 0.8213
INFO:root:Epoch: 70, learning rate: 0.00013090169943785155, train loss: 0.3037
INFO:root:train average_precision, 0.9434
INFO:root:train roc_auc, 0.9406
INFO:root:validate loss: 0.4321
INFO:root:validate average_precision, 0.8889
INFO:root:validate roc_auc, 0.8889
INFO:root:new node validate loss: 0.6179
INFO:root:new node validate average_precision, 0.8383
INFO:root:new node validate roc_auc, 0.8154
INFO:root:test loss: 0.3826
INFO:root:test average_precision, 0.9285
INFO:root:test roc_auc, 0.9260
INFO:root:new node test loss: 0.5306
INFO:root:new node test average_precision, 0.8777
INFO:root:new node test roc_auc, 0.8652
INFO:root:Epoch: 71, learning rate: 0.0001929776485889137, train loss: 0.3023
INFO:root:train average_precision, 0.9436
INFO:root:train roc_auc, 0.9411
INFO:root:validate loss: 0.4604
INFO:root:validate average_precision, 0.8827
INFO:root:validate roc_auc, 0.8846
INFO:root:new node validate loss: 0.6706
INFO:root:new node validate average_precision, 0.8385
INFO:root:new node validate roc_auc, 0.8158
INFO:root:Epoch: 72, learning rate: 0.0001876306680047241, train loss: 0.3052
INFO:root:train average_precision, 0.9423
INFO:root:train roc_auc, 0.9402
INFO:root:validate loss: 0.4471
INFO:root:validate average_precision, 0.8960
INFO:root:validate roc_auc, 0.8933
INFO:root:new node validate loss: 0.6272
INFO:root:new node validate average_precision, 0.8420
INFO:root:new node validate roc_auc, 0.8148
INFO:root:Epoch: 73, learning rate: 0.00011873813145851827, train loss: 0.2968
INFO:root:train average_precision, 0.9467
INFO:root:train roc_auc, 0.9432
INFO:root:validate loss: 0.4179
INFO:root:validate average_precision, 0.8956
INFO:root:validate roc_auc, 0.8922
INFO:root:new node validate loss: 0.5719
INFO:root:new node validate average_precision, 0.8506
INFO:root:new node validate roc_auc, 0.8246
INFO:root:Epoch: 74, learning rate: 3.625760102517048e-05, train loss: 0.2960
INFO:root:train average_precision, 0.9471
INFO:root:train roc_auc, 0.9438
INFO:root:validate loss: 0.4049
INFO:root:validate average_precision, 0.8964
INFO:root:validate roc_auc, 0.8939
INFO:root:new node validate loss: 0.5693
INFO:root:new node validate average_precision, 0.8458
INFO:root:new node validate roc_auc, 0.8201
INFO:root:Epoch: 75, learning rate: 0.0, train loss: 0.2943
INFO:root:train average_precision, 0.9469
INFO:root:train roc_auc, 0.9437
INFO:root:validate loss: 0.4243
INFO:root:validate average_precision, 0.8961
INFO:root:validate roc_auc, 0.8953
INFO:root:new node validate loss: 0.6287
INFO:root:new node validate average_precision, 0.8540
INFO:root:new node validate roc_auc, 0.8276
INFO:root:Epoch: 76, learning rate: 3.625760102509302e-05, train loss: 0.2934
INFO:root:train average_precision, 0.9475
INFO:root:train roc_auc, 0.9444
INFO:root:validate loss: 0.4117
INFO:root:validate average_precision, 0.8971
INFO:root:validate roc_auc, 0.8958
INFO:root:new node validate loss: 0.5850
INFO:root:new node validate average_precision, 0.8406
INFO:root:new node validate roc_auc, 0.8144
INFO:root:Epoch: 77, learning rate: 0.00011873813145859789, train loss: 0.2911
INFO:root:train average_precision, 0.9488
INFO:root:train roc_auc, 0.9459
INFO:root:validate loss: 0.4370
INFO:root:validate average_precision, 0.8964
INFO:root:validate roc_auc, 0.8963
INFO:root:new node validate loss: 0.6311
INFO:root:new node validate average_precision, 0.8417
INFO:root:new node validate roc_auc, 0.8160
INFO:root:Epoch: 78, learning rate: 0.00018763066800468162, train loss: 0.2975
INFO:root:train average_precision, 0.9460
INFO:root:train roc_auc, 0.9429
INFO:root:validate loss: 0.4247
INFO:root:validate average_precision, 0.8936
INFO:root:validate roc_auc, 0.8933
INFO:root:new node validate loss: 0.6015
INFO:root:new node validate average_precision, 0.8402
INFO:root:new node validate roc_auc, 0.8184
INFO:root:Epoch: 79, learning rate: 0.00019297764858869463, train loss: 0.2929
INFO:root:train average_precision, 0.9481
INFO:root:train roc_auc, 0.9451
INFO:root:validate loss: 0.4608
INFO:root:validate average_precision, 0.8929
INFO:root:validate roc_auc, 0.8934
INFO:root:new node validate loss: 0.6975
INFO:root:new node validate average_precision, 0.8326
INFO:root:new node validate roc_auc, 0.8111
INFO:root:Epoch: 80, learning rate: 0.00013090169943758156, train loss: 0.2960
INFO:root:train average_precision, 0.9473
INFO:root:train roc_auc, 0.9440
INFO:root:validate loss: 0.4246
INFO:root:validate average_precision, 0.8997
INFO:root:validate roc_auc, 0.8988
INFO:root:new node validate loss: 0.5956
INFO:root:new node validate average_precision, 0.8522
INFO:root:new node validate roc_auc, 0.8298
INFO:root:test loss: 0.4461
INFO:root:test average_precision, 0.9321
INFO:root:test roc_auc, 0.9293
INFO:root:new node test loss: 0.5853
INFO:root:new node test average_precision, 0.8852
INFO:root:new node test roc_auc, 0.8737
INFO:root:Epoch: 81, learning rate: 4.641732050202497e-05, train loss: 0.2943
INFO:root:train average_precision, 0.9475
INFO:root:train roc_auc, 0.9449
INFO:root:validate loss: 0.3964
INFO:root:validate average_precision, 0.9033
INFO:root:validate roc_auc, 0.9018
INFO:root:new node validate loss: 0.5636
INFO:root:new node validate average_precision, 0.8455
INFO:root:new node validate roc_auc, 0.8248
INFO:root:save model ./saved_models/TGN/uci/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 82, learning rate: 7.885298685551401e-07, train loss: 0.2889
INFO:root:train average_precision, 0.9494
INFO:root:train roc_auc, 0.9463
INFO:root:validate loss: 0.4300
INFO:root:validate average_precision, 0.9006
INFO:root:validate roc_auc, 0.9004
INFO:root:new node validate loss: 0.6291
INFO:root:new node validate average_precision, 0.8496
INFO:root:new node validate roc_auc, 0.8264
INFO:root:Epoch: 83, learning rate: 2.7103137257949535e-05, train loss: 0.2893
INFO:root:train average_precision, 0.9494
INFO:root:train roc_auc, 0.9465
INFO:root:validate loss: 0.4022
INFO:root:validate average_precision, 0.9061
INFO:root:validate roc_auc, 0.9049
INFO:root:new node validate loss: 0.6150
INFO:root:new node validate average_precision, 0.8470
INFO:root:new node validate roc_auc, 0.8204
INFO:root:save model ./saved_models/TGN/uci/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 84, learning rate: 0.00010627905195305074, train loss: 0.2916
INFO:root:train average_precision, 0.9483
INFO:root:train roc_auc, 0.9464
INFO:root:validate loss: 0.4111
INFO:root:validate average_precision, 0.9038
INFO:root:validate roc_auc, 0.9029
INFO:root:new node validate loss: 0.6143
INFO:root:new node validate average_precision, 0.8351
INFO:root:new node validate roc_auc, 0.8119
INFO:root:Epoch: 85, learning rate: 0.00018090169943794294, train loss: 0.2928
INFO:root:train average_precision, 0.9474
INFO:root:train roc_auc, 0.9451
INFO:root:validate loss: 0.4189
INFO:root:validate average_precision, 0.9018
INFO:root:validate roc_auc, 0.9006
INFO:root:new node validate loss: 0.6443
INFO:root:new node validate average_precision, 0.8398
INFO:root:new node validate roc_auc, 0.8143
INFO:root:Epoch: 86, learning rate: 0.0001968583161129072, train loss: 0.2884
INFO:root:train average_precision, 0.9497
INFO:root:train roc_auc, 0.9468
INFO:root:validate loss: 0.4461
INFO:root:validate average_precision, 0.9062
INFO:root:validate roc_auc, 0.9058
INFO:root:new node validate loss: 0.6759
INFO:root:new node validate average_precision, 0.8450
INFO:root:new node validate roc_auc, 0.8204
INFO:root:save model ./saved_models/TGN/uci/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 87, learning rate: 0.00014257792915672952, train loss: 0.2935
INFO:root:train average_precision, 0.9479
INFO:root:train roc_auc, 0.9453
INFO:root:validate loss: 0.4127
INFO:root:validate average_precision, 0.9024
INFO:root:validate roc_auc, 0.9016
INFO:root:new node validate loss: 0.6302
INFO:root:new node validate average_precision, 0.8425
INFO:root:new node validate roc_auc, 0.8186
INFO:root:Epoch: 88, learning rate: 5.742207084345588e-05, train loss: 0.2888
INFO:root:train average_precision, 0.9491
INFO:root:train roc_auc, 0.9465
INFO:root:validate loss: 0.3903
INFO:root:validate average_precision, 0.9100
INFO:root:validate roc_auc, 0.9082
INFO:root:new node validate loss: 0.5993
INFO:root:new node validate average_precision, 0.8524
INFO:root:new node validate roc_auc, 0.8275
INFO:root:save model ./saved_models/TGN/uci/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 89, learning rate: 3.141683887139303e-06, train loss: 0.2876
INFO:root:train average_precision, 0.9498
INFO:root:train roc_auc, 0.9473
INFO:root:validate loss: 0.4283
INFO:root:validate average_precision, 0.9069
INFO:root:validate roc_auc, 0.9062
INFO:root:new node validate loss: 0.6269
INFO:root:new node validate average_precision, 0.8509
INFO:root:new node validate roc_auc, 0.8256
INFO:root:Epoch: 90, learning rate: 1.9098300562518005e-05, train loss: 0.2857
INFO:root:train average_precision, 0.9504
INFO:root:train roc_auc, 0.9479
INFO:root:validate loss: 0.4078
INFO:root:validate average_precision, 0.9048
INFO:root:validate roc_auc, 0.9041
INFO:root:new node validate loss: 0.6366
INFO:root:new node validate average_precision, 0.8470
INFO:root:new node validate roc_auc, 0.8221
INFO:root:test loss: 0.3875
INFO:root:test average_precision, 0.9361
INFO:root:test roc_auc, 0.9328
INFO:root:new node test loss: 0.5434
INFO:root:new node test average_precision, 0.8896
INFO:root:new node test roc_auc, 0.8798
INFO:root:Epoch: 91, learning rate: 9.372094804728607e-05, train loss: 0.2861
INFO:root:train average_precision, 0.9504
INFO:root:train roc_auc, 0.9479
INFO:root:validate loss: 0.4151
INFO:root:validate average_precision, 0.9084
INFO:root:validate roc_auc, 0.9081
INFO:root:new node validate loss: 0.6741
INFO:root:new node validate average_precision, 0.8501
INFO:root:new node validate roc_auc, 0.8261
INFO:root:Epoch: 92, learning rate: 0.00017289686274214622, train loss: 0.2836
INFO:root:train average_precision, 0.9505
INFO:root:train roc_auc, 0.9487
INFO:root:validate loss: 0.4040
INFO:root:validate average_precision, 0.9064
INFO:root:validate roc_auc, 0.9048
INFO:root:new node validate loss: 0.5926
INFO:root:new node validate average_precision, 0.8432
INFO:root:new node validate roc_auc, 0.8115
INFO:root:Epoch: 93, learning rate: 0.00019921147013171706, train loss: 0.2835
INFO:root:train average_precision, 0.9513
INFO:root:train roc_auc, 0.9487
INFO:root:validate loss: 0.4352
INFO:root:validate average_precision, 0.9082
INFO:root:validate roc_auc, 0.9063
INFO:root:new node validate loss: 0.6469
INFO:root:new node validate average_precision, 0.8503
INFO:root:new node validate roc_auc, 0.8254
INFO:root:Epoch: 94, learning rate: 0.00015358267949776319, train loss: 0.2883
INFO:root:train average_precision, 0.9501
INFO:root:train roc_auc, 0.9473
INFO:root:validate loss: 0.4103
INFO:root:validate average_precision, 0.9089
INFO:root:validate roc_auc, 0.9063
INFO:root:new node validate loss: 0.6285
INFO:root:new node validate average_precision, 0.8517
INFO:root:new node validate roc_auc, 0.8179
INFO:root:Epoch: 95, learning rate: 6.909830056253745e-05, train loss: 0.2872
INFO:root:train average_precision, 0.9503
INFO:root:train roc_auc, 0.9477
INFO:root:validate loss: 0.3992
INFO:root:validate average_precision, 0.9104
INFO:root:validate roc_auc, 0.9087
INFO:root:new node validate loss: 0.5547
INFO:root:new node validate average_precision, 0.8531
INFO:root:new node validate roc_auc, 0.8289
INFO:root:save model ./saved_models/TGN/uci/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 96, learning rate: 7.022351411187594e-06, train loss: 0.2842
INFO:root:train average_precision, 0.9512
INFO:root:train roc_auc, 0.9481
INFO:root:validate loss: 0.4385
INFO:root:validate average_precision, 0.9072
INFO:root:validate roc_auc, 0.9063
INFO:root:new node validate loss: 0.6699
INFO:root:new node validate average_precision, 0.8478
INFO:root:new node validate roc_auc, 0.8232
INFO:root:Epoch: 97, learning rate: 1.2369331995636206e-05, train loss: 0.2831
INFO:root:train average_precision, 0.9516
INFO:root:train roc_auc, 0.9491
INFO:root:validate loss: 0.3952
INFO:root:validate average_precision, 0.9107
INFO:root:validate roc_auc, 0.9098
INFO:root:new node validate loss: 0.6163
INFO:root:new node validate average_precision, 0.8580
INFO:root:new node validate roc_auc, 0.8381
INFO:root:save model ./saved_models/TGN/uci/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 98, learning rate: 8.126186854168509e-05, train loss: 0.2837
INFO:root:train average_precision, 0.9513
INFO:root:train roc_auc, 0.9486
INFO:root:validate loss: 0.4022
INFO:root:validate average_precision, 0.9078
INFO:root:validate roc_auc, 0.9077
INFO:root:new node validate loss: 0.6289
INFO:root:new node validate average_precision, 0.8435
INFO:root:new node validate roc_auc, 0.8121
INFO:root:Epoch: 99, learning rate: 0.0001637423989756078, train loss: 0.2816
INFO:root:train average_precision, 0.9510
INFO:root:train roc_auc, 0.9486
INFO:root:validate loss: 0.4018
INFO:root:validate average_precision, 0.9115
INFO:root:validate roc_auc, 0.9103
INFO:root:new node validate loss: 0.6374
INFO:root:new node validate average_precision, 0.8516
INFO:root:new node validate roc_auc, 0.8289
INFO:root:save model ./saved_models/TGN/uci/TGN_seed0/TGN_seed0.pkl
INFO:root:Epoch: 100, learning rate: 0.0001999999999997302, train loss: 0.2815
INFO:root:train average_precision, 0.9515
INFO:root:train roc_auc, 0.9493
INFO:root:validate loss: 0.4198
INFO:root:validate average_precision, 0.9028
INFO:root:validate roc_auc, 0.9023
INFO:root:new node validate loss: 0.6695
INFO:root:new node validate average_precision, 0.8368
INFO:root:new node validate roc_auc, 0.8062
INFO:root:test loss: 0.4041
INFO:root:test average_precision, 0.9280
INFO:root:test roc_auc, 0.9267
INFO:root:new node test loss: 0.5700
INFO:root:new node test average_precision, 0.8794
INFO:root:new node test roc_auc, 0.8697
INFO:root:load model ./saved_models/TGN/uci/TGN_seed0/TGN_seed0.pkl
INFO:root:get final performance on dataset uci...
INFO:root:test loss: 0.4299
INFO:root:test average_precision, 0.9346
INFO:root:test roc_auc, 0.9335
INFO:root:new node test loss: 0.5931
INFO:root:new node test average_precision, 0.8872
INFO:root:new node test roc_auc, 0.8780
INFO:root:Run 1 cost 11583.35 seconds.
INFO:root:********** Run 2 starts. **********
INFO:root:configuration is Namespace(dataset_name='uci', batch_size=200, model_name='TGN', gpu=0, num_neighbors=10, sample_neighbor_strategy='recent', time_scaling_factor=1e-06, num_walk_heads=8, num_heads=2, num_layers=2, walk_length=1, time_gap=2000, time_feat_dim=100, position_feat_dim=172, edge_bank_memory_mode='unlimited_memory', time_window_mode='fixed_proportion', patch_size=200, channel_embedding_dim=50, max_input_sequence_length=64, learning_rate=0.0001, dropout=0.1, num_epochs=100, optimizer='Adam', weight_decay=0.0, patience=20, val_ratio=0.15, test_ratio=0.15, num_runs=5, test_interval_epochs=10, negative_sample_strategy='random', load_best_configs=False, device='cuda:0', seed=1, save_model_name='TGN_seed1')
INFO:root:model -> Sequential(
  (0): MemoryModel(
    (src_memory_encoder): Linear(in_features=172, out_features=172, bias=True)
    (dst_memory_encoder): Linear(in_features=172, out_features=172, bias=True)
    (edge_encoder): Linear(in_features=172, out_features=172, bias=True)
    (channel_attention): ChannelAttentionTemporal(
      (avg_pool): AdaptiveAvgPool1d(output_size=1)
      (max_pool): AdaptiveMaxPool1d(output_size=1)
      (fc1): Linear(in_features=4, out_features=0, bias=False)
      (relu1): ReLU()
      (fc2): Linear(in_features=0, out_features=4, bias=False)
      (sigmoid): Sigmoid()
    )
    (time_encoder): TimeEncoder(
      (w): Linear(in_features=1, out_features=100, bias=True)
    )
    (message_aggregator): MessageAggregator()
    (memory_bank): MemoryBank(num_nodes=1900, memory_dim=172)
    (memory_updater): CFCMemoryUpdater(
      (memory_bank): MemoryBank(num_nodes=1900, memory_dim=172)
      (memory_updater): MoE(
        (mixer): Linear(in_features=788, out_features=616, bias=True)
        (relu): ReLU(inplace=True)
        (experts): ModuleList(
          (0-2): 3 x rnnmodule(
            (cell): GRUCell(616, 172)
            (relu): ReLU()
          )
          (3-5): 3 x cfcmodule(
            (cell): cfcbundle(
              (rnn_cell): CfCCell(
                (backbone): Sequential(
                  (0): Linear(in_features=788, out_features=128, bias=True)
                  (1): LeCun(
                    (tanh): Tanh()
                  )
                )
                (tanh): Tanh()
                (sigmoid): Sigmoid()
                (ff1): Linear(in_features=128, out_features=172, bias=True)
                (ff2): Linear(in_features=128, out_features=172, bias=True)
                (time_a): Linear(in_features=128, out_features=172, bias=True)
                (time_b): Linear(in_features=128, out_features=172, bias=True)
              )
              (leaky_factor): Linear(in_features=616, out_features=172, bias=True)
            )
            (relu): ReLU()
          )
        )
        (softplus): Softplus(beta=1.0, threshold=20.0)
        (softmax): Softmax(dim=1)
      )
    )
    (embedding_module): GraphAttentionEmbedding(
      (time_encoder): TimeEncoder(
        (w): Linear(in_features=1, out_features=100, bias=True)
      )
      (temporal_conv_layers): ModuleList(
        (0-1): 2 x MultiHeadAttention(
          (query_projection): Linear(in_features=272, out_features=272, bias=False)
          (key_projection): Linear(in_features=444, out_features=272, bias=False)
          (value_projection): Linear(in_features=444, out_features=272, bias=False)
          (layer_norm): LayerNorm((272,), eps=1e-05, elementwise_affine=True)
          (residual_fc): Linear(in_features=272, out_features=272, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (merge_layers): ModuleList(
        (0-1): 2 x MergeLayer(
          (fc1): Linear(in_features=444, out_features=172, bias=True)
          (fc2): Linear(in_features=172, out_features=172, bias=True)
          (act): ReLU()
        )
      )
    )
  )
  (1): MergeLayer(
    (fc1): Linear(in_features=344, out_features=172, bias=True)
    (fc2): Linear(in_features=172, out_features=1, bias=True)
    (act): ReLU()
  )
)
INFO:root:model name: TGN, #parameters: 14984612 B, 14633.41015625 KB, 14.29043960571289 MB.
INFO:root:Epoch: 1, learning rate: 0.00016374239897486902, train loss: 0.4444
INFO:root:train average_precision, 0.8914
INFO:root:train roc_auc, 0.8824
INFO:root:validate loss: 0.5122
INFO:root:validate average_precision, 0.8288
INFO:root:validate roc_auc, 0.8132
INFO:root:new node validate loss: 0.5844
INFO:root:new node validate average_precision, 0.7788
INFO:root:new node validate roc_auc, 0.7345
INFO:root:save model ./saved_models/TGN/uci/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 2, learning rate: 8.126186854142736e-05, train loss: 0.3852
INFO:root:train average_precision, 0.9098
INFO:root:train roc_auc, 0.9037
INFO:root:validate loss: 0.4905
INFO:root:validate average_precision, 0.8396
INFO:root:validate roc_auc, 0.8282
INFO:root:new node validate loss: 0.5793
INFO:root:new node validate average_precision, 0.7833
INFO:root:new node validate roc_auc, 0.7456
INFO:root:save model ./saved_models/TGN/uci/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 3, learning rate: 1.2369331995613646e-05, train loss: 0.3787
INFO:root:train average_precision, 0.9100
INFO:root:train roc_auc, 0.9068
INFO:root:validate loss: 0.4974
INFO:root:validate average_precision, 0.8303
INFO:root:validate roc_auc, 0.8219
INFO:root:new node validate loss: 0.5898
INFO:root:new node validate average_precision, 0.7753
INFO:root:new node validate roc_auc, 0.7385
INFO:root:Epoch: 4, learning rate: 7.022351411174938e-06, train loss: 0.3826
INFO:root:train average_precision, 0.9103
INFO:root:train roc_auc, 0.9048
INFO:root:validate loss: 0.5111
INFO:root:validate average_precision, 0.8147
INFO:root:validate roc_auc, 0.8086
INFO:root:new node validate loss: 0.5860
INFO:root:new node validate average_precision, 0.7674
INFO:root:new node validate roc_auc, 0.7310
INFO:root:Epoch: 5, learning rate: 6.909830056248985e-05, train loss: 0.3822
INFO:root:train average_precision, 0.9155
INFO:root:train roc_auc, 0.9099
INFO:root:validate loss: 0.4836
INFO:root:validate average_precision, 0.8416
INFO:root:validate roc_auc, 0.8355
INFO:root:new node validate loss: 0.6037
INFO:root:new node validate average_precision, 0.7666
INFO:root:new node validate roc_auc, 0.7223
INFO:root:save model ./saved_models/TGN/uci/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 6, learning rate: 0.00015358267949790012, train loss: 0.3763
INFO:root:train average_precision, 0.9152
INFO:root:train roc_auc, 0.9099
INFO:root:validate loss: 0.4783
INFO:root:validate average_precision, 0.8518
INFO:root:validate roc_auc, 0.8424
INFO:root:new node validate loss: 0.6206
INFO:root:new node validate average_precision, 0.7491
INFO:root:new node validate roc_auc, 0.6992
INFO:root:save model ./saved_models/TGN/uci/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 7, learning rate: 0.00019921147013149252, train loss: 0.3824
INFO:root:train average_precision, 0.9090
INFO:root:train roc_auc, 0.9029
INFO:root:validate loss: 0.5155
INFO:root:validate average_precision, 0.8123
INFO:root:validate roc_auc, 0.8061
INFO:root:new node validate loss: 0.6028
INFO:root:new node validate average_precision, 0.7575
INFO:root:new node validate roc_auc, 0.7158
INFO:root:Epoch: 8, learning rate: 0.00017289686274217977, train loss: 0.3789
INFO:root:train average_precision, 0.9094
INFO:root:train roc_auc, 0.9045
INFO:root:validate loss: 0.4830
INFO:root:validate average_precision, 0.8406
INFO:root:validate roc_auc, 0.8346
INFO:root:new node validate loss: 0.5921
INFO:root:new node validate average_precision, 0.7744
INFO:root:new node validate roc_auc, 0.7364
INFO:root:Epoch: 9, learning rate: 9.372094804704758e-05, train loss: 0.3664
INFO:root:train average_precision, 0.9175
INFO:root:train roc_auc, 0.9123
INFO:root:validate loss: 0.4740
INFO:root:validate average_precision, 0.8480
INFO:root:validate roc_auc, 0.8417
INFO:root:new node validate loss: 0.5871
INFO:root:new node validate average_precision, 0.7877
INFO:root:new node validate roc_auc, 0.7520
INFO:root:Epoch: 10, learning rate: 1.9098300562509427e-05, train loss: 0.3616
INFO:root:train average_precision, 0.9191
INFO:root:train roc_auc, 0.9143
INFO:root:validate loss: 0.4735
INFO:root:validate average_precision, 0.8484
INFO:root:validate roc_auc, 0.8434
INFO:root:new node validate loss: 0.5844
INFO:root:new node validate average_precision, 0.7815
INFO:root:new node validate roc_auc, 0.7443
INFO:root:test loss: 0.4611
INFO:root:test average_precision, 0.8608
INFO:root:test roc_auc, 0.8571
INFO:root:new node test loss: 0.5246
INFO:root:new node test average_precision, 0.8097
INFO:root:new node test roc_auc, 0.7931
INFO:root:Epoch: 11, learning rate: 3.1416838871375353e-06, train loss: 0.3630
INFO:root:train average_precision, 0.9197
INFO:root:train roc_auc, 0.9150
INFO:root:validate loss: 0.4757
INFO:root:validate average_precision, 0.8435
INFO:root:validate roc_auc, 0.8403
INFO:root:new node validate loss: 0.5883
INFO:root:new node validate average_precision, 0.7854
INFO:root:new node validate roc_auc, 0.7477
INFO:root:Epoch: 12, learning rate: 5.742207084350565e-05, train loss: 0.3615
INFO:root:train average_precision, 0.9219
INFO:root:train roc_auc, 0.9176
INFO:root:validate loss: 0.4605
INFO:root:validate average_precision, 0.8551
INFO:root:validate roc_auc, 0.8521
INFO:root:new node validate loss: 0.5722
INFO:root:new node validate average_precision, 0.7964
INFO:root:new node validate roc_auc, 0.7601
INFO:root:save model ./saved_models/TGN/uci/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 13, learning rate: 0.00014257792915647467, train loss: 0.3519
INFO:root:train average_precision, 0.9246
INFO:root:train roc_auc, 0.9204
INFO:root:validate loss: 0.4536
INFO:root:validate average_precision, 0.8604
INFO:root:validate roc_auc, 0.8602
INFO:root:new node validate loss: 0.5809
INFO:root:new node validate average_precision, 0.7921
INFO:root:new node validate roc_auc, 0.7548
INFO:root:save model ./saved_models/TGN/uci/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 14, learning rate: 0.00019685831611290764, train loss: 0.3526
INFO:root:train average_precision, 0.9224
INFO:root:train roc_auc, 0.9191
INFO:root:validate loss: 0.5029
INFO:root:validate average_precision, 0.8302
INFO:root:validate roc_auc, 0.8197
INFO:root:new node validate loss: 0.5984
INFO:root:new node validate average_precision, 0.7823
INFO:root:new node validate roc_auc, 0.7366
INFO:root:Epoch: 15, learning rate: 0.0001809016994376168, train loss: 0.3511
INFO:root:train average_precision, 0.9231
INFO:root:train roc_auc, 0.9204
INFO:root:validate loss: 0.4559
INFO:root:validate average_precision, 0.8603
INFO:root:validate roc_auc, 0.8587
INFO:root:new node validate loss: 0.5733
INFO:root:new node validate average_precision, 0.7971
INFO:root:new node validate roc_auc, 0.7669
INFO:root:Epoch: 16, learning rate: 0.00010627905195295439, train loss: 0.3460
INFO:root:train average_precision, 0.9249
INFO:root:train roc_auc, 0.9223
INFO:root:validate loss: 0.4495
INFO:root:validate average_precision, 0.8635
INFO:root:validate roc_auc, 0.8639
INFO:root:new node validate loss: 0.5915
INFO:root:new node validate average_precision, 0.7980
INFO:root:new node validate roc_auc, 0.7690
INFO:root:save model ./saved_models/TGN/uci/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 17, learning rate: 2.7103137257852454e-05, train loss: 0.3417
INFO:root:train average_precision, 0.9273
INFO:root:train roc_auc, 0.9239
INFO:root:validate loss: 0.4474
INFO:root:validate average_precision, 0.8635
INFO:root:validate roc_auc, 0.8626
INFO:root:new node validate loss: 0.5774
INFO:root:new node validate average_precision, 0.7988
INFO:root:new node validate roc_auc, 0.7680
INFO:root:Epoch: 18, learning rate: 7.885298685520349e-07, train loss: 0.3417
INFO:root:train average_precision, 0.9275
INFO:root:train roc_auc, 0.9243
INFO:root:validate loss: 0.4622
INFO:root:validate average_precision, 0.8525
INFO:root:validate roc_auc, 0.8521
INFO:root:new node validate loss: 0.5850
INFO:root:new node validate average_precision, 0.8020
INFO:root:new node validate roc_auc, 0.7716
INFO:root:Epoch: 19, learning rate: 4.641732050211155e-05, train loss: 0.3437
INFO:root:train average_precision, 0.9271
INFO:root:train roc_auc, 0.9244
INFO:root:validate loss: 0.4478
INFO:root:validate average_precision, 0.8626
INFO:root:validate roc_auc, 0.8640
INFO:root:new node validate loss: 0.6004
INFO:root:new node validate average_precision, 0.8070
INFO:root:new node validate roc_auc, 0.7770
INFO:root:Epoch: 20, learning rate: 0.00013090169943758345, train loss: 0.3414
INFO:root:train average_precision, 0.9277
INFO:root:train roc_auc, 0.9249
INFO:root:validate loss: 0.4496
INFO:root:validate average_precision, 0.8742
INFO:root:validate roc_auc, 0.8752
INFO:root:new node validate loss: 0.6225
INFO:root:new node validate average_precision, 0.8092
INFO:root:new node validate roc_auc, 0.7753
INFO:root:test loss: 0.4346
INFO:root:test average_precision, 0.9004
INFO:root:test roc_auc, 0.9008
INFO:root:new node test loss: 0.5660
INFO:root:new node test average_precision, 0.8457
INFO:root:new node test roc_auc, 0.8350
INFO:root:save model ./saved_models/TGN/uci/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 21, learning rate: 0.0001929776485888686, train loss: 0.3379
INFO:root:train average_precision, 0.9295
INFO:root:train roc_auc, 0.9268
INFO:root:validate loss: 0.4533
INFO:root:validate average_precision, 0.8695
INFO:root:validate roc_auc, 0.8695
INFO:root:new node validate loss: 0.6013
INFO:root:new node validate average_precision, 0.8135
INFO:root:new node validate roc_auc, 0.7829
INFO:root:Epoch: 22, learning rate: 0.00018763066800434467, train loss: 0.3375
INFO:root:train average_precision, 0.9291
INFO:root:train roc_auc, 0.9268
INFO:root:validate loss: 0.4479
INFO:root:validate average_precision, 0.8741
INFO:root:validate roc_auc, 0.8751
INFO:root:new node validate loss: 0.6043
INFO:root:new node validate average_precision, 0.8183
INFO:root:new node validate roc_auc, 0.7890
INFO:root:Epoch: 23, learning rate: 0.00011873813145862399, train loss: 0.3330
INFO:root:train average_precision, 0.9306
INFO:root:train roc_auc, 0.9285
INFO:root:validate loss: 0.4350
INFO:root:validate average_precision, 0.8734
INFO:root:validate roc_auc, 0.8726
INFO:root:new node validate loss: 0.5765
INFO:root:new node validate average_precision, 0.8108
INFO:root:new node validate roc_auc, 0.7810
INFO:root:Epoch: 24, learning rate: 3.6257601025131094e-05, train loss: 0.3300
INFO:root:train average_precision, 0.9323
INFO:root:train roc_auc, 0.9299
INFO:root:validate loss: 0.4236
INFO:root:validate average_precision, 0.8799
INFO:root:validate roc_auc, 0.8790
INFO:root:new node validate loss: 0.5575
INFO:root:new node validate average_precision, 0.8198
INFO:root:new node validate roc_auc, 0.7922
INFO:root:save model ./saved_models/TGN/uci/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 25, learning rate: 0.0, train loss: 0.3311
INFO:root:train average_precision, 0.9317
INFO:root:train roc_auc, 0.9288
INFO:root:validate loss: 0.4302
INFO:root:validate average_precision, 0.8739
INFO:root:validate roc_auc, 0.8741
INFO:root:new node validate loss: 0.5786
INFO:root:new node validate average_precision, 0.8093
INFO:root:new node validate roc_auc, 0.7758
INFO:root:Epoch: 26, learning rate: 3.625760102511391e-05, train loss: 0.3384
INFO:root:train average_precision, 0.9304
INFO:root:train roc_auc, 0.9279
INFO:root:validate loss: 0.4275
INFO:root:validate average_precision, 0.8764
INFO:root:validate roc_auc, 0.8774
INFO:root:new node validate loss: 0.5904
INFO:root:new node validate average_precision, 0.8094
INFO:root:new node validate roc_auc, 0.7770
INFO:root:Epoch: 27, learning rate: 0.00011873813145868208, train loss: 0.3390
INFO:root:train average_precision, 0.9293
INFO:root:train roc_auc, 0.9266
INFO:root:validate loss: 0.4283
INFO:root:validate average_precision, 0.8799
INFO:root:validate roc_auc, 0.8811
INFO:root:new node validate loss: 0.5953
INFO:root:new node validate average_precision, 0.8186
INFO:root:new node validate roc_auc, 0.7886
INFO:root:Epoch: 28, learning rate: 0.00018763066800447107, train loss: 0.3335
INFO:root:train average_precision, 0.9305
INFO:root:train roc_auc, 0.9286
INFO:root:validate loss: 0.4403
INFO:root:validate average_precision, 0.8772
INFO:root:validate roc_auc, 0.8781
INFO:root:new node validate loss: 0.6209
INFO:root:new node validate average_precision, 0.8067
INFO:root:new node validate roc_auc, 0.7675
INFO:root:Epoch: 29, learning rate: 0.0001929776485888243, train loss: 0.3277
INFO:root:train average_precision, 0.9327
INFO:root:train roc_auc, 0.9306
INFO:root:validate loss: 0.4512
INFO:root:validate average_precision, 0.8762
INFO:root:validate roc_auc, 0.8786
INFO:root:new node validate loss: 0.6280
INFO:root:new node validate average_precision, 0.8194
INFO:root:new node validate roc_auc, 0.7906
INFO:root:Epoch: 30, learning rate: 0.00013090169943767154, train loss: 0.3301
INFO:root:train average_precision, 0.9319
INFO:root:train roc_auc, 0.9297
INFO:root:validate loss: 0.4252
INFO:root:validate average_precision, 0.8803
INFO:root:validate roc_auc, 0.8807
INFO:root:new node validate loss: 0.5804
INFO:root:new node validate average_precision, 0.8205
INFO:root:new node validate roc_auc, 0.7880
INFO:root:test loss: 0.3950
INFO:root:test average_precision, 0.9124
INFO:root:test roc_auc, 0.9113
INFO:root:new node test loss: 0.5185
INFO:root:new node test average_precision, 0.8575
INFO:root:new node test roc_auc, 0.8456
INFO:root:save model ./saved_models/TGN/uci/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 31, learning rate: 4.641732050214138e-05, train loss: 0.3274
INFO:root:train average_precision, 0.9335
INFO:root:train roc_auc, 0.9306
INFO:root:validate loss: 0.4237
INFO:root:validate average_precision, 0.8786
INFO:root:validate roc_auc, 0.8790
INFO:root:new node validate loss: 0.5739
INFO:root:new node validate average_precision, 0.8206
INFO:root:new node validate roc_auc, 0.7926
INFO:root:Epoch: 32, learning rate: 7.885298685523453e-07, train loss: 0.3253
INFO:root:train average_precision, 0.9335
INFO:root:train roc_auc, 0.9318
INFO:root:validate loss: 0.4254
INFO:root:validate average_precision, 0.8811
INFO:root:validate roc_auc, 0.8814
INFO:root:new node validate loss: 0.5951
INFO:root:new node validate average_precision, 0.8214
INFO:root:new node validate roc_auc, 0.7906
INFO:root:save model ./saved_models/TGN/uci/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 33, learning rate: 2.7103137257871025e-05, train loss: 0.3274
INFO:root:train average_precision, 0.9341
INFO:root:train roc_auc, 0.9317
INFO:root:validate loss: 0.4244
INFO:root:validate average_precision, 0.8792
INFO:root:validate roc_auc, 0.8796
INFO:root:new node validate loss: 0.5828
INFO:root:new node validate average_precision, 0.8235
INFO:root:new node validate roc_auc, 0.7913
INFO:root:Epoch: 34, learning rate: 0.00010627905195293237, train loss: 0.3332
INFO:root:train average_precision, 0.9322
INFO:root:train roc_auc, 0.9302
INFO:root:validate loss: 0.4387
INFO:root:validate average_precision, 0.8799
INFO:root:validate roc_auc, 0.8817
INFO:root:new node validate loss: 0.6433
INFO:root:new node validate average_precision, 0.8273
INFO:root:new node validate roc_auc, 0.7996
INFO:root:Epoch: 35, learning rate: 0.00018090169943741467, train loss: 0.3219
INFO:root:train average_precision, 0.9355
INFO:root:train roc_auc, 0.9330
INFO:root:validate loss: 0.4293
INFO:root:validate average_precision, 0.8855
INFO:root:validate roc_auc, 0.8852
INFO:root:new node validate loss: 0.5968
INFO:root:new node validate average_precision, 0.8387
INFO:root:new node validate roc_auc, 0.8114
INFO:root:save model ./saved_models/TGN/uci/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 36, learning rate: 0.00019685831611304034, train loss: 0.3201
INFO:root:train average_precision, 0.9362
INFO:root:train roc_auc, 0.9336
INFO:root:validate loss: 0.4360
INFO:root:validate average_precision, 0.8797
INFO:root:validate roc_auc, 0.8806
INFO:root:new node validate loss: 0.6042
INFO:root:new node validate average_precision, 0.8371
INFO:root:new node validate roc_auc, 0.8103
INFO:root:Epoch: 37, learning rate: 0.00014257792915657063, train loss: 0.3251
INFO:root:train average_precision, 0.9346
INFO:root:train roc_auc, 0.9318
INFO:root:validate loss: 0.4283
INFO:root:validate average_precision, 0.8878
INFO:root:validate roc_auc, 0.8872
INFO:root:new node validate loss: 0.5939
INFO:root:new node validate average_precision, 0.8445
INFO:root:new node validate roc_auc, 0.8169
INFO:root:save model ./saved_models/TGN/uci/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 38, learning rate: 5.742207084349114e-05, train loss: 0.3198
INFO:root:train average_precision, 0.9377
INFO:root:train roc_auc, 0.9347
INFO:root:validate loss: 0.4150
INFO:root:validate average_precision, 0.8863
INFO:root:validate roc_auc, 0.8852
INFO:root:new node validate loss: 0.5499
INFO:root:new node validate average_precision, 0.8377
INFO:root:new node validate roc_auc, 0.8122
INFO:root:Epoch: 39, learning rate: 3.1416838871355007e-06, train loss: 0.3190
INFO:root:train average_precision, 0.9364
INFO:root:train roc_auc, 0.9343
INFO:root:validate loss: 0.4202
INFO:root:validate average_precision, 0.8911
INFO:root:validate roc_auc, 0.8893
INFO:root:new node validate loss: 0.5912
INFO:root:new node validate average_precision, 0.8470
INFO:root:new node validate roc_auc, 0.8195
INFO:root:save model ./saved_models/TGN/uci/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 40, learning rate: 1.909830056249714e-05, train loss: 0.3255
INFO:root:train average_precision, 0.9361
INFO:root:train roc_auc, 0.9330
INFO:root:validate loss: 0.4159
INFO:root:validate average_precision, 0.8848
INFO:root:validate roc_auc, 0.8849
INFO:root:new node validate loss: 0.5600
INFO:root:new node validate average_precision, 0.8449
INFO:root:new node validate roc_auc, 0.8171
INFO:root:test loss: 0.3775
INFO:root:test average_precision, 0.9142
INFO:root:test roc_auc, 0.9132
INFO:root:new node test loss: 0.4791
INFO:root:new node test average_precision, 0.8737
INFO:root:new node test roc_auc, 0.8628
INFO:root:Epoch: 41, learning rate: 9.37209480470043e-05, train loss: 0.3204
INFO:root:train average_precision, 0.9381
INFO:root:train roc_auc, 0.9355
INFO:root:validate loss: 0.4368
INFO:root:validate average_precision, 0.8808
INFO:root:validate roc_auc, 0.8837
INFO:root:new node validate loss: 0.6189
INFO:root:new node validate average_precision, 0.8381
INFO:root:new node validate roc_auc, 0.8138
INFO:root:Epoch: 42, learning rate: 0.00017289686274194672, train loss: 0.3262
INFO:root:train average_precision, 0.9333
INFO:root:train roc_auc, 0.9307
INFO:root:validate loss: 0.4257
INFO:root:validate average_precision, 0.8840
INFO:root:validate roc_auc, 0.8838
INFO:root:new node validate loss: 0.5821
INFO:root:new node validate average_precision, 0.8426
INFO:root:new node validate roc_auc, 0.8163
INFO:root:Epoch: 43, learning rate: 0.00019921147013185085, train loss: 0.3218
INFO:root:train average_precision, 0.9354
INFO:root:train roc_auc, 0.9331
INFO:root:validate loss: 0.4632
INFO:root:validate average_precision, 0.8889
INFO:root:validate roc_auc, 0.8903
INFO:root:new node validate loss: 0.6746
INFO:root:new node validate average_precision, 0.8496
INFO:root:new node validate roc_auc, 0.8230
INFO:root:Epoch: 44, learning rate: 0.0001535826794981424, train loss: 0.3209
INFO:root:train average_precision, 0.9378
INFO:root:train roc_auc, 0.9341
INFO:root:validate loss: 0.4298
INFO:root:validate average_precision, 0.8849
INFO:root:validate roc_auc, 0.8843
INFO:root:new node validate loss: 0.5922
INFO:root:new node validate average_precision, 0.8473
INFO:root:new node validate roc_auc, 0.8207
INFO:root:Epoch: 45, learning rate: 6.909830056258304e-05, train loss: 0.3171
INFO:root:train average_precision, 0.9382
INFO:root:train roc_auc, 0.9352
INFO:root:validate loss: 0.4224
INFO:root:validate average_precision, 0.8906
INFO:root:validate roc_auc, 0.8881
INFO:root:new node validate loss: 0.5872
INFO:root:new node validate average_precision, 0.8487
INFO:root:new node validate roc_auc, 0.8214
INFO:root:Epoch: 46, learning rate: 7.022351411178251e-06, train loss: 0.3142
INFO:root:train average_precision, 0.9394
INFO:root:train roc_auc, 0.9359
INFO:root:validate loss: 0.4238
INFO:root:validate average_precision, 0.8940
INFO:root:validate roc_auc, 0.8915
INFO:root:new node validate loss: 0.5836
INFO:root:new node validate average_precision, 0.8475
INFO:root:new node validate roc_auc, 0.8211
INFO:root:save model ./saved_models/TGN/uci/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 47, learning rate: 1.2369331995621503e-05, train loss: 0.3173
INFO:root:train average_precision, 0.9375
INFO:root:train roc_auc, 0.9353
INFO:root:validate loss: 0.4111
INFO:root:validate average_precision, 0.8943
INFO:root:validate roc_auc, 0.8924
INFO:root:new node validate loss: 0.5757
INFO:root:new node validate average_precision, 0.8485
INFO:root:new node validate roc_auc, 0.8219
INFO:root:save model ./saved_models/TGN/uci/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 48, learning rate: 8.126186854144578e-05, train loss: 0.3194
INFO:root:train average_precision, 0.9386
INFO:root:train roc_auc, 0.9355
INFO:root:validate loss: 0.4278
INFO:root:validate average_precision, 0.8896
INFO:root:validate roc_auc, 0.8900
INFO:root:new node validate loss: 0.6066
INFO:root:new node validate average_precision, 0.8473
INFO:root:new node validate roc_auc, 0.8224
INFO:root:Epoch: 49, learning rate: 0.00016374239897483278, train loss: 0.3177
INFO:root:train average_precision, 0.9380
INFO:root:train roc_auc, 0.9351
INFO:root:validate loss: 0.4293
INFO:root:validate average_precision, 0.8878
INFO:root:validate roc_auc, 0.8871
INFO:root:new node validate loss: 0.5980
INFO:root:new node validate average_precision, 0.8449
INFO:root:new node validate roc_auc, 0.8205
INFO:root:Epoch: 50, learning rate: 0.00020000000000022514, train loss: 0.3138
INFO:root:train average_precision, 0.9393
INFO:root:train roc_auc, 0.9366
INFO:root:validate loss: 0.4502
INFO:root:validate average_precision, 0.8844
INFO:root:validate roc_auc, 0.8830
INFO:root:new node validate loss: 0.6562
INFO:root:new node validate average_precision, 0.8419
INFO:root:new node validate roc_auc, 0.8151
INFO:root:test loss: 0.3991
INFO:root:test average_precision, 0.9204
INFO:root:test roc_auc, 0.9182
INFO:root:new node test loss: 0.5631
INFO:root:new node test average_precision, 0.8678
INFO:root:new node test roc_auc, 0.8554
INFO:root:Epoch: 51, learning rate: 0.00016374239897527237, train loss: 0.3168
INFO:root:train average_precision, 0.9380
INFO:root:train roc_auc, 0.9354
INFO:root:validate loss: 0.4670
INFO:root:validate average_precision, 0.8882
INFO:root:validate roc_auc, 0.8880
INFO:root:new node validate loss: 0.6526
INFO:root:new node validate average_precision, 0.8461
INFO:root:new node validate roc_auc, 0.8205
INFO:root:Epoch: 52, learning rate: 8.126186854144786e-05, train loss: 0.3165
INFO:root:train average_precision, 0.9382
INFO:root:train roc_auc, 0.9355
INFO:root:validate loss: 0.4441
INFO:root:validate average_precision, 0.8922
INFO:root:validate roc_auc, 0.8912
INFO:root:new node validate loss: 0.6330
INFO:root:new node validate average_precision, 0.8462
INFO:root:new node validate roc_auc, 0.8212
INFO:root:Epoch: 53, learning rate: 1.236933199563365e-05, train loss: 0.3118
INFO:root:train average_precision, 0.9405
INFO:root:train roc_auc, 0.9380
INFO:root:validate loss: 0.4292
INFO:root:validate average_precision, 0.8924
INFO:root:validate roc_auc, 0.8915
INFO:root:new node validate loss: 0.6002
INFO:root:new node validate average_precision, 0.8496
INFO:root:new node validate roc_auc, 0.8248
INFO:root:Epoch: 54, learning rate: 7.022351411187958e-06, train loss: 0.3133
INFO:root:train average_precision, 0.9399
INFO:root:train roc_auc, 0.9372
INFO:root:validate loss: 0.4172
INFO:root:validate average_precision, 0.8908
INFO:root:validate roc_auc, 0.8912
INFO:root:new node validate loss: 0.6022
INFO:root:new node validate average_precision, 0.8450
INFO:root:new node validate roc_auc, 0.8198
INFO:root:Epoch: 55, learning rate: 6.909830056245937e-05, train loss: 0.3175
INFO:root:train average_precision, 0.9403
INFO:root:train roc_auc, 0.9373
INFO:root:validate loss: 0.4174
INFO:root:validate average_precision, 0.8919
INFO:root:validate roc_auc, 0.8912
INFO:root:new node validate loss: 0.5890
INFO:root:new node validate average_precision, 0.8480
INFO:root:new node validate roc_auc, 0.8235
INFO:root:Epoch: 56, learning rate: 0.00015358267949800475, train loss: 0.3136
INFO:root:train average_precision, 0.9398
INFO:root:train roc_auc, 0.9372
INFO:root:validate loss: 0.4174
INFO:root:validate average_precision, 0.8922
INFO:root:validate roc_auc, 0.8902
INFO:root:new node validate loss: 0.6046
INFO:root:new node validate average_precision, 0.8489
INFO:root:new node validate roc_auc, 0.8251
INFO:root:Epoch: 57, learning rate: 0.00019921147013189584, train loss: 0.3104
INFO:root:train average_precision, 0.9397
INFO:root:train roc_auc, 0.9373
INFO:root:validate loss: 0.4351
INFO:root:validate average_precision, 0.8897
INFO:root:validate roc_auc, 0.8877
INFO:root:new node validate loss: 0.5970
INFO:root:new node validate average_precision, 0.8533
INFO:root:new node validate roc_auc, 0.8280
INFO:root:Epoch: 58, learning rate: 0.0001728968627421386, train loss: 0.3073
INFO:root:train average_precision, 0.9421
INFO:root:train roc_auc, 0.9390
INFO:root:validate loss: 0.4832
INFO:root:validate average_precision, 0.8925
INFO:root:validate roc_auc, 0.8895
INFO:root:new node validate loss: 0.6796
INFO:root:new node validate average_precision, 0.8559
INFO:root:new node validate roc_auc, 0.8305
INFO:root:Epoch: 59, learning rate: 9.372094804719067e-05, train loss: 0.3085
INFO:root:train average_precision, 0.9428
INFO:root:train roc_auc, 0.9392
INFO:root:validate loss: 0.4456
INFO:root:validate average_precision, 0.8937
INFO:root:validate roc_auc, 0.8919
INFO:root:new node validate loss: 0.6351
INFO:root:new node validate average_precision, 0.8491
INFO:root:new node validate roc_auc, 0.8243
INFO:root:Epoch: 60, learning rate: 1.9098300562488166e-05, train loss: 0.3067
INFO:root:train average_precision, 0.9426
INFO:root:train roc_auc, 0.9394
INFO:root:validate loss: 0.4169
INFO:root:validate average_precision, 0.8925
INFO:root:validate roc_auc, 0.8918
INFO:root:new node validate loss: 0.5915
INFO:root:new node validate average_precision, 0.8431
INFO:root:new node validate roc_auc, 0.8174
INFO:root:test loss: 0.4115
INFO:root:test average_precision, 0.9183
INFO:root:test roc_auc, 0.9157
INFO:root:new node test loss: 0.5499
INFO:root:new node test average_precision, 0.8729
INFO:root:new node test roc_auc, 0.8602
INFO:root:Epoch: 61, learning rate: 3.1416838871342586e-06, train loss: 0.3073
INFO:root:train average_precision, 0.9425
INFO:root:train roc_auc, 0.9391
INFO:root:validate loss: 0.4142
INFO:root:validate average_precision, 0.8932
INFO:root:validate roc_auc, 0.8924
INFO:root:new node validate loss: 0.6160
INFO:root:new node validate average_precision, 0.8525
INFO:root:new node validate roc_auc, 0.8280
INFO:root:Epoch: 62, learning rate: 5.7422070843520144e-05, train loss: 0.3066
INFO:root:train average_precision, 0.9428
INFO:root:train roc_auc, 0.9399
INFO:root:validate loss: 0.4234
INFO:root:validate average_precision, 0.8925
INFO:root:validate roc_auc, 0.8910
INFO:root:new node validate loss: 0.6210
INFO:root:new node validate average_precision, 0.8403
INFO:root:new node validate roc_auc, 0.8131
INFO:root:Epoch: 63, learning rate: 0.00014257792915625287, train loss: 0.3063
INFO:root:train average_precision, 0.9434
INFO:root:train roc_auc, 0.9403
INFO:root:validate loss: 0.4420
INFO:root:validate average_precision, 0.8940
INFO:root:validate roc_auc, 0.8915
INFO:root:new node validate loss: 0.6069
INFO:root:new node validate average_precision, 0.8557
INFO:root:new node validate roc_auc, 0.8322
INFO:root:Epoch: 64, learning rate: 0.00019685831611277526, train loss: 0.3052
INFO:root:train average_precision, 0.9425
INFO:root:train roc_auc, 0.9400
INFO:root:validate loss: 0.4482
INFO:root:validate average_precision, 0.8963
INFO:root:validate roc_auc, 0.8936
INFO:root:new node validate loss: 0.6433
INFO:root:new node validate average_precision, 0.8542
INFO:root:new node validate roc_auc, 0.8304
INFO:root:save model ./saved_models/TGN/uci/TGN_seed1/TGN_seed1.pkl
INFO:root:Epoch: 65, learning rate: 0.00018090169943765484, train loss: 0.3074
INFO:root:train average_precision, 0.9424
INFO:root:train roc_auc, 0.9398
INFO:root:validate loss: 0.4414
INFO:root:validate average_precision, 0.8885
INFO:root:validate roc_auc, 0.8862
INFO:root:new node validate loss: 0.6020
INFO:root:new node validate average_precision, 0.8438
INFO:root:new node validate roc_auc, 0.8182
INFO:root:Epoch: 66, learning rate: 0.00010627905195278804, train loss: 0.3097
INFO:root:train average_precision, 0.9418
INFO:root:train roc_auc, 0.9388
INFO:root:validate loss: 0.4373
INFO:root:validate average_precision, 0.8938
INFO:root:validate roc_auc, 0.8924
INFO:root:new node validate loss: 0.6152
INFO:root:new node validate average_precision, 0.8450
INFO:root:new node validate roc_auc, 0.8165
INFO:root:Epoch: 67, learning rate: 2.7103137257955887e-05, train loss: 0.3063
INFO:root:train average_precision, 0.9436
INFO:root:train roc_auc, 0.9402
INFO:root:validate loss: 0.4057
INFO:root:validate average_precision, 0.8929
INFO:root:validate roc_auc, 0.8924
INFO:root:new node validate loss: 0.5620
INFO:root:new node validate average_precision, 0.8405
INFO:root:new node validate roc_auc, 0.8141
INFO:root:Epoch: 68, learning rate: 7.885298685552731e-07, train loss: 0.3026
INFO:root:train average_precision, 0.9443
INFO:root:train roc_auc, 0.9413
INFO:root:validate loss: 0.4259
INFO:root:validate average_precision, 0.8922
INFO:root:validate roc_auc, 0.8930
INFO:root:new node validate loss: 0.6437
INFO:root:new node validate average_precision, 0.8547
INFO:root:new node validate roc_auc, 0.8305
INFO:root:Epoch: 69, learning rate: 4.64173205021652e-05, train loss: 0.3076
INFO:root:train average_precision, 0.9428
INFO:root:train roc_auc, 0.9392
INFO:root:validate loss: 0.4270
INFO:root:validate average_precision, 0.8896
INFO:root:validate roc_auc, 0.8899
INFO:root:new node validate loss: 0.6201
INFO:root:new node validate average_precision, 0.8476
INFO:root:new node validate roc_auc, 0.8224
INFO:root:Epoch: 70, learning rate: 0.00013090169943785155, train loss: 0.3082
INFO:root:train average_precision, 0.9418
INFO:root:train roc_auc, 0.9392
INFO:root:validate loss: 0.4253
INFO:root:validate average_precision, 0.8919
INFO:root:validate roc_auc, 0.8902
INFO:root:new node validate loss: 0.6139
INFO:root:new node validate average_precision, 0.8470
INFO:root:new node validate roc_auc, 0.8232
INFO:root:test loss: 0.3837
INFO:root:test average_precision, 0.9296
INFO:root:test roc_auc, 0.9272
INFO:root:new node test loss: 0.5403
INFO:root:new node test average_precision, 0.8812
INFO:root:new node test roc_auc, 0.8694
INFO:root:Epoch: 71, learning rate: 0.0001929776485889137, train loss: 0.3041
INFO:root:train average_precision, 0.9429
INFO:root:train roc_auc, 0.9403
INFO:root:validate loss: 0.4380
INFO:root:validate average_precision, 0.8914
INFO:root:validate roc_auc, 0.8899
INFO:root:new node validate loss: 0.5892
INFO:root:new node validate average_precision, 0.8346
INFO:root:new node validate roc_auc, 0.8094
INFO:root:Epoch: 72, learning rate: 0.0001876306680047241, train loss: 0.3034
INFO:root:train average_precision, 0.9440
INFO:root:train roc_auc, 0.9413
INFO:root:validate loss: 0.4355
INFO:root:validate average_precision, 0.8898
INFO:root:validate roc_auc, 0.8889
INFO:root:new node validate loss: 0.5876
INFO:root:new node validate average_precision, 0.8455
INFO:root:new node validate roc_auc, 0.8214
INFO:root:Epoch: 73, learning rate: 0.00011873813145851827, train loss: 0.3057
INFO:root:train average_precision, 0.9425
INFO:root:train roc_auc, 0.9393
INFO:root:validate loss: 0.4665
INFO:root:validate average_precision, 0.8846
INFO:root:validate roc_auc, 0.8848
INFO:root:new node validate loss: 0.6743
INFO:root:new node validate average_precision, 0.8530
INFO:root:new node validate roc_auc, 0.8282
INFO:root:Epoch: 74, learning rate: 3.625760102517048e-05, train loss: 0.3047
INFO:root:train average_precision, 0.9435
INFO:root:train roc_auc, 0.9399
INFO:root:validate loss: 0.4058
INFO:root:validate average_precision, 0.8947
INFO:root:validate roc_auc, 0.8920
INFO:root:new node validate loss: 0.5551
INFO:root:new node validate average_precision, 0.8397
INFO:root:new node validate roc_auc, 0.8129
INFO:root:Epoch: 75, learning rate: 0.0, train loss: 0.3013
INFO:root:train average_precision, 0.9449
INFO:root:train roc_auc, 0.9418
INFO:root:validate loss: 0.4277
INFO:root:validate average_precision, 0.8944
INFO:root:validate roc_auc, 0.8941
INFO:root:new node validate loss: 0.6305
INFO:root:new node validate average_precision, 0.8566
INFO:root:new node validate roc_auc, 0.8319
INFO:root:Epoch: 76, learning rate: 3.625760102509302e-05, train loss: 0.2965
INFO:root:train average_precision, 0.9463
INFO:root:train roc_auc, 0.9429
INFO:root:validate loss: 0.4189
INFO:root:validate average_precision, 0.8939
INFO:root:validate roc_auc, 0.8930
INFO:root:new node validate loss: 0.5899
INFO:root:new node validate average_precision, 0.8544
INFO:root:new node validate roc_auc, 0.8316
INFO:root:Epoch: 77, learning rate: 0.00011873813145859789, train loss: 0.3003
INFO:root:train average_precision, 0.9448
INFO:root:train roc_auc, 0.9424
INFO:root:validate loss: 0.4249
INFO:root:validate average_precision, 0.8927
INFO:root:validate roc_auc, 0.8901
INFO:root:new node validate loss: 0.5884
INFO:root:new node validate average_precision, 0.8342
INFO:root:new node validate roc_auc, 0.8085
INFO:root:Epoch: 78, learning rate: 0.00018763066800468162, train loss: 0.2997
INFO:root:train average_precision, 0.9448
INFO:root:train roc_auc, 0.9418
INFO:root:validate loss: 0.4614
INFO:root:validate average_precision, 0.8942
INFO:root:validate roc_auc, 0.8911
INFO:root:new node validate loss: 0.6274
INFO:root:new node validate average_precision, 0.8528
INFO:root:new node validate roc_auc, 0.8280
INFO:root:Epoch: 79, learning rate: 0.00019297764858869463, train loss: 0.2984
INFO:root:train average_precision, 0.9456
INFO:root:train roc_auc, 0.9425
INFO:root:validate loss: 0.4786
INFO:root:validate average_precision, 0.8935
INFO:root:validate roc_auc, 0.8900
INFO:root:new node validate loss: 0.6527
INFO:root:new node validate average_precision, 0.8536
INFO:root:new node validate roc_auc, 0.8294
INFO:root:Epoch: 80, learning rate: 0.00013090169943758156, train loss: 0.2991
INFO:root:train average_precision, 0.9464
INFO:root:train roc_auc, 0.9428
INFO:root:validate loss: 0.4430
INFO:root:validate average_precision, 0.8894
INFO:root:validate roc_auc, 0.8881
INFO:root:new node validate loss: 0.6180
INFO:root:new node validate average_precision, 0.8498
INFO:root:new node validate roc_auc, 0.8247
INFO:root:test loss: 0.4354
INFO:root:test average_precision, 0.9199
INFO:root:test roc_auc, 0.9168
INFO:root:new node test loss: 0.5858
INFO:root:new node test average_precision, 0.8748
INFO:root:new node test roc_auc, 0.8616
INFO:root:Epoch: 81, learning rate: 4.641732050202497e-05, train loss: 0.2980
INFO:root:train average_precision, 0.9465
INFO:root:train roc_auc, 0.9432
INFO:root:validate loss: 0.4180
INFO:root:validate average_precision, 0.8967
INFO:root:validate roc_auc, 0.8933
INFO:root:new node validate loss: 0.5613
INFO:root:new node validate average_precision, 0.8492
INFO:root:new node validate roc_auc, 0.8249
INFO:root:Epoch: 82, learning rate: 7.885298685551401e-07, train loss: 0.2930
INFO:root:train average_precision, 0.9481
INFO:root:train roc_auc, 0.9445
INFO:root:validate loss: 0.4919
INFO:root:validate average_precision, 0.8885
INFO:root:validate roc_auc, 0.8891
INFO:root:new node validate loss: 0.6757
INFO:root:new node validate average_precision, 0.8563
INFO:root:new node validate roc_auc, 0.8321
INFO:root:Epoch: 83, learning rate: 2.7103137257949535e-05, train loss: 0.2958
INFO:root:train average_precision, 0.9466
INFO:root:train roc_auc, 0.9436
INFO:root:validate loss: 0.4207
INFO:root:validate average_precision, 0.8960
INFO:root:validate roc_auc, 0.8947
INFO:root:new node validate loss: 0.5840
INFO:root:new node validate average_precision, 0.8539
INFO:root:new node validate roc_auc, 0.8299
INFO:root:Epoch: 84, learning rate: 0.00010627905195305074, train loss: 0.3010
INFO:root:train average_precision, 0.9456
INFO:root:train roc_auc, 0.9428
INFO:root:validate loss: 0.4409
INFO:root:validate average_precision, 0.8887
INFO:root:validate roc_auc, 0.8871
INFO:root:new node validate loss: 0.6342
INFO:root:new node validate average_precision, 0.8441
INFO:root:new node validate roc_auc, 0.8201
INFO:root:load model ./saved_models/TGN/uci/TGN_seed1/TGN_seed1.pkl
INFO:root:get final performance on dataset uci...
INFO:root:test loss: 0.4457
INFO:root:test average_precision, 0.9235
INFO:root:test roc_auc, 0.9219
INFO:root:new node test loss: 0.6193
INFO:root:new node test average_precision, 0.8762
INFO:root:new node test roc_auc, 0.8638
INFO:root:Run 2 cost 9659.67 seconds.
INFO:root:********** Run 3 starts. **********
INFO:root:configuration is Namespace(dataset_name='uci', batch_size=200, model_name='TGN', gpu=0, num_neighbors=10, sample_neighbor_strategy='recent', time_scaling_factor=1e-06, num_walk_heads=8, num_heads=2, num_layers=2, walk_length=1, time_gap=2000, time_feat_dim=100, position_feat_dim=172, edge_bank_memory_mode='unlimited_memory', time_window_mode='fixed_proportion', patch_size=200, channel_embedding_dim=50, max_input_sequence_length=64, learning_rate=0.0001, dropout=0.1, num_epochs=100, optimizer='Adam', weight_decay=0.0, patience=20, val_ratio=0.15, test_ratio=0.15, num_runs=5, test_interval_epochs=10, negative_sample_strategy='random', load_best_configs=False, device='cuda:0', seed=2, save_model_name='TGN_seed2')
INFO:root:model -> Sequential(
  (0): MemoryModel(
    (src_memory_encoder): Linear(in_features=172, out_features=172, bias=True)
    (dst_memory_encoder): Linear(in_features=172, out_features=172, bias=True)
    (edge_encoder): Linear(in_features=172, out_features=172, bias=True)
    (channel_attention): ChannelAttentionTemporal(
      (avg_pool): AdaptiveAvgPool1d(output_size=1)
      (max_pool): AdaptiveMaxPool1d(output_size=1)
      (fc1): Linear(in_features=4, out_features=0, bias=False)
      (relu1): ReLU()
      (fc2): Linear(in_features=0, out_features=4, bias=False)
      (sigmoid): Sigmoid()
    )
    (time_encoder): TimeEncoder(
      (w): Linear(in_features=1, out_features=100, bias=True)
    )
    (message_aggregator): MessageAggregator()
    (memory_bank): MemoryBank(num_nodes=1900, memory_dim=172)
    (memory_updater): CFCMemoryUpdater(
      (memory_bank): MemoryBank(num_nodes=1900, memory_dim=172)
      (memory_updater): MoE(
        (mixer): Linear(in_features=788, out_features=616, bias=True)
        (relu): ReLU(inplace=True)
        (experts): ModuleList(
          (0-2): 3 x rnnmodule(
            (cell): GRUCell(616, 172)
            (relu): ReLU()
          )
          (3-5): 3 x cfcmodule(
            (cell): cfcbundle(
              (rnn_cell): CfCCell(
                (backbone): Sequential(
                  (0): Linear(in_features=788, out_features=128, bias=True)
                  (1): LeCun(
                    (tanh): Tanh()
                  )
                )
                (tanh): Tanh()
                (sigmoid): Sigmoid()
                (ff1): Linear(in_features=128, out_features=172, bias=True)
                (ff2): Linear(in_features=128, out_features=172, bias=True)
                (time_a): Linear(in_features=128, out_features=172, bias=True)
                (time_b): Linear(in_features=128, out_features=172, bias=True)
              )
              (leaky_factor): Linear(in_features=616, out_features=172, bias=True)
            )
            (relu): ReLU()
          )
        )
        (softplus): Softplus(beta=1.0, threshold=20.0)
        (softmax): Softmax(dim=1)
      )
    )
    (embedding_module): GraphAttentionEmbedding(
      (time_encoder): TimeEncoder(
        (w): Linear(in_features=1, out_features=100, bias=True)
      )
      (temporal_conv_layers): ModuleList(
        (0-1): 2 x MultiHeadAttention(
          (query_projection): Linear(in_features=272, out_features=272, bias=False)
          (key_projection): Linear(in_features=444, out_features=272, bias=False)
          (value_projection): Linear(in_features=444, out_features=272, bias=False)
          (layer_norm): LayerNorm((272,), eps=1e-05, elementwise_affine=True)
          (residual_fc): Linear(in_features=272, out_features=272, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (merge_layers): ModuleList(
        (0-1): 2 x MergeLayer(
          (fc1): Linear(in_features=444, out_features=172, bias=True)
          (fc2): Linear(in_features=172, out_features=172, bias=True)
          (act): ReLU()
        )
      )
    )
  )
  (1): MergeLayer(
    (fc1): Linear(in_features=344, out_features=172, bias=True)
    (fc2): Linear(in_features=172, out_features=1, bias=True)
    (act): ReLU()
  )
)
INFO:root:model name: TGN, #parameters: 14984612 B, 14633.41015625 KB, 14.29043960571289 MB.
INFO:root:Epoch: 1, learning rate: 0.00016374239897486902, train loss: 0.4372
INFO:root:train average_precision, 0.8947
INFO:root:train roc_auc, 0.8879
INFO:root:validate loss: 0.5071
INFO:root:validate average_precision, 0.8315
INFO:root:validate roc_auc, 0.8143
INFO:root:new node validate loss: 0.5776
INFO:root:new node validate average_precision, 0.7813
INFO:root:new node validate roc_auc, 0.7367
INFO:root:save model ./saved_models/TGN/uci/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 2, learning rate: 8.126186854142736e-05, train loss: 0.3876
INFO:root:train average_precision, 0.9081
INFO:root:train roc_auc, 0.9026
INFO:root:validate loss: 0.4959
INFO:root:validate average_precision, 0.8310
INFO:root:validate roc_auc, 0.8221
INFO:root:new node validate loss: 0.5917
INFO:root:new node validate average_precision, 0.7727
INFO:root:new node validate roc_auc, 0.7322
INFO:root:Epoch: 3, learning rate: 1.2369331995613646e-05, train loss: 0.3851
INFO:root:train average_precision, 0.9087
INFO:root:train roc_auc, 0.9035
INFO:root:validate loss: 0.5043
INFO:root:validate average_precision, 0.8257
INFO:root:validate roc_auc, 0.8177
INFO:root:new node validate loss: 0.5974
INFO:root:new node validate average_precision, 0.7676
INFO:root:new node validate roc_auc, 0.7298
INFO:root:Epoch: 4, learning rate: 7.022351411174938e-06, train loss: 0.3826
INFO:root:train average_precision, 0.9114
INFO:root:train roc_auc, 0.9062
INFO:root:validate loss: 0.5097
INFO:root:validate average_precision, 0.8220
INFO:root:validate roc_auc, 0.8125
INFO:root:new node validate loss: 0.5867
INFO:root:new node validate average_precision, 0.7764
INFO:root:new node validate roc_auc, 0.7405
INFO:root:Epoch: 5, learning rate: 6.909830056248985e-05, train loss: 0.3785
INFO:root:train average_precision, 0.9144
INFO:root:train roc_auc, 0.9084
INFO:root:validate loss: 0.4882
INFO:root:validate average_precision, 0.8394
INFO:root:validate roc_auc, 0.8310
INFO:root:new node validate loss: 0.5885
INFO:root:new node validate average_precision, 0.7727
INFO:root:new node validate roc_auc, 0.7321
INFO:root:save model ./saved_models/TGN/uci/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 6, learning rate: 0.00015358267949790012, train loss: 0.3685
INFO:root:train average_precision, 0.9190
INFO:root:train roc_auc, 0.9137
INFO:root:validate loss: 0.4785
INFO:root:validate average_precision, 0.8489
INFO:root:validate roc_auc, 0.8411
INFO:root:new node validate loss: 0.6040
INFO:root:new node validate average_precision, 0.7742
INFO:root:new node validate roc_auc, 0.7285
INFO:root:save model ./saved_models/TGN/uci/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 7, learning rate: 0.00019921147013149252, train loss: 0.3701
INFO:root:train average_precision, 0.9169
INFO:root:train roc_auc, 0.9111
INFO:root:validate loss: 0.4913
INFO:root:validate average_precision, 0.8340
INFO:root:validate roc_auc, 0.8260
INFO:root:new node validate loss: 0.5882
INFO:root:new node validate average_precision, 0.7719
INFO:root:new node validate roc_auc, 0.7309
INFO:root:Epoch: 8, learning rate: 0.00017289686274217977, train loss: 0.3646
INFO:root:train average_precision, 0.9193
INFO:root:train roc_auc, 0.9140
INFO:root:validate loss: 0.4730
INFO:root:validate average_precision, 0.8506
INFO:root:validate roc_auc, 0.8437
INFO:root:new node validate loss: 0.5707
INFO:root:new node validate average_precision, 0.7897
INFO:root:new node validate roc_auc, 0.7528
INFO:root:save model ./saved_models/TGN/uci/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 9, learning rate: 9.372094804704758e-05, train loss: 0.3667
INFO:root:train average_precision, 0.9173
INFO:root:train roc_auc, 0.9123
INFO:root:validate loss: 0.4725
INFO:root:validate average_precision, 0.8512
INFO:root:validate roc_auc, 0.8436
INFO:root:new node validate loss: 0.5920
INFO:root:new node validate average_precision, 0.7878
INFO:root:new node validate roc_auc, 0.7491
INFO:root:Epoch: 10, learning rate: 1.9098300562509427e-05, train loss: 0.3612
INFO:root:train average_precision, 0.9198
INFO:root:train roc_auc, 0.9146
INFO:root:validate loss: 0.4861
INFO:root:validate average_precision, 0.8419
INFO:root:validate roc_auc, 0.8351
INFO:root:new node validate loss: 0.6024
INFO:root:new node validate average_precision, 0.7789
INFO:root:new node validate roc_auc, 0.7416
INFO:root:test loss: 0.4701
INFO:root:test average_precision, 0.8550
INFO:root:test roc_auc, 0.8495
INFO:root:new node test loss: 0.5365
INFO:root:new node test average_precision, 0.8045
INFO:root:new node test roc_auc, 0.7858
INFO:root:Epoch: 11, learning rate: 3.1416838871375353e-06, train loss: 0.3640
INFO:root:train average_precision, 0.9215
INFO:root:train roc_auc, 0.9156
INFO:root:validate loss: 0.4766
INFO:root:validate average_precision, 0.8462
INFO:root:validate roc_auc, 0.8414
INFO:root:new node validate loss: 0.5924
INFO:root:new node validate average_precision, 0.7838
INFO:root:new node validate roc_auc, 0.7473
INFO:root:Epoch: 12, learning rate: 5.742207084350565e-05, train loss: 0.3634
INFO:root:train average_precision, 0.9224
INFO:root:train roc_auc, 0.9177
INFO:root:validate loss: 0.4553
INFO:root:validate average_precision, 0.8600
INFO:root:validate roc_auc, 0.8568
INFO:root:new node validate loss: 0.5872
INFO:root:new node validate average_precision, 0.7857
INFO:root:new node validate roc_auc, 0.7468
INFO:root:save model ./saved_models/TGN/uci/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 13, learning rate: 0.00014257792915647467, train loss: 0.3528
INFO:root:train average_precision, 0.9249
INFO:root:train roc_auc, 0.9204
INFO:root:validate loss: 0.4562
INFO:root:validate average_precision, 0.8645
INFO:root:validate roc_auc, 0.8645
INFO:root:new node validate loss: 0.5907
INFO:root:new node validate average_precision, 0.7968
INFO:root:new node validate roc_auc, 0.7615
INFO:root:save model ./saved_models/TGN/uci/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 14, learning rate: 0.00019685831611290764, train loss: 0.3494
INFO:root:train average_precision, 0.9251
INFO:root:train roc_auc, 0.9209
INFO:root:validate loss: 0.4433
INFO:root:validate average_precision, 0.8747
INFO:root:validate roc_auc, 0.8752
INFO:root:new node validate loss: 0.5736
INFO:root:new node validate average_precision, 0.8079
INFO:root:new node validate roc_auc, 0.7764
INFO:root:save model ./saved_models/TGN/uci/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 15, learning rate: 0.0001809016994376168, train loss: 0.3434
INFO:root:train average_precision, 0.9278
INFO:root:train roc_auc, 0.9236
INFO:root:validate loss: 0.4381
INFO:root:validate average_precision, 0.8689
INFO:root:validate roc_auc, 0.8686
INFO:root:new node validate loss: 0.5645
INFO:root:new node validate average_precision, 0.8029
INFO:root:new node validate roc_auc, 0.7713
INFO:root:Epoch: 16, learning rate: 0.00010627905195295439, train loss: 0.3490
INFO:root:train average_precision, 0.9248
INFO:root:train roc_auc, 0.9215
INFO:root:validate loss: 0.4412
INFO:root:validate average_precision, 0.8674
INFO:root:validate roc_auc, 0.8665
INFO:root:new node validate loss: 0.5825
INFO:root:new node validate average_precision, 0.7906
INFO:root:new node validate roc_auc, 0.7545
INFO:root:Epoch: 17, learning rate: 2.7103137257852454e-05, train loss: 0.3426
INFO:root:train average_precision, 0.9285
INFO:root:train roc_auc, 0.9246
INFO:root:validate loss: 0.4476
INFO:root:validate average_precision, 0.8641
INFO:root:validate roc_auc, 0.8623
INFO:root:new node validate loss: 0.5924
INFO:root:new node validate average_precision, 0.7851
INFO:root:new node validate roc_auc, 0.7472
INFO:root:Epoch: 18, learning rate: 7.885298685520349e-07, train loss: 0.3450
INFO:root:train average_precision, 0.9266
INFO:root:train roc_auc, 0.9236
INFO:root:validate loss: 0.4460
INFO:root:validate average_precision, 0.8649
INFO:root:validate roc_auc, 0.8637
INFO:root:new node validate loss: 0.5790
INFO:root:new node validate average_precision, 0.7982
INFO:root:new node validate roc_auc, 0.7647
INFO:root:Epoch: 19, learning rate: 4.641732050211155e-05, train loss: 0.3469
INFO:root:train average_precision, 0.9276
INFO:root:train roc_auc, 0.9239
INFO:root:validate loss: 0.4370
INFO:root:validate average_precision, 0.8727
INFO:root:validate roc_auc, 0.8749
INFO:root:new node validate loss: 0.5911
INFO:root:new node validate average_precision, 0.8073
INFO:root:new node validate roc_auc, 0.7782
INFO:root:Epoch: 20, learning rate: 0.00013090169943758345, train loss: 0.3490
INFO:root:train average_precision, 0.9254
INFO:root:train roc_auc, 0.9224
INFO:root:validate loss: 0.4348
INFO:root:validate average_precision, 0.8794
INFO:root:validate roc_auc, 0.8811
INFO:root:new node validate loss: 0.5786
INFO:root:new node validate average_precision, 0.8201
INFO:root:new node validate roc_auc, 0.7906
INFO:root:test loss: 0.4392
INFO:root:test average_precision, 0.9016
INFO:root:test roc_auc, 0.9027
INFO:root:new node test loss: 0.5728
INFO:root:new node test average_precision, 0.8429
INFO:root:new node test roc_auc, 0.8310
INFO:root:save model ./saved_models/TGN/uci/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 21, learning rate: 0.0001929776485888686, train loss: 0.3344
INFO:root:train average_precision, 0.9301
INFO:root:train roc_auc, 0.9268
INFO:root:validate loss: 0.4384
INFO:root:validate average_precision, 0.8792
INFO:root:validate roc_auc, 0.8812
INFO:root:new node validate loss: 0.5928
INFO:root:new node validate average_precision, 0.8113
INFO:root:new node validate roc_auc, 0.7800
INFO:root:Epoch: 22, learning rate: 0.00018763066800434467, train loss: 0.3398
INFO:root:train average_precision, 0.9281
INFO:root:train roc_auc, 0.9258
INFO:root:validate loss: 0.4366
INFO:root:validate average_precision, 0.8720
INFO:root:validate roc_auc, 0.8718
INFO:root:new node validate loss: 0.5673
INFO:root:new node validate average_precision, 0.8132
INFO:root:new node validate roc_auc, 0.7833
INFO:root:Epoch: 23, learning rate: 0.00011873813145862399, train loss: 0.3335
INFO:root:train average_precision, 0.9301
INFO:root:train roc_auc, 0.9282
INFO:root:validate loss: 0.4159
INFO:root:validate average_precision, 0.8854
INFO:root:validate roc_auc, 0.8853
INFO:root:new node validate loss: 0.5558
INFO:root:new node validate average_precision, 0.8231
INFO:root:new node validate roc_auc, 0.7940
INFO:root:save model ./saved_models/TGN/uci/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 24, learning rate: 3.6257601025131094e-05, train loss: 0.3287
INFO:root:train average_precision, 0.9340
INFO:root:train roc_auc, 0.9306
INFO:root:validate loss: 0.4147
INFO:root:validate average_precision, 0.8867
INFO:root:validate roc_auc, 0.8853
INFO:root:new node validate loss: 0.5534
INFO:root:new node validate average_precision, 0.8141
INFO:root:new node validate roc_auc, 0.7830
INFO:root:save model ./saved_models/TGN/uci/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 25, learning rate: 0.0, train loss: 0.3289
INFO:root:train average_precision, 0.9324
INFO:root:train roc_auc, 0.9299
INFO:root:validate loss: 0.4208
INFO:root:validate average_precision, 0.8817
INFO:root:validate roc_auc, 0.8823
INFO:root:new node validate loss: 0.5673
INFO:root:new node validate average_precision, 0.8236
INFO:root:new node validate roc_auc, 0.7952
INFO:root:Epoch: 26, learning rate: 3.625760102511391e-05, train loss: 0.3329
INFO:root:train average_precision, 0.9327
INFO:root:train roc_auc, 0.9298
INFO:root:validate loss: 0.4265
INFO:root:validate average_precision, 0.8752
INFO:root:validate roc_auc, 0.8779
INFO:root:new node validate loss: 0.5856
INFO:root:new node validate average_precision, 0.8139
INFO:root:new node validate roc_auc, 0.7866
INFO:root:Epoch: 27, learning rate: 0.00011873813145868208, train loss: 0.3387
INFO:root:train average_precision, 0.9292
INFO:root:train roc_auc, 0.9267
INFO:root:validate loss: 0.4312
INFO:root:validate average_precision, 0.8802
INFO:root:validate roc_auc, 0.8831
INFO:root:new node validate loss: 0.5963
INFO:root:new node validate average_precision, 0.8163
INFO:root:new node validate roc_auc, 0.7921
INFO:root:Epoch: 28, learning rate: 0.00018763066800447107, train loss: 0.3294
INFO:root:train average_precision, 0.9324
INFO:root:train roc_auc, 0.9297
INFO:root:validate loss: 0.4423
INFO:root:validate average_precision, 0.8730
INFO:root:validate roc_auc, 0.8753
INFO:root:new node validate loss: 0.6121
INFO:root:new node validate average_precision, 0.8173
INFO:root:new node validate roc_auc, 0.7889
INFO:root:Epoch: 29, learning rate: 0.0001929776485888243, train loss: 0.3359
INFO:root:train average_precision, 0.9276
INFO:root:train roc_auc, 0.9262
INFO:root:validate loss: 0.4849
INFO:root:validate average_precision, 0.8771
INFO:root:validate roc_auc, 0.8819
INFO:root:new node validate loss: 0.6819
INFO:root:new node validate average_precision, 0.8128
INFO:root:new node validate roc_auc, 0.7887
INFO:root:Epoch: 30, learning rate: 0.00013090169943767154, train loss: 0.3361
INFO:root:train average_precision, 0.9291
INFO:root:train roc_auc, 0.9268
INFO:root:validate loss: 0.4350
INFO:root:validate average_precision, 0.8721
INFO:root:validate roc_auc, 0.8720
INFO:root:new node validate loss: 0.5688
INFO:root:new node validate average_precision, 0.8090
INFO:root:new node validate roc_auc, 0.7795
INFO:root:test loss: 0.4171
INFO:root:test average_precision, 0.8903
INFO:root:test roc_auc, 0.8909
INFO:root:new node test loss: 0.5077
INFO:root:new node test average_precision, 0.8350
INFO:root:new node test roc_auc, 0.8253
INFO:root:Epoch: 31, learning rate: 4.641732050214138e-05, train loss: 0.3279
INFO:root:train average_precision, 0.9328
INFO:root:train roc_auc, 0.9306
INFO:root:validate loss: 0.4167
INFO:root:validate average_precision, 0.8841
INFO:root:validate roc_auc, 0.8840
INFO:root:new node validate loss: 0.5478
INFO:root:new node validate average_precision, 0.8254
INFO:root:new node validate roc_auc, 0.7986
INFO:root:Epoch: 32, learning rate: 7.885298685523453e-07, train loss: 0.3257
INFO:root:train average_precision, 0.9335
INFO:root:train roc_auc, 0.9314
INFO:root:validate loss: 0.4225
INFO:root:validate average_precision, 0.8800
INFO:root:validate roc_auc, 0.8803
INFO:root:new node validate loss: 0.5743
INFO:root:new node validate average_precision, 0.8205
INFO:root:new node validate roc_auc, 0.7930
INFO:root:Epoch: 33, learning rate: 2.7103137257871025e-05, train loss: 0.3277
INFO:root:train average_precision, 0.9329
INFO:root:train roc_auc, 0.9308
INFO:root:validate loss: 0.4210
INFO:root:validate average_precision, 0.8814
INFO:root:validate roc_auc, 0.8832
INFO:root:new node validate loss: 0.5942
INFO:root:new node validate average_precision, 0.8194
INFO:root:new node validate roc_auc, 0.7941
INFO:root:Epoch: 34, learning rate: 0.00010627905195293237, train loss: 0.3328
INFO:root:train average_precision, 0.9316
INFO:root:train roc_auc, 0.9290
INFO:root:validate loss: 0.4291
INFO:root:validate average_precision, 0.8801
INFO:root:validate roc_auc, 0.8825
INFO:root:new node validate loss: 0.5975
INFO:root:new node validate average_precision, 0.8168
INFO:root:new node validate roc_auc, 0.7878
INFO:root:Epoch: 35, learning rate: 0.00018090169943741467, train loss: 0.3301
INFO:root:train average_precision, 0.9309
INFO:root:train roc_auc, 0.9291
INFO:root:validate loss: 0.4430
INFO:root:validate average_precision, 0.8832
INFO:root:validate roc_auc, 0.8848
INFO:root:new node validate loss: 0.6253
INFO:root:new node validate average_precision, 0.8177
INFO:root:new node validate roc_auc, 0.7895
INFO:root:Epoch: 36, learning rate: 0.00019685831611304034, train loss: 0.3269
INFO:root:train average_precision, 0.9336
INFO:root:train roc_auc, 0.9307
INFO:root:validate loss: 0.4390
INFO:root:validate average_precision, 0.8863
INFO:root:validate roc_auc, 0.8868
INFO:root:new node validate loss: 0.6181
INFO:root:new node validate average_precision, 0.8199
INFO:root:new node validate roc_auc, 0.7913
INFO:root:Epoch: 37, learning rate: 0.00014257792915657063, train loss: 0.3316
INFO:root:train average_precision, 0.9320
INFO:root:train roc_auc, 0.9298
INFO:root:validate loss: 0.4299
INFO:root:validate average_precision, 0.8820
INFO:root:validate roc_auc, 0.8820
INFO:root:new node validate loss: 0.5785
INFO:root:new node validate average_precision, 0.8274
INFO:root:new node validate roc_auc, 0.8019
INFO:root:Epoch: 38, learning rate: 5.742207084349114e-05, train loss: 0.3259
INFO:root:train average_precision, 0.9341
INFO:root:train roc_auc, 0.9316
INFO:root:validate loss: 0.4197
INFO:root:validate average_precision, 0.8833
INFO:root:validate roc_auc, 0.8824
INFO:root:new node validate loss: 0.5492
INFO:root:new node validate average_precision, 0.8285
INFO:root:new node validate roc_auc, 0.8030
INFO:root:Epoch: 39, learning rate: 3.1416838871355007e-06, train loss: 0.3216
INFO:root:train average_precision, 0.9364
INFO:root:train roc_auc, 0.9337
INFO:root:validate loss: 0.4193
INFO:root:validate average_precision, 0.8916
INFO:root:validate roc_auc, 0.8904
INFO:root:new node validate loss: 0.5854
INFO:root:new node validate average_precision, 0.8380
INFO:root:new node validate roc_auc, 0.8108
INFO:root:save model ./saved_models/TGN/uci/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 40, learning rate: 1.909830056249714e-05, train loss: 0.3242
INFO:root:train average_precision, 0.9353
INFO:root:train roc_auc, 0.9329
INFO:root:validate loss: 0.4167
INFO:root:validate average_precision, 0.8874
INFO:root:validate roc_auc, 0.8868
INFO:root:new node validate loss: 0.5880
INFO:root:new node validate average_precision, 0.8375
INFO:root:new node validate roc_auc, 0.8102
INFO:root:test loss: 0.3968
INFO:root:test average_precision, 0.9092
INFO:root:test roc_auc, 0.9087
INFO:root:new node test loss: 0.5270
INFO:root:new node test average_precision, 0.8606
INFO:root:new node test roc_auc, 0.8473
INFO:root:Epoch: 41, learning rate: 9.37209480470043e-05, train loss: 0.3290
INFO:root:train average_precision, 0.9354
INFO:root:train roc_auc, 0.9321
INFO:root:validate loss: 0.4305
INFO:root:validate average_precision, 0.8862
INFO:root:validate roc_auc, 0.8861
INFO:root:new node validate loss: 0.6021
INFO:root:new node validate average_precision, 0.8420
INFO:root:new node validate roc_auc, 0.8155
INFO:root:Epoch: 42, learning rate: 0.00017289686274194672, train loss: 0.3215
INFO:root:train average_precision, 0.9343
INFO:root:train roc_auc, 0.9327
INFO:root:validate loss: 0.4292
INFO:root:validate average_precision, 0.8898
INFO:root:validate roc_auc, 0.8896
INFO:root:new node validate loss: 0.6205
INFO:root:new node validate average_precision, 0.8449
INFO:root:new node validate roc_auc, 0.8181
INFO:root:Epoch: 43, learning rate: 0.00019921147013185085, train loss: 0.3224
INFO:root:train average_precision, 0.9347
INFO:root:train roc_auc, 0.9329
INFO:root:validate loss: 0.4300
INFO:root:validate average_precision, 0.8904
INFO:root:validate roc_auc, 0.8894
INFO:root:new node validate loss: 0.5934
INFO:root:new node validate average_precision, 0.8504
INFO:root:new node validate roc_auc, 0.8251
INFO:root:Epoch: 44, learning rate: 0.0001535826794981424, train loss: 0.3206
INFO:root:train average_precision, 0.9367
INFO:root:train roc_auc, 0.9343
INFO:root:validate loss: 0.4259
INFO:root:validate average_precision, 0.8917
INFO:root:validate roc_auc, 0.8910
INFO:root:new node validate loss: 0.5979
INFO:root:new node validate average_precision, 0.8457
INFO:root:new node validate roc_auc, 0.8192
INFO:root:save model ./saved_models/TGN/uci/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 45, learning rate: 6.909830056258304e-05, train loss: 0.3209
INFO:root:train average_precision, 0.9371
INFO:root:train roc_auc, 0.9343
INFO:root:validate loss: 0.4166
INFO:root:validate average_precision, 0.8896
INFO:root:validate roc_auc, 0.8871
INFO:root:new node validate loss: 0.5530
INFO:root:new node validate average_precision, 0.8451
INFO:root:new node validate roc_auc, 0.8191
INFO:root:Epoch: 46, learning rate: 7.022351411178251e-06, train loss: 0.3159
INFO:root:train average_precision, 0.9381
INFO:root:train roc_auc, 0.9354
INFO:root:validate loss: 0.4251
INFO:root:validate average_precision, 0.8932
INFO:root:validate roc_auc, 0.8912
INFO:root:new node validate loss: 0.6028
INFO:root:new node validate average_precision, 0.8475
INFO:root:new node validate roc_auc, 0.8199
INFO:root:save model ./saved_models/TGN/uci/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 47, learning rate: 1.2369331995621503e-05, train loss: 0.3189
INFO:root:train average_precision, 0.9381
INFO:root:train roc_auc, 0.9355
INFO:root:validate loss: 0.4215
INFO:root:validate average_precision, 0.8925
INFO:root:validate roc_auc, 0.8911
INFO:root:new node validate loss: 0.6074
INFO:root:new node validate average_precision, 0.8497
INFO:root:new node validate roc_auc, 0.8226
INFO:root:Epoch: 48, learning rate: 8.126186854144578e-05, train loss: 0.3217
INFO:root:train average_precision, 0.9375
INFO:root:train roc_auc, 0.9349
INFO:root:validate loss: 0.4195
INFO:root:validate average_precision, 0.8947
INFO:root:validate roc_auc, 0.8931
INFO:root:new node validate loss: 0.5942
INFO:root:new node validate average_precision, 0.8514
INFO:root:new node validate roc_auc, 0.8254
INFO:root:save model ./saved_models/TGN/uci/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 49, learning rate: 0.00016374239897483278, train loss: 0.3151
INFO:root:train average_precision, 0.9380
INFO:root:train roc_auc, 0.9355
INFO:root:validate loss: 0.4429
INFO:root:validate average_precision, 0.8874
INFO:root:validate roc_auc, 0.8871
INFO:root:new node validate loss: 0.6432
INFO:root:new node validate average_precision, 0.8525
INFO:root:new node validate roc_auc, 0.8267
INFO:root:Epoch: 50, learning rate: 0.00020000000000022514, train loss: 0.3149
INFO:root:train average_precision, 0.9384
INFO:root:train roc_auc, 0.9360
INFO:root:validate loss: 0.4528
INFO:root:validate average_precision, 0.8872
INFO:root:validate roc_auc, 0.8851
INFO:root:new node validate loss: 0.6456
INFO:root:new node validate average_precision, 0.8477
INFO:root:new node validate roc_auc, 0.8199
INFO:root:test loss: 0.4280
INFO:root:test average_precision, 0.9153
INFO:root:test roc_auc, 0.9132
INFO:root:new node test loss: 0.5710
INFO:root:new node test average_precision, 0.8702
INFO:root:new node test roc_auc, 0.8574
INFO:root:Epoch: 51, learning rate: 0.00016374239897527237, train loss: 0.3148
INFO:root:train average_precision, 0.9387
INFO:root:train roc_auc, 0.9358
INFO:root:validate loss: 0.4585
INFO:root:validate average_precision, 0.8933
INFO:root:validate roc_auc, 0.8914
INFO:root:new node validate loss: 0.6505
INFO:root:new node validate average_precision, 0.8517
INFO:root:new node validate roc_auc, 0.8251
INFO:root:Epoch: 52, learning rate: 8.126186854144786e-05, train loss: 0.3157
INFO:root:train average_precision, 0.9396
INFO:root:train roc_auc, 0.9361
INFO:root:validate loss: 0.4204
INFO:root:validate average_precision, 0.8928
INFO:root:validate roc_auc, 0.8890
INFO:root:new node validate loss: 0.5744
INFO:root:new node validate average_precision, 0.8451
INFO:root:new node validate roc_auc, 0.8174
INFO:root:Epoch: 53, learning rate: 1.236933199563365e-05, train loss: 0.3137
INFO:root:train average_precision, 0.9405
INFO:root:train roc_auc, 0.9373
INFO:root:validate loss: 0.4341
INFO:root:validate average_precision, 0.8981
INFO:root:validate roc_auc, 0.8950
INFO:root:new node validate loss: 0.6203
INFO:root:new node validate average_precision, 0.8500
INFO:root:new node validate roc_auc, 0.8244
INFO:root:save model ./saved_models/TGN/uci/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 54, learning rate: 7.022351411187958e-06, train loss: 0.3111
INFO:root:train average_precision, 0.9399
INFO:root:train roc_auc, 0.9375
INFO:root:validate loss: 0.4163
INFO:root:validate average_precision, 0.8949
INFO:root:validate roc_auc, 0.8938
INFO:root:new node validate loss: 0.6034
INFO:root:new node validate average_precision, 0.8458
INFO:root:new node validate roc_auc, 0.8229
INFO:root:Epoch: 55, learning rate: 6.909830056245937e-05, train loss: 0.3158
INFO:root:train average_precision, 0.9400
INFO:root:train roc_auc, 0.9370
INFO:root:validate loss: 0.4297
INFO:root:validate average_precision, 0.8913
INFO:root:validate roc_auc, 0.8899
INFO:root:new node validate loss: 0.6208
INFO:root:new node validate average_precision, 0.8502
INFO:root:new node validate roc_auc, 0.8235
INFO:root:Epoch: 56, learning rate: 0.00015358267949800475, train loss: 0.3112
INFO:root:train average_precision, 0.9408
INFO:root:train roc_auc, 0.9379
INFO:root:validate loss: 0.4528
INFO:root:validate average_precision, 0.8960
INFO:root:validate roc_auc, 0.8936
INFO:root:new node validate loss: 0.6772
INFO:root:new node validate average_precision, 0.8547
INFO:root:new node validate roc_auc, 0.8288
INFO:root:Epoch: 57, learning rate: 0.00019921147013189584, train loss: 0.3084
INFO:root:train average_precision, 0.9417
INFO:root:train roc_auc, 0.9387
INFO:root:validate loss: 0.4309
INFO:root:validate average_precision, 0.8916
INFO:root:validate roc_auc, 0.8881
INFO:root:new node validate loss: 0.6208
INFO:root:new node validate average_precision, 0.8446
INFO:root:new node validate roc_auc, 0.8164
INFO:root:Epoch: 58, learning rate: 0.0001728968627421386, train loss: 0.3052
INFO:root:train average_precision, 0.9432
INFO:root:train roc_auc, 0.9399
INFO:root:validate loss: 0.5096
INFO:root:validate average_precision, 0.8896
INFO:root:validate roc_auc, 0.8883
INFO:root:new node validate loss: 0.7263
INFO:root:new node validate average_precision, 0.8506
INFO:root:new node validate roc_auc, 0.8224
INFO:root:Epoch: 59, learning rate: 9.372094804719067e-05, train loss: 0.3094
INFO:root:train average_precision, 0.9418
INFO:root:train roc_auc, 0.9381
INFO:root:validate loss: 0.4213
INFO:root:validate average_precision, 0.8945
INFO:root:validate roc_auc, 0.8901
INFO:root:new node validate loss: 0.6027
INFO:root:new node validate average_precision, 0.8459
INFO:root:new node validate roc_auc, 0.8190
INFO:root:Epoch: 60, learning rate: 1.9098300562488166e-05, train loss: 0.3060
INFO:root:train average_precision, 0.9427
INFO:root:train roc_auc, 0.9399
INFO:root:validate loss: 0.4240
INFO:root:validate average_precision, 0.9001
INFO:root:validate roc_auc, 0.8971
INFO:root:new node validate loss: 0.6334
INFO:root:new node validate average_precision, 0.8517
INFO:root:new node validate roc_auc, 0.8256
INFO:root:test loss: 0.4369
INFO:root:test average_precision, 0.9227
INFO:root:test roc_auc, 0.9201
INFO:root:new node test loss: 0.5997
INFO:root:new node test average_precision, 0.8745
INFO:root:new node test roc_auc, 0.8607
INFO:root:save model ./saved_models/TGN/uci/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 61, learning rate: 3.1416838871342586e-06, train loss: 0.3050
INFO:root:train average_precision, 0.9430
INFO:root:train roc_auc, 0.9399
INFO:root:validate loss: 0.4165
INFO:root:validate average_precision, 0.8972
INFO:root:validate roc_auc, 0.8947
INFO:root:new node validate loss: 0.6151
INFO:root:new node validate average_precision, 0.8541
INFO:root:new node validate roc_auc, 0.8267
INFO:root:Epoch: 62, learning rate: 5.7422070843520144e-05, train loss: 0.3078
INFO:root:train average_precision, 0.9423
INFO:root:train roc_auc, 0.9393
INFO:root:validate loss: 0.4076
INFO:root:validate average_precision, 0.8987
INFO:root:validate roc_auc, 0.8960
INFO:root:new node validate loss: 0.5933
INFO:root:new node validate average_precision, 0.8529
INFO:root:new node validate roc_auc, 0.8271
INFO:root:Epoch: 63, learning rate: 0.00014257792915625287, train loss: 0.3087
INFO:root:train average_precision, 0.9421
INFO:root:train roc_auc, 0.9390
INFO:root:validate loss: 0.4292
INFO:root:validate average_precision, 0.8945
INFO:root:validate roc_auc, 0.8928
INFO:root:new node validate loss: 0.6384
INFO:root:new node validate average_precision, 0.8428
INFO:root:new node validate roc_auc, 0.8185
INFO:root:Epoch: 64, learning rate: 0.00019685831611277526, train loss: 0.3068
INFO:root:train average_precision, 0.9415
INFO:root:train roc_auc, 0.9388
INFO:root:validate loss: 0.4758
INFO:root:validate average_precision, 0.8932
INFO:root:validate roc_auc, 0.8917
INFO:root:new node validate loss: 0.6941
INFO:root:new node validate average_precision, 0.8454
INFO:root:new node validate roc_auc, 0.8179
INFO:root:Epoch: 65, learning rate: 0.00018090169943765484, train loss: 0.3072
INFO:root:train average_precision, 0.9430
INFO:root:train roc_auc, 0.9394
INFO:root:validate loss: 0.4488
INFO:root:validate average_precision, 0.8934
INFO:root:validate roc_auc, 0.8903
INFO:root:new node validate loss: 0.6570
INFO:root:new node validate average_precision, 0.8475
INFO:root:new node validate roc_auc, 0.8170
INFO:root:Epoch: 66, learning rate: 0.00010627905195278804, train loss: 0.3089
INFO:root:train average_precision, 0.9423
INFO:root:train roc_auc, 0.9389
INFO:root:validate loss: 0.4426
INFO:root:validate average_precision, 0.8901
INFO:root:validate roc_auc, 0.8881
INFO:root:new node validate loss: 0.6459
INFO:root:new node validate average_precision, 0.8485
INFO:root:new node validate roc_auc, 0.8207
INFO:root:Epoch: 67, learning rate: 2.7103137257955887e-05, train loss: 0.3024
INFO:root:train average_precision, 0.9446
INFO:root:train roc_auc, 0.9416
INFO:root:validate loss: 0.4074
INFO:root:validate average_precision, 0.9012
INFO:root:validate roc_auc, 0.8976
INFO:root:new node validate loss: 0.5691
INFO:root:new node validate average_precision, 0.8574
INFO:root:new node validate roc_auc, 0.8321
INFO:root:save model ./saved_models/TGN/uci/TGN_seed2/TGN_seed2.pkl
INFO:root:Epoch: 68, learning rate: 7.885298685552731e-07, train loss: 0.2978
INFO:root:train average_precision, 0.9461
INFO:root:train roc_auc, 0.9428
INFO:root:validate loss: 0.4204
INFO:root:validate average_precision, 0.8977
INFO:root:validate roc_auc, 0.8958
INFO:root:new node validate loss: 0.6206
INFO:root:new node validate average_precision, 0.8537
INFO:root:new node validate roc_auc, 0.8272
INFO:root:Epoch: 69, learning rate: 4.64173205021652e-05, train loss: 0.3024
INFO:root:train average_precision, 0.9442
INFO:root:train roc_auc, 0.9410
INFO:root:validate loss: 0.4149
INFO:root:validate average_precision, 0.8993
INFO:root:validate roc_auc, 0.8965
INFO:root:new node validate loss: 0.6083
INFO:root:new node validate average_precision, 0.8519
INFO:root:new node validate roc_auc, 0.8260
INFO:root:Epoch: 70, learning rate: 0.00013090169943785155, train loss: 0.3011
INFO:root:train average_precision, 0.9440
INFO:root:train roc_auc, 0.9413
INFO:root:validate loss: 0.4257
INFO:root:validate average_precision, 0.8967
INFO:root:validate roc_auc, 0.8945
INFO:root:new node validate loss: 0.6326
INFO:root:new node validate average_precision, 0.8417
INFO:root:new node validate roc_auc, 0.8158
INFO:root:test loss: 0.4122
INFO:root:test average_precision, 0.9251
INFO:root:test roc_auc, 0.9230
INFO:root:new node test loss: 0.5673
INFO:root:new node test average_precision, 0.8779
INFO:root:new node test roc_auc, 0.8645
INFO:root:Epoch: 71, learning rate: 0.0001929776485889137, train loss: 0.3013
INFO:root:train average_precision, 0.9441
INFO:root:train roc_auc, 0.9412
INFO:root:validate loss: 0.4593
INFO:root:validate average_precision, 0.8905
INFO:root:validate roc_auc, 0.8899
INFO:root:new node validate loss: 0.6455
INFO:root:new node validate average_precision, 0.8516
INFO:root:new node validate roc_auc, 0.8252
INFO:root:Epoch: 72, learning rate: 0.0001876306680047241, train loss: 0.3009
INFO:root:train average_precision, 0.9449
INFO:root:train roc_auc, 0.9416
INFO:root:validate loss: 0.4477
INFO:root:validate average_precision, 0.8937
INFO:root:validate roc_auc, 0.8922
INFO:root:new node validate loss: 0.6741
INFO:root:new node validate average_precision, 0.8478
INFO:root:new node validate roc_auc, 0.8227
INFO:root:Epoch: 73, learning rate: 0.00011873813145851827, train loss: 0.3007
INFO:root:train average_precision, 0.9448
INFO:root:train roc_auc, 0.9417
INFO:root:validate loss: 0.4222
INFO:root:validate average_precision, 0.8980
INFO:root:validate roc_auc, 0.8943
INFO:root:new node validate loss: 0.6059
INFO:root:new node validate average_precision, 0.8457
INFO:root:new node validate roc_auc, 0.8157
INFO:root:Epoch: 74, learning rate: 3.625760102517048e-05, train loss: 0.3030
INFO:root:train average_precision, 0.9442
INFO:root:train roc_auc, 0.9413
INFO:root:validate loss: 0.4063
INFO:root:validate average_precision, 0.8969
INFO:root:validate roc_auc, 0.8929
INFO:root:new node validate loss: 0.5421
INFO:root:new node validate average_precision, 0.8552
INFO:root:new node validate roc_auc, 0.8318
INFO:root:Epoch: 75, learning rate: 0.0, train loss: 0.3022
INFO:root:train average_precision, 0.9436
INFO:root:train roc_auc, 0.9413
INFO:root:validate loss: 0.4293
INFO:root:validate average_precision, 0.8984
INFO:root:validate roc_auc, 0.8963
INFO:root:new node validate loss: 0.6181
INFO:root:new node validate average_precision, 0.8559
INFO:root:new node validate roc_auc, 0.8322
INFO:root:Epoch: 76, learning rate: 3.625760102509302e-05, train loss: 0.3052
INFO:root:train average_precision, 0.9434
INFO:root:train roc_auc, 0.9406
INFO:root:validate loss: 0.4199
INFO:root:validate average_precision, 0.8958
INFO:root:validate roc_auc, 0.8948
INFO:root:new node validate loss: 0.6025
INFO:root:new node validate average_precision, 0.8504
INFO:root:new node validate roc_auc, 0.8261
INFO:root:Epoch: 77, learning rate: 0.00011873813145859789, train loss: 0.3038
INFO:root:train average_precision, 0.9435
INFO:root:train roc_auc, 0.9413
INFO:root:validate loss: 0.4096
INFO:root:validate average_precision, 0.9008
INFO:root:validate roc_auc, 0.8986
INFO:root:new node validate loss: 0.6060
INFO:root:new node validate average_precision, 0.8586
INFO:root:new node validate roc_auc, 0.8359
INFO:root:Epoch: 78, learning rate: 0.00018763066800468162, train loss: 0.2964
INFO:root:train average_precision, 0.9464
INFO:root:train roc_auc, 0.9431
INFO:root:validate loss: 0.4833
INFO:root:validate average_precision, 0.8979
INFO:root:validate roc_auc, 0.8957
INFO:root:new node validate loss: 0.6877
INFO:root:new node validate average_precision, 0.8542
INFO:root:new node validate roc_auc, 0.8307
INFO:root:Epoch: 79, learning rate: 0.00019297764858869463, train loss: 0.2980
INFO:root:train average_precision, 0.9455
INFO:root:train roc_auc, 0.9429
INFO:root:validate loss: 0.4460
INFO:root:validate average_precision, 0.8953
INFO:root:validate roc_auc, 0.8923
INFO:root:new node validate loss: 0.6111
INFO:root:new node validate average_precision, 0.8490
INFO:root:new node validate roc_auc, 0.8259
INFO:root:Epoch: 80, learning rate: 0.00013090169943758156, train loss: 0.3025
INFO:root:train average_precision, 0.9444
INFO:root:train roc_auc, 0.9414
INFO:root:validate loss: 0.4526
INFO:root:validate average_precision, 0.8992
INFO:root:validate roc_auc, 0.8938
INFO:root:new node validate loss: 0.5994
INFO:root:new node validate average_precision, 0.8499
INFO:root:new node validate roc_auc, 0.8261
INFO:root:test loss: 0.5513
INFO:root:test average_precision, 0.9188
INFO:root:test roc_auc, 0.9148
INFO:root:new node test loss: 0.6922
INFO:root:new node test average_precision, 0.8670
INFO:root:new node test roc_auc, 0.8500
INFO:root:Epoch: 81, learning rate: 4.641732050202497e-05, train loss: 0.2997
INFO:root:train average_precision, 0.9459
INFO:root:train roc_auc, 0.9432
INFO:root:validate loss: 0.4006
INFO:root:validate average_precision, 0.9008
INFO:root:validate roc_auc, 0.8971
INFO:root:new node validate loss: 0.5467
INFO:root:new node validate average_precision, 0.8554
INFO:root:new node validate roc_auc, 0.8330
INFO:root:Epoch: 82, learning rate: 7.885298685551401e-07, train loss: 0.2975
INFO:root:train average_precision, 0.9448
INFO:root:train roc_auc, 0.9426
INFO:root:validate loss: 0.4388
INFO:root:validate average_precision, 0.9008
INFO:root:validate roc_auc, 0.8979
INFO:root:new node validate loss: 0.6391
INFO:root:new node validate average_precision, 0.8564
INFO:root:new node validate roc_auc, 0.8321
INFO:root:Epoch: 83, learning rate: 2.7103137257949535e-05, train loss: 0.2953
INFO:root:train average_precision, 0.9474
INFO:root:train roc_auc, 0.9442
INFO:root:validate loss: 0.4184
INFO:root:validate average_precision, 0.8997
INFO:root:validate roc_auc, 0.8967
INFO:root:new node validate loss: 0.5904
INFO:root:new node validate average_precision, 0.8454
INFO:root:new node validate roc_auc, 0.8185
INFO:root:Epoch: 84, learning rate: 0.00010627905195305074, train loss: 0.2960
INFO:root:train average_precision, 0.9473
INFO:root:train roc_auc, 0.9443
INFO:root:validate loss: 0.4281
INFO:root:validate average_precision, 0.8995
INFO:root:validate roc_auc, 0.8953
INFO:root:new node validate loss: 0.5936
INFO:root:new node validate average_precision, 0.8554
INFO:root:new node validate roc_auc, 0.8312
INFO:root:Epoch: 85, learning rate: 0.00018090169943794294, train loss: 0.2949
INFO:root:train average_precision, 0.9467
INFO:root:train roc_auc, 0.9438
INFO:root:validate loss: 0.4624
INFO:root:validate average_precision, 0.9002
INFO:root:validate roc_auc, 0.8960
INFO:root:new node validate loss: 0.6215
INFO:root:new node validate average_precision, 0.8508
INFO:root:new node validate roc_auc, 0.8227
INFO:root:Epoch: 86, learning rate: 0.0001968583161129072, train loss: 0.2956
INFO:root:train average_precision, 0.9459
INFO:root:train roc_auc, 0.9439
INFO:root:validate loss: 0.4773
INFO:root:validate average_precision, 0.8949
INFO:root:validate roc_auc, 0.8916
INFO:root:new node validate loss: 0.6696
INFO:root:new node validate average_precision, 0.8566
INFO:root:new node validate roc_auc, 0.8310
INFO:root:Epoch: 87, learning rate: 0.00014257792915672952, train loss: 0.2977
INFO:root:train average_precision, 0.9462
INFO:root:train roc_auc, 0.9433
INFO:root:validate loss: 0.4810
INFO:root:validate average_precision, 0.8974
INFO:root:validate roc_auc, 0.8933
INFO:root:new node validate loss: 0.6211
INFO:root:new node validate average_precision, 0.8566
INFO:root:new node validate roc_auc, 0.8321
INFO:root:load model ./saved_models/TGN/uci/TGN_seed2/TGN_seed2.pkl
INFO:root:get final performance on dataset uci...
INFO:root:test loss: 0.4292
INFO:root:test average_precision, 0.9219
INFO:root:test roc_auc, 0.9187
INFO:root:new node test loss: 0.5679
INFO:root:new node test average_precision, 0.8774
INFO:root:new node test roc_auc, 0.8628
INFO:root:Run 3 cost 9586.30 seconds.
INFO:root:********** Run 4 starts. **********
INFO:root:configuration is Namespace(dataset_name='uci', batch_size=200, model_name='TGN', gpu=0, num_neighbors=10, sample_neighbor_strategy='recent', time_scaling_factor=1e-06, num_walk_heads=8, num_heads=2, num_layers=2, walk_length=1, time_gap=2000, time_feat_dim=100, position_feat_dim=172, edge_bank_memory_mode='unlimited_memory', time_window_mode='fixed_proportion', patch_size=200, channel_embedding_dim=50, max_input_sequence_length=64, learning_rate=0.0001, dropout=0.1, num_epochs=100, optimizer='Adam', weight_decay=0.0, patience=20, val_ratio=0.15, test_ratio=0.15, num_runs=5, test_interval_epochs=10, negative_sample_strategy='random', load_best_configs=False, device='cuda:0', seed=3, save_model_name='TGN_seed3')
INFO:root:model -> Sequential(
  (0): MemoryModel(
    (src_memory_encoder): Linear(in_features=172, out_features=172, bias=True)
    (dst_memory_encoder): Linear(in_features=172, out_features=172, bias=True)
    (edge_encoder): Linear(in_features=172, out_features=172, bias=True)
    (channel_attention): ChannelAttentionTemporal(
      (avg_pool): AdaptiveAvgPool1d(output_size=1)
      (max_pool): AdaptiveMaxPool1d(output_size=1)
      (fc1): Linear(in_features=4, out_features=0, bias=False)
      (relu1): ReLU()
      (fc2): Linear(in_features=0, out_features=4, bias=False)
      (sigmoid): Sigmoid()
    )
    (time_encoder): TimeEncoder(
      (w): Linear(in_features=1, out_features=100, bias=True)
    )
    (message_aggregator): MessageAggregator()
    (memory_bank): MemoryBank(num_nodes=1900, memory_dim=172)
    (memory_updater): CFCMemoryUpdater(
      (memory_bank): MemoryBank(num_nodes=1900, memory_dim=172)
      (memory_updater): MoE(
        (mixer): Linear(in_features=788, out_features=616, bias=True)
        (relu): ReLU(inplace=True)
        (experts): ModuleList(
          (0-2): 3 x rnnmodule(
            (cell): GRUCell(616, 172)
            (relu): ReLU()
          )
          (3-5): 3 x cfcmodule(
            (cell): cfcbundle(
              (rnn_cell): CfCCell(
                (backbone): Sequential(
                  (0): Linear(in_features=788, out_features=128, bias=True)
                  (1): LeCun(
                    (tanh): Tanh()
                  )
                )
                (tanh): Tanh()
                (sigmoid): Sigmoid()
                (ff1): Linear(in_features=128, out_features=172, bias=True)
                (ff2): Linear(in_features=128, out_features=172, bias=True)
                (time_a): Linear(in_features=128, out_features=172, bias=True)
                (time_b): Linear(in_features=128, out_features=172, bias=True)
              )
              (leaky_factor): Linear(in_features=616, out_features=172, bias=True)
            )
            (relu): ReLU()
          )
        )
        (softplus): Softplus(beta=1.0, threshold=20.0)
        (softmax): Softmax(dim=1)
      )
    )
    (embedding_module): GraphAttentionEmbedding(
      (time_encoder): TimeEncoder(
        (w): Linear(in_features=1, out_features=100, bias=True)
      )
      (temporal_conv_layers): ModuleList(
        (0-1): 2 x MultiHeadAttention(
          (query_projection): Linear(in_features=272, out_features=272, bias=False)
          (key_projection): Linear(in_features=444, out_features=272, bias=False)
          (value_projection): Linear(in_features=444, out_features=272, bias=False)
          (layer_norm): LayerNorm((272,), eps=1e-05, elementwise_affine=True)
          (residual_fc): Linear(in_features=272, out_features=272, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (merge_layers): ModuleList(
        (0-1): 2 x MergeLayer(
          (fc1): Linear(in_features=444, out_features=172, bias=True)
          (fc2): Linear(in_features=172, out_features=172, bias=True)
          (act): ReLU()
        )
      )
    )
  )
  (1): MergeLayer(
    (fc1): Linear(in_features=344, out_features=172, bias=True)
    (fc2): Linear(in_features=172, out_features=1, bias=True)
    (act): ReLU()
  )
)
INFO:root:model name: TGN, #parameters: 14984612 B, 14633.41015625 KB, 14.29043960571289 MB.
INFO:root:Epoch: 1, learning rate: 0.00016374239897486902, train loss: 0.4355
INFO:root:train average_precision, 0.8976
INFO:root:train roc_auc, 0.8888
INFO:root:validate loss: 0.5182
INFO:root:validate average_precision, 0.8340
INFO:root:validate roc_auc, 0.8196
INFO:root:new node validate loss: 0.6028
INFO:root:new node validate average_precision, 0.7715
INFO:root:new node validate roc_auc, 0.7292
INFO:root:save model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 2, learning rate: 8.126186854142736e-05, train loss: 0.3956
INFO:root:train average_precision, 0.9051
INFO:root:train roc_auc, 0.8990
INFO:root:validate loss: 0.4990
INFO:root:validate average_precision, 0.8306
INFO:root:validate roc_auc, 0.8202
INFO:root:new node validate loss: 0.5943
INFO:root:new node validate average_precision, 0.7746
INFO:root:new node validate roc_auc, 0.7342
INFO:root:Epoch: 3, learning rate: 1.2369331995613646e-05, train loss: 0.3819
INFO:root:train average_precision, 0.9094
INFO:root:train roc_auc, 0.9044
INFO:root:validate loss: 0.4971
INFO:root:validate average_precision, 0.8292
INFO:root:validate roc_auc, 0.8214
INFO:root:new node validate loss: 0.5888
INFO:root:new node validate average_precision, 0.7712
INFO:root:new node validate roc_auc, 0.7344
INFO:root:Epoch: 4, learning rate: 7.022351411174938e-06, train loss: 0.3743
INFO:root:train average_precision, 0.9164
INFO:root:train roc_auc, 0.9102
INFO:root:validate loss: 0.4962
INFO:root:validate average_precision, 0.8306
INFO:root:validate roc_auc, 0.8225
INFO:root:new node validate loss: 0.5712
INFO:root:new node validate average_precision, 0.7800
INFO:root:new node validate roc_auc, 0.7428
INFO:root:Epoch: 5, learning rate: 6.909830056248985e-05, train loss: 0.3773
INFO:root:train average_precision, 0.9181
INFO:root:train roc_auc, 0.9119
INFO:root:validate loss: 0.4883
INFO:root:validate average_precision, 0.8384
INFO:root:validate roc_auc, 0.8299
INFO:root:new node validate loss: 0.5900
INFO:root:new node validate average_precision, 0.7762
INFO:root:new node validate roc_auc, 0.7358
INFO:root:save model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 6, learning rate: 0.00015358267949790012, train loss: 0.3670
INFO:root:train average_precision, 0.9185
INFO:root:train roc_auc, 0.9132
INFO:root:validate loss: 0.4775
INFO:root:validate average_precision, 0.8500
INFO:root:validate roc_auc, 0.8410
INFO:root:new node validate loss: 0.5830
INFO:root:new node validate average_precision, 0.7782
INFO:root:new node validate roc_auc, 0.7382
INFO:root:save model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 7, learning rate: 0.00019921147013149252, train loss: 0.3666
INFO:root:train average_precision, 0.9176
INFO:root:train roc_auc, 0.9123
INFO:root:validate loss: 0.4749
INFO:root:validate average_precision, 0.8517
INFO:root:validate roc_auc, 0.8430
INFO:root:new node validate loss: 0.5734
INFO:root:new node validate average_precision, 0.7818
INFO:root:new node validate roc_auc, 0.7427
INFO:root:save model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 8, learning rate: 0.00017289686274217977, train loss: 0.3655
INFO:root:train average_precision, 0.9190
INFO:root:train roc_auc, 0.9131
INFO:root:validate loss: 0.4733
INFO:root:validate average_precision, 0.8496
INFO:root:validate roc_auc, 0.8421
INFO:root:new node validate loss: 0.5879
INFO:root:new node validate average_precision, 0.7750
INFO:root:new node validate roc_auc, 0.7348
INFO:root:Epoch: 9, learning rate: 9.372094804704758e-05, train loss: 0.3623
INFO:root:train average_precision, 0.9203
INFO:root:train roc_auc, 0.9151
INFO:root:validate loss: 0.4698
INFO:root:validate average_precision, 0.8536
INFO:root:validate roc_auc, 0.8461
INFO:root:new node validate loss: 0.5923
INFO:root:new node validate average_precision, 0.7854
INFO:root:new node validate roc_auc, 0.7493
INFO:root:save model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 10, learning rate: 1.9098300562509427e-05, train loss: 0.3670
INFO:root:train average_precision, 0.9174
INFO:root:train roc_auc, 0.9125
INFO:root:validate loss: 0.4835
INFO:root:validate average_precision, 0.8412
INFO:root:validate roc_auc, 0.8358
INFO:root:new node validate loss: 0.5909
INFO:root:new node validate average_precision, 0.7790
INFO:root:new node validate roc_auc, 0.7445
INFO:root:test loss: 0.4672
INFO:root:test average_precision, 0.8565
INFO:root:test roc_auc, 0.8523
INFO:root:new node test loss: 0.5326
INFO:root:new node test average_precision, 0.8019
INFO:root:new node test roc_auc, 0.7852
INFO:root:Epoch: 11, learning rate: 3.1416838871375353e-06, train loss: 0.3592
INFO:root:train average_precision, 0.9222
INFO:root:train roc_auc, 0.9170
INFO:root:validate loss: 0.4737
INFO:root:validate average_precision, 0.8486
INFO:root:validate roc_auc, 0.8438
INFO:root:new node validate loss: 0.5856
INFO:root:new node validate average_precision, 0.7830
INFO:root:new node validate roc_auc, 0.7450
INFO:root:Epoch: 12, learning rate: 5.742207084350565e-05, train loss: 0.3636
INFO:root:train average_precision, 0.9203
INFO:root:train roc_auc, 0.9156
INFO:root:validate loss: 0.4663
INFO:root:validate average_precision, 0.8511
INFO:root:validate roc_auc, 0.8495
INFO:root:new node validate loss: 0.5925
INFO:root:new node validate average_precision, 0.7908
INFO:root:new node validate roc_auc, 0.7572
INFO:root:Epoch: 13, learning rate: 0.00014257792915647467, train loss: 0.3526
INFO:root:train average_precision, 0.9243
INFO:root:train roc_auc, 0.9204
INFO:root:validate loss: 0.4370
INFO:root:validate average_precision, 0.8742
INFO:root:validate roc_auc, 0.8750
INFO:root:new node validate loss: 0.5763
INFO:root:new node validate average_precision, 0.8056
INFO:root:new node validate roc_auc, 0.7755
INFO:root:save model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 14, learning rate: 0.00019685831611290764, train loss: 0.3524
INFO:root:train average_precision, 0.9230
INFO:root:train roc_auc, 0.9197
INFO:root:validate loss: 0.4760
INFO:root:validate average_precision, 0.8503
INFO:root:validate roc_auc, 0.8444
INFO:root:new node validate loss: 0.5934
INFO:root:new node validate average_precision, 0.7803
INFO:root:new node validate roc_auc, 0.7321
INFO:root:Epoch: 15, learning rate: 0.0001809016994376168, train loss: 0.3508
INFO:root:train average_precision, 0.9244
INFO:root:train roc_auc, 0.9205
INFO:root:validate loss: 0.4532
INFO:root:validate average_precision, 0.8765
INFO:root:validate roc_auc, 0.8763
INFO:root:new node validate loss: 0.5970
INFO:root:new node validate average_precision, 0.8060
INFO:root:new node validate roc_auc, 0.7759
INFO:root:save model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 16, learning rate: 0.00010627905195295439, train loss: 0.3398
INFO:root:train average_precision, 0.9282
INFO:root:train roc_auc, 0.9254
INFO:root:validate loss: 0.4463
INFO:root:validate average_precision, 0.8658
INFO:root:validate roc_auc, 0.8640
INFO:root:new node validate loss: 0.5767
INFO:root:new node validate average_precision, 0.8018
INFO:root:new node validate roc_auc, 0.7697
INFO:root:Epoch: 17, learning rate: 2.7103137257852454e-05, train loss: 0.3401
INFO:root:train average_precision, 0.9286
INFO:root:train roc_auc, 0.9249
INFO:root:validate loss: 0.4462
INFO:root:validate average_precision, 0.8638
INFO:root:validate roc_auc, 0.8634
INFO:root:new node validate loss: 0.5826
INFO:root:new node validate average_precision, 0.7992
INFO:root:new node validate roc_auc, 0.7677
INFO:root:Epoch: 18, learning rate: 7.885298685520349e-07, train loss: 0.3421
INFO:root:train average_precision, 0.9268
INFO:root:train roc_auc, 0.9242
INFO:root:validate loss: 0.4350
INFO:root:validate average_precision, 0.8714
INFO:root:validate roc_auc, 0.8730
INFO:root:new node validate loss: 0.5912
INFO:root:new node validate average_precision, 0.8071
INFO:root:new node validate roc_auc, 0.7767
INFO:root:Epoch: 19, learning rate: 4.641732050211155e-05, train loss: 0.3425
INFO:root:train average_precision, 0.9274
INFO:root:train roc_auc, 0.9245
INFO:root:validate loss: 0.4375
INFO:root:validate average_precision, 0.8682
INFO:root:validate roc_auc, 0.8700
INFO:root:new node validate loss: 0.5746
INFO:root:new node validate average_precision, 0.8166
INFO:root:new node validate roc_auc, 0.7856
INFO:root:Epoch: 20, learning rate: 0.00013090169943758345, train loss: 0.3402
INFO:root:train average_precision, 0.9283
INFO:root:train roc_auc, 0.9252
INFO:root:validate loss: 0.4328
INFO:root:validate average_precision, 0.8802
INFO:root:validate roc_auc, 0.8810
INFO:root:new node validate loss: 0.5756
INFO:root:new node validate average_precision, 0.8230
INFO:root:new node validate roc_auc, 0.7939
INFO:root:test loss: 0.4240
INFO:root:test average_precision, 0.8986
INFO:root:test roc_auc, 0.9009
INFO:root:new node test loss: 0.5468
INFO:root:new node test average_precision, 0.8446
INFO:root:new node test roc_auc, 0.8344
INFO:root:save model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 21, learning rate: 0.0001929776485888686, train loss: 0.3378
INFO:root:train average_precision, 0.9290
INFO:root:train roc_auc, 0.9264
INFO:root:validate loss: 0.4469
INFO:root:validate average_precision, 0.8692
INFO:root:validate roc_auc, 0.8703
INFO:root:new node validate loss: 0.6122
INFO:root:new node validate average_precision, 0.8099
INFO:root:new node validate roc_auc, 0.7789
INFO:root:Epoch: 22, learning rate: 0.00018763066800434467, train loss: 0.3357
INFO:root:train average_precision, 0.9299
INFO:root:train roc_auc, 0.9269
INFO:root:validate loss: 0.4413
INFO:root:validate average_precision, 0.8801
INFO:root:validate roc_auc, 0.8819
INFO:root:new node validate loss: 0.6076
INFO:root:new node validate average_precision, 0.8201
INFO:root:new node validate roc_auc, 0.7910
INFO:root:Epoch: 23, learning rate: 0.00011873813145862399, train loss: 0.3323
INFO:root:train average_precision, 0.9308
INFO:root:train roc_auc, 0.9286
INFO:root:validate loss: 0.4287
INFO:root:validate average_precision, 0.8779
INFO:root:validate roc_auc, 0.8767
INFO:root:new node validate loss: 0.5729
INFO:root:new node validate average_precision, 0.8194
INFO:root:new node validate roc_auc, 0.7886
INFO:root:Epoch: 24, learning rate: 3.6257601025131094e-05, train loss: 0.3303
INFO:root:train average_precision, 0.9320
INFO:root:train roc_auc, 0.9294
INFO:root:validate loss: 0.4303
INFO:root:validate average_precision, 0.8740
INFO:root:validate roc_auc, 0.8748
INFO:root:new node validate loss: 0.5786
INFO:root:new node validate average_precision, 0.8104
INFO:root:new node validate roc_auc, 0.7821
INFO:root:Epoch: 25, learning rate: 0.0, train loss: 0.3335
INFO:root:train average_precision, 0.9310
INFO:root:train roc_auc, 0.9286
INFO:root:validate loss: 0.4221
INFO:root:validate average_precision, 0.8810
INFO:root:validate roc_auc, 0.8804
INFO:root:new node validate loss: 0.5785
INFO:root:new node validate average_precision, 0.8235
INFO:root:new node validate roc_auc, 0.7944
INFO:root:Epoch: 26, learning rate: 3.625760102511391e-05, train loss: 0.3332
INFO:root:train average_precision, 0.9326
INFO:root:train roc_auc, 0.9298
INFO:root:validate loss: 0.4224
INFO:root:validate average_precision, 0.8831
INFO:root:validate roc_auc, 0.8826
INFO:root:new node validate loss: 0.5990
INFO:root:new node validate average_precision, 0.8296
INFO:root:new node validate roc_auc, 0.8003
INFO:root:save model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 27, learning rate: 0.00011873813145868208, train loss: 0.3362
INFO:root:train average_precision, 0.9306
INFO:root:train roc_auc, 0.9277
INFO:root:validate loss: 0.4295
INFO:root:validate average_precision, 0.8826
INFO:root:validate roc_auc, 0.8836
INFO:root:new node validate loss: 0.5981
INFO:root:new node validate average_precision, 0.8343
INFO:root:new node validate roc_auc, 0.8054
INFO:root:Epoch: 28, learning rate: 0.00018763066800447107, train loss: 0.3311
INFO:root:train average_precision, 0.9314
INFO:root:train roc_auc, 0.9290
INFO:root:validate loss: 0.4290
INFO:root:validate average_precision, 0.8854
INFO:root:validate roc_auc, 0.8859
INFO:root:new node validate loss: 0.5963
INFO:root:new node validate average_precision, 0.8335
INFO:root:new node validate roc_auc, 0.8049
INFO:root:save model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 29, learning rate: 0.0001929776485888243, train loss: 0.3265
INFO:root:train average_precision, 0.9337
INFO:root:train roc_auc, 0.9314
INFO:root:validate loss: 0.4361
INFO:root:validate average_precision, 0.8863
INFO:root:validate roc_auc, 0.8848
INFO:root:new node validate loss: 0.6201
INFO:root:new node validate average_precision, 0.8306
INFO:root:new node validate roc_auc, 0.7995
INFO:root:Epoch: 30, learning rate: 0.00013090169943767154, train loss: 0.3238
INFO:root:train average_precision, 0.9349
INFO:root:train roc_auc, 0.9322
INFO:root:validate loss: 0.4262
INFO:root:validate average_precision, 0.8860
INFO:root:validate roc_auc, 0.8855
INFO:root:new node validate loss: 0.5953
INFO:root:new node validate average_precision, 0.8347
INFO:root:new node validate roc_auc, 0.8051
INFO:root:test loss: 0.4014
INFO:root:test average_precision, 0.9152
INFO:root:test roc_auc, 0.9131
INFO:root:new node test loss: 0.5199
INFO:root:new node test average_precision, 0.8611
INFO:root:new node test roc_auc, 0.8499
INFO:root:Epoch: 31, learning rate: 4.641732050214138e-05, train loss: 0.3252
INFO:root:train average_precision, 0.9346
INFO:root:train roc_auc, 0.9318
INFO:root:validate loss: 0.4176
INFO:root:validate average_precision, 0.8863
INFO:root:validate roc_auc, 0.8849
INFO:root:new node validate loss: 0.5545
INFO:root:new node validate average_precision, 0.8305
INFO:root:new node validate roc_auc, 0.8015
INFO:root:Epoch: 32, learning rate: 7.885298685523453e-07, train loss: 0.3215
INFO:root:train average_precision, 0.9366
INFO:root:train roc_auc, 0.9332
INFO:root:validate loss: 0.4154
INFO:root:validate average_precision, 0.8901
INFO:root:validate roc_auc, 0.8888
INFO:root:new node validate loss: 0.5789
INFO:root:new node validate average_precision, 0.8369
INFO:root:new node validate roc_auc, 0.8071
INFO:root:save model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 33, learning rate: 2.7103137257871025e-05, train loss: 0.3303
INFO:root:train average_precision, 0.9338
INFO:root:train roc_auc, 0.9308
INFO:root:validate loss: 0.4212
INFO:root:validate average_precision, 0.8823
INFO:root:validate roc_auc, 0.8817
INFO:root:new node validate loss: 0.5677
INFO:root:new node validate average_precision, 0.8370
INFO:root:new node validate roc_auc, 0.8069
INFO:root:Epoch: 34, learning rate: 0.00010627905195293237, train loss: 0.3320
INFO:root:train average_precision, 0.9338
INFO:root:train roc_auc, 0.9306
INFO:root:validate loss: 0.4259
INFO:root:validate average_precision, 0.8865
INFO:root:validate roc_auc, 0.8877
INFO:root:new node validate loss: 0.5989
INFO:root:new node validate average_precision, 0.8404
INFO:root:new node validate roc_auc, 0.8141
INFO:root:Epoch: 35, learning rate: 0.00018090169943741467, train loss: 0.3266
INFO:root:train average_precision, 0.9331
INFO:root:train roc_auc, 0.9308
INFO:root:validate loss: 0.4284
INFO:root:validate average_precision, 0.8875
INFO:root:validate roc_auc, 0.8880
INFO:root:new node validate loss: 0.6190
INFO:root:new node validate average_precision, 0.8440
INFO:root:new node validate roc_auc, 0.8172
INFO:root:Epoch: 36, learning rate: 0.00019685831611304034, train loss: 0.3234
INFO:root:train average_precision, 0.9365
INFO:root:train roc_auc, 0.9329
INFO:root:validate loss: 0.4375
INFO:root:validate average_precision, 0.8797
INFO:root:validate roc_auc, 0.8799
INFO:root:new node validate loss: 0.6179
INFO:root:new node validate average_precision, 0.8378
INFO:root:new node validate roc_auc, 0.8092
INFO:root:Epoch: 37, learning rate: 0.00014257792915657063, train loss: 0.3224
INFO:root:train average_precision, 0.9365
INFO:root:train roc_auc, 0.9330
INFO:root:validate loss: 0.4468
INFO:root:validate average_precision, 0.8846
INFO:root:validate roc_auc, 0.8842
INFO:root:new node validate loss: 0.6333
INFO:root:new node validate average_precision, 0.8448
INFO:root:new node validate roc_auc, 0.8154
INFO:root:Epoch: 38, learning rate: 5.742207084349114e-05, train loss: 0.3213
INFO:root:train average_precision, 0.9370
INFO:root:train roc_auc, 0.9333
INFO:root:validate loss: 0.4156
INFO:root:validate average_precision, 0.8876
INFO:root:validate roc_auc, 0.8862
INFO:root:new node validate loss: 0.5702
INFO:root:new node validate average_precision, 0.8444
INFO:root:new node validate roc_auc, 0.8157
INFO:root:Epoch: 39, learning rate: 3.1416838871355007e-06, train loss: 0.3170
INFO:root:train average_precision, 0.9385
INFO:root:train roc_auc, 0.9351
INFO:root:validate loss: 0.4263
INFO:root:validate average_precision, 0.8940
INFO:root:validate roc_auc, 0.8914
INFO:root:new node validate loss: 0.6166
INFO:root:new node validate average_precision, 0.8486
INFO:root:new node validate roc_auc, 0.8201
INFO:root:save model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 40, learning rate: 1.909830056249714e-05, train loss: 0.3163
INFO:root:train average_precision, 0.9398
INFO:root:train roc_auc, 0.9365
INFO:root:validate loss: 0.4137
INFO:root:validate average_precision, 0.8897
INFO:root:validate roc_auc, 0.8886
INFO:root:new node validate loss: 0.5892
INFO:root:new node validate average_precision, 0.8449
INFO:root:new node validate roc_auc, 0.8165
INFO:root:test loss: 0.3826
INFO:root:test average_precision, 0.9150
INFO:root:test roc_auc, 0.9139
INFO:root:new node test loss: 0.4994
INFO:root:new node test average_precision, 0.8700
INFO:root:new node test roc_auc, 0.8581
INFO:root:Epoch: 41, learning rate: 9.37209480470043e-05, train loss: 0.3210
INFO:root:train average_precision, 0.9373
INFO:root:train roc_auc, 0.9345
INFO:root:validate loss: 0.4308
INFO:root:validate average_precision, 0.8890
INFO:root:validate roc_auc, 0.8884
INFO:root:new node validate loss: 0.6317
INFO:root:new node validate average_precision, 0.8485
INFO:root:new node validate roc_auc, 0.8215
INFO:root:Epoch: 42, learning rate: 0.00017289686274194672, train loss: 0.3211
INFO:root:train average_precision, 0.9358
INFO:root:train roc_auc, 0.9333
INFO:root:validate loss: 0.4323
INFO:root:validate average_precision, 0.8875
INFO:root:validate roc_auc, 0.8879
INFO:root:new node validate loss: 0.6156
INFO:root:new node validate average_precision, 0.8479
INFO:root:new node validate roc_auc, 0.8222
INFO:root:Epoch: 43, learning rate: 0.00019921147013185085, train loss: 0.3199
INFO:root:train average_precision, 0.9373
INFO:root:train roc_auc, 0.9343
INFO:root:validate loss: 0.4402
INFO:root:validate average_precision, 0.8826
INFO:root:validate roc_auc, 0.8814
INFO:root:new node validate loss: 0.6294
INFO:root:new node validate average_precision, 0.8412
INFO:root:new node validate roc_auc, 0.8138
INFO:root:Epoch: 44, learning rate: 0.0001535826794981424, train loss: 0.3181
INFO:root:train average_precision, 0.9369
INFO:root:train roc_auc, 0.9341
INFO:root:validate loss: 0.4381
INFO:root:validate average_precision, 0.8933
INFO:root:validate roc_auc, 0.8917
INFO:root:new node validate loss: 0.6415
INFO:root:new node validate average_precision, 0.8433
INFO:root:new node validate roc_auc, 0.8160
INFO:root:Epoch: 45, learning rate: 6.909830056258304e-05, train loss: 0.3167
INFO:root:train average_precision, 0.9389
INFO:root:train roc_auc, 0.9354
INFO:root:validate loss: 0.4206
INFO:root:validate average_precision, 0.8927
INFO:root:validate roc_auc, 0.8909
INFO:root:new node validate loss: 0.5987
INFO:root:new node validate average_precision, 0.8494
INFO:root:new node validate roc_auc, 0.8220
INFO:root:Epoch: 46, learning rate: 7.022351411178251e-06, train loss: 0.3164
INFO:root:train average_precision, 0.9379
INFO:root:train roc_auc, 0.9353
INFO:root:validate loss: 0.4439
INFO:root:validate average_precision, 0.8918
INFO:root:validate roc_auc, 0.8900
INFO:root:new node validate loss: 0.6394
INFO:root:new node validate average_precision, 0.8421
INFO:root:new node validate roc_auc, 0.8137
INFO:root:Epoch: 47, learning rate: 1.2369331995621503e-05, train loss: 0.3126
INFO:root:train average_precision, 0.9403
INFO:root:train roc_auc, 0.9373
INFO:root:validate loss: 0.4165
INFO:root:validate average_precision, 0.8921
INFO:root:validate roc_auc, 0.8910
INFO:root:new node validate loss: 0.6102
INFO:root:new node validate average_precision, 0.8416
INFO:root:new node validate roc_auc, 0.8151
INFO:root:Epoch: 48, learning rate: 8.126186854144578e-05, train loss: 0.3181
INFO:root:train average_precision, 0.9387
INFO:root:train roc_auc, 0.9357
INFO:root:validate loss: 0.4242
INFO:root:validate average_precision, 0.8943
INFO:root:validate roc_auc, 0.8925
INFO:root:new node validate loss: 0.6249
INFO:root:new node validate average_precision, 0.8507
INFO:root:new node validate roc_auc, 0.8240
INFO:root:save model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 49, learning rate: 0.00016374239897483278, train loss: 0.3117
INFO:root:train average_precision, 0.9398
INFO:root:train roc_auc, 0.9372
INFO:root:validate loss: 0.4534
INFO:root:validate average_precision, 0.8864
INFO:root:validate roc_auc, 0.8860
INFO:root:new node validate loss: 0.6707
INFO:root:new node validate average_precision, 0.8446
INFO:root:new node validate roc_auc, 0.8174
INFO:root:Epoch: 50, learning rate: 0.00020000000000022514, train loss: 0.3171
INFO:root:train average_precision, 0.9375
INFO:root:train roc_auc, 0.9350
INFO:root:validate loss: 0.4324
INFO:root:validate average_precision, 0.8884
INFO:root:validate roc_auc, 0.8857
INFO:root:new node validate loss: 0.6104
INFO:root:new node validate average_precision, 0.8347
INFO:root:new node validate roc_auc, 0.8084
INFO:root:test loss: 0.4083
INFO:root:test average_precision, 0.9234
INFO:root:test roc_auc, 0.9211
INFO:root:new node test loss: 0.5442
INFO:root:new node test average_precision, 0.8732
INFO:root:new node test roc_auc, 0.8613
INFO:root:Epoch: 51, learning rate: 0.00016374239897527237, train loss: 0.3135
INFO:root:train average_precision, 0.9395
INFO:root:train roc_auc, 0.9366
INFO:root:validate loss: 0.4720
INFO:root:validate average_precision, 0.8891
INFO:root:validate roc_auc, 0.8893
INFO:root:new node validate loss: 0.6651
INFO:root:new node validate average_precision, 0.8537
INFO:root:new node validate roc_auc, 0.8297
INFO:root:Epoch: 52, learning rate: 8.126186854144786e-05, train loss: 0.3126
INFO:root:train average_precision, 0.9407
INFO:root:train roc_auc, 0.9374
INFO:root:validate loss: 0.4269
INFO:root:validate average_precision, 0.8913
INFO:root:validate roc_auc, 0.8890
INFO:root:new node validate loss: 0.5989
INFO:root:new node validate average_precision, 0.8422
INFO:root:new node validate roc_auc, 0.8153
INFO:root:Epoch: 53, learning rate: 1.236933199563365e-05, train loss: 0.3104
INFO:root:train average_precision, 0.9413
INFO:root:train roc_auc, 0.9384
INFO:root:validate loss: 0.4516
INFO:root:validate average_precision, 0.8928
INFO:root:validate roc_auc, 0.8924
INFO:root:new node validate loss: 0.6695
INFO:root:new node validate average_precision, 0.8548
INFO:root:new node validate roc_auc, 0.8289
INFO:root:Epoch: 54, learning rate: 7.022351411187958e-06, train loss: 0.3084
INFO:root:train average_precision, 0.9420
INFO:root:train roc_auc, 0.9393
INFO:root:validate loss: 0.4149
INFO:root:validate average_precision, 0.8975
INFO:root:validate roc_auc, 0.8953
INFO:root:new node validate loss: 0.6196
INFO:root:new node validate average_precision, 0.8546
INFO:root:new node validate roc_auc, 0.8275
INFO:root:save model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 55, learning rate: 6.909830056245937e-05, train loss: 0.3114
INFO:root:train average_precision, 0.9419
INFO:root:train roc_auc, 0.9385
INFO:root:validate loss: 0.4294
INFO:root:validate average_precision, 0.8911
INFO:root:validate roc_auc, 0.8899
INFO:root:new node validate loss: 0.6424
INFO:root:new node validate average_precision, 0.8513
INFO:root:new node validate roc_auc, 0.8256
INFO:root:Epoch: 56, learning rate: 0.00015358267949800475, train loss: 0.3092
INFO:root:train average_precision, 0.9409
INFO:root:train roc_auc, 0.9384
INFO:root:validate loss: 0.4357
INFO:root:validate average_precision, 0.8927
INFO:root:validate roc_auc, 0.8909
INFO:root:new node validate loss: 0.6392
INFO:root:new node validate average_precision, 0.8532
INFO:root:new node validate roc_auc, 0.8278
INFO:root:Epoch: 57, learning rate: 0.00019921147013189584, train loss: 0.3041
INFO:root:train average_precision, 0.9434
INFO:root:train roc_auc, 0.9401
INFO:root:validate loss: 0.4472
INFO:root:validate average_precision, 0.8912
INFO:root:validate roc_auc, 0.8882
INFO:root:new node validate loss: 0.6432
INFO:root:new node validate average_precision, 0.8461
INFO:root:new node validate roc_auc, 0.8223
INFO:root:Epoch: 58, learning rate: 0.0001728968627421386, train loss: 0.3068
INFO:root:train average_precision, 0.9424
INFO:root:train roc_auc, 0.9390
INFO:root:validate loss: 0.4635
INFO:root:validate average_precision, 0.8933
INFO:root:validate roc_auc, 0.8915
INFO:root:new node validate loss: 0.6740
INFO:root:new node validate average_precision, 0.8496
INFO:root:new node validate roc_auc, 0.8251
INFO:root:Epoch: 59, learning rate: 9.372094804719067e-05, train loss: 0.3074
INFO:root:train average_precision, 0.9425
INFO:root:train roc_auc, 0.9389
INFO:root:validate loss: 0.4205
INFO:root:validate average_precision, 0.8903
INFO:root:validate roc_auc, 0.8876
INFO:root:new node validate loss: 0.5976
INFO:root:new node validate average_precision, 0.8354
INFO:root:new node validate roc_auc, 0.8067
INFO:root:Epoch: 60, learning rate: 1.9098300562488166e-05, train loss: 0.3029
INFO:root:train average_precision, 0.9436
INFO:root:train roc_auc, 0.9406
INFO:root:validate loss: 0.4404
INFO:root:validate average_precision, 0.8938
INFO:root:validate roc_auc, 0.8920
INFO:root:new node validate loss: 0.6783
INFO:root:new node validate average_precision, 0.8517
INFO:root:new node validate roc_auc, 0.8256
INFO:root:test loss: 0.4457
INFO:root:test average_precision, 0.9165
INFO:root:test roc_auc, 0.9154
INFO:root:new node test loss: 0.6333
INFO:root:new node test average_precision, 0.8759
INFO:root:new node test roc_auc, 0.8656
INFO:root:Epoch: 61, learning rate: 3.1416838871342586e-06, train loss: 0.3054
INFO:root:train average_precision, 0.9425
INFO:root:train roc_auc, 0.9397
INFO:root:validate loss: 0.4206
INFO:root:validate average_precision, 0.8916
INFO:root:validate roc_auc, 0.8921
INFO:root:new node validate loss: 0.6112
INFO:root:new node validate average_precision, 0.8508
INFO:root:new node validate roc_auc, 0.8262
INFO:root:Epoch: 62, learning rate: 5.7422070843520144e-05, train loss: 0.3035
INFO:root:train average_precision, 0.9435
INFO:root:train roc_auc, 0.9412
INFO:root:validate loss: 0.4268
INFO:root:validate average_precision, 0.8921
INFO:root:validate roc_auc, 0.8898
INFO:root:new node validate loss: 0.6379
INFO:root:new node validate average_precision, 0.8504
INFO:root:new node validate roc_auc, 0.8240
INFO:root:Epoch: 63, learning rate: 0.00014257792915625287, train loss: 0.3030
INFO:root:train average_precision, 0.9439
INFO:root:train roc_auc, 0.9412
INFO:root:validate loss: 0.4386
INFO:root:validate average_precision, 0.8905
INFO:root:validate roc_auc, 0.8898
INFO:root:new node validate loss: 0.6614
INFO:root:new node validate average_precision, 0.8414
INFO:root:new node validate roc_auc, 0.8144
INFO:root:Epoch: 64, learning rate: 0.00019685831611277526, train loss: 0.3030
INFO:root:train average_precision, 0.9430
INFO:root:train roc_auc, 0.9409
INFO:root:validate loss: 0.4542
INFO:root:validate average_precision, 0.8897
INFO:root:validate roc_auc, 0.8883
INFO:root:new node validate loss: 0.6381
INFO:root:new node validate average_precision, 0.8461
INFO:root:new node validate roc_auc, 0.8242
INFO:root:Epoch: 65, learning rate: 0.00018090169943765484, train loss: 0.3104
INFO:root:train average_precision, 0.9418
INFO:root:train roc_auc, 0.9388
INFO:root:validate loss: 0.4258
INFO:root:validate average_precision, 0.8919
INFO:root:validate roc_auc, 0.8887
INFO:root:new node validate loss: 0.6211
INFO:root:new node validate average_precision, 0.8394
INFO:root:new node validate roc_auc, 0.8130
INFO:root:Epoch: 66, learning rate: 0.00010627905195278804, train loss: 0.3000
INFO:root:train average_precision, 0.9446
INFO:root:train roc_auc, 0.9415
INFO:root:validate loss: 0.4572
INFO:root:validate average_precision, 0.8908
INFO:root:validate roc_auc, 0.8890
INFO:root:new node validate loss: 0.6914
INFO:root:new node validate average_precision, 0.8435
INFO:root:new node validate roc_auc, 0.8134
INFO:root:Epoch: 67, learning rate: 2.7103137257955887e-05, train loss: 0.2973
INFO:root:train average_precision, 0.9462
INFO:root:train roc_auc, 0.9431
INFO:root:validate loss: 0.4109
INFO:root:validate average_precision, 0.8982
INFO:root:validate roc_auc, 0.8947
INFO:root:new node validate loss: 0.5818
INFO:root:new node validate average_precision, 0.8467
INFO:root:new node validate roc_auc, 0.8181
INFO:root:Epoch: 68, learning rate: 7.885298685552731e-07, train loss: 0.2963
INFO:root:train average_precision, 0.9466
INFO:root:train roc_auc, 0.9432
INFO:root:validate loss: 0.4330
INFO:root:validate average_precision, 0.8976
INFO:root:validate roc_auc, 0.8962
INFO:root:new node validate loss: 0.6498
INFO:root:new node validate average_precision, 0.8544
INFO:root:new node validate roc_auc, 0.8306
INFO:root:save model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 69, learning rate: 4.64173205021652e-05, train loss: 0.2958
INFO:root:train average_precision, 0.9464
INFO:root:train roc_auc, 0.9437
INFO:root:validate loss: 0.4123
INFO:root:validate average_precision, 0.9003
INFO:root:validate roc_auc, 0.8987
INFO:root:new node validate loss: 0.6377
INFO:root:new node validate average_precision, 0.8539
INFO:root:new node validate roc_auc, 0.8300
INFO:root:save model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 70, learning rate: 0.00013090169943785155, train loss: 0.2930
INFO:root:train average_precision, 0.9484
INFO:root:train roc_auc, 0.9457
INFO:root:validate loss: 0.4194
INFO:root:validate average_precision, 0.9046
INFO:root:validate roc_auc, 0.9021
INFO:root:new node validate loss: 0.6388
INFO:root:new node validate average_precision, 0.8448
INFO:root:new node validate roc_auc, 0.8182
INFO:root:test loss: 0.4292
INFO:root:test average_precision, 0.9299
INFO:root:test roc_auc, 0.9262
INFO:root:new node test loss: 0.6027
INFO:root:new node test average_precision, 0.8833
INFO:root:new node test roc_auc, 0.8698
INFO:root:save model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 71, learning rate: 0.0001929776485889137, train loss: 0.2884
INFO:root:train average_precision, 0.9494
INFO:root:train roc_auc, 0.9464
INFO:root:validate loss: 0.4201
INFO:root:validate average_precision, 0.9036
INFO:root:validate roc_auc, 0.9021
INFO:root:new node validate loss: 0.6310
INFO:root:new node validate average_precision, 0.8459
INFO:root:new node validate roc_auc, 0.8233
INFO:root:Epoch: 72, learning rate: 0.0001876306680047241, train loss: 0.2944
INFO:root:train average_precision, 0.9468
INFO:root:train roc_auc, 0.9444
INFO:root:validate loss: 0.5027
INFO:root:validate average_precision, 0.9056
INFO:root:validate roc_auc, 0.9044
INFO:root:new node validate loss: 0.7568
INFO:root:new node validate average_precision, 0.8460
INFO:root:new node validate roc_auc, 0.8104
INFO:root:save model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 73, learning rate: 0.00011873813145851827, train loss: 0.2957
INFO:root:train average_precision, 0.9476
INFO:root:train roc_auc, 0.9444
INFO:root:validate loss: 0.4042
INFO:root:validate average_precision, 0.9014
INFO:root:validate roc_auc, 0.8990
INFO:root:new node validate loss: 0.5981
INFO:root:new node validate average_precision, 0.8464
INFO:root:new node validate roc_auc, 0.8191
INFO:root:Epoch: 74, learning rate: 3.625760102517048e-05, train loss: 0.2906
INFO:root:train average_precision, 0.9491
INFO:root:train roc_auc, 0.9463
INFO:root:validate loss: 0.3848
INFO:root:validate average_precision, 0.9108
INFO:root:validate roc_auc, 0.9085
INFO:root:new node validate loss: 0.5760
INFO:root:new node validate average_precision, 0.8546
INFO:root:new node validate roc_auc, 0.8290
INFO:root:save model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 75, learning rate: 0.0, train loss: 0.2903
INFO:root:train average_precision, 0.9488
INFO:root:train roc_auc, 0.9458
INFO:root:validate loss: 0.3956
INFO:root:validate average_precision, 0.9100
INFO:root:validate roc_auc, 0.9082
INFO:root:new node validate loss: 0.6335
INFO:root:new node validate average_precision, 0.8537
INFO:root:new node validate roc_auc, 0.8272
INFO:root:Epoch: 76, learning rate: 3.625760102509302e-05, train loss: 0.2876
INFO:root:train average_precision, 0.9495
INFO:root:train roc_auc, 0.9467
INFO:root:validate loss: 0.4028
INFO:root:validate average_precision, 0.9066
INFO:root:validate roc_auc, 0.9057
INFO:root:new node validate loss: 0.6517
INFO:root:new node validate average_precision, 0.8467
INFO:root:new node validate roc_auc, 0.8224
INFO:root:Epoch: 77, learning rate: 0.00011873813145859789, train loss: 0.2932
INFO:root:train average_precision, 0.9473
INFO:root:train roc_auc, 0.9451
INFO:root:validate loss: 0.4059
INFO:root:validate average_precision, 0.9034
INFO:root:validate roc_auc, 0.9033
INFO:root:new node validate loss: 0.6595
INFO:root:new node validate average_precision, 0.8390
INFO:root:new node validate roc_auc, 0.8066
INFO:root:Epoch: 78, learning rate: 0.00018763066800468162, train loss: 0.2933
INFO:root:train average_precision, 0.9474
INFO:root:train roc_auc, 0.9451
INFO:root:validate loss: 0.4079
INFO:root:validate average_precision, 0.9098
INFO:root:validate roc_auc, 0.9083
INFO:root:new node validate loss: 0.6386
INFO:root:new node validate average_precision, 0.8482
INFO:root:new node validate roc_auc, 0.8166
INFO:root:Epoch: 79, learning rate: 0.00019297764858869463, train loss: 0.2863
INFO:root:train average_precision, 0.9502
INFO:root:train roc_auc, 0.9475
INFO:root:validate loss: 0.4047
INFO:root:validate average_precision, 0.9104
INFO:root:validate roc_auc, 0.9084
INFO:root:new node validate loss: 0.6250
INFO:root:new node validate average_precision, 0.8554
INFO:root:new node validate roc_auc, 0.8307
INFO:root:Epoch: 80, learning rate: 0.00013090169943758156, train loss: 0.2860
INFO:root:train average_precision, 0.9506
INFO:root:train roc_auc, 0.9477
INFO:root:validate loss: 0.4082
INFO:root:validate average_precision, 0.9103
INFO:root:validate roc_auc, 0.9076
INFO:root:new node validate loss: 0.6335
INFO:root:new node validate average_precision, 0.8532
INFO:root:new node validate roc_auc, 0.8258
INFO:root:test loss: 0.4326
INFO:root:test average_precision, 0.9375
INFO:root:test roc_auc, 0.9347
INFO:root:new node test loss: 0.5920
INFO:root:new node test average_precision, 0.8956
INFO:root:new node test roc_auc, 0.8845
INFO:root:Epoch: 81, learning rate: 4.641732050202497e-05, train loss: 0.2828
INFO:root:train average_precision, 0.9520
INFO:root:train roc_auc, 0.9486
INFO:root:validate loss: 0.3802
INFO:root:validate average_precision, 0.9165
INFO:root:validate roc_auc, 0.9129
INFO:root:new node validate loss: 0.5595
INFO:root:new node validate average_precision, 0.8641
INFO:root:new node validate roc_auc, 0.8392
INFO:root:save model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:Epoch: 82, learning rate: 7.885298685551401e-07, train loss: 0.2852
INFO:root:train average_precision, 0.9498
INFO:root:train roc_auc, 0.9476
INFO:root:validate loss: 0.4373
INFO:root:validate average_precision, 0.9083
INFO:root:validate roc_auc, 0.9066
INFO:root:new node validate loss: 0.6576
INFO:root:new node validate average_precision, 0.8558
INFO:root:new node validate roc_auc, 0.8297
INFO:root:Epoch: 83, learning rate: 2.7103137257949535e-05, train loss: 0.2840
INFO:root:train average_precision, 0.9506
INFO:root:train roc_auc, 0.9483
INFO:root:validate loss: 0.4101
INFO:root:validate average_precision, 0.9120
INFO:root:validate roc_auc, 0.9093
INFO:root:new node validate loss: 0.6361
INFO:root:new node validate average_precision, 0.8581
INFO:root:new node validate roc_auc, 0.8315
INFO:root:Epoch: 84, learning rate: 0.00010627905195305074, train loss: 0.2826
INFO:root:train average_precision, 0.9514
INFO:root:train roc_auc, 0.9489
INFO:root:validate loss: 0.4068
INFO:root:validate average_precision, 0.9131
INFO:root:validate roc_auc, 0.9111
INFO:root:new node validate loss: 0.6428
INFO:root:new node validate average_precision, 0.8559
INFO:root:new node validate roc_auc, 0.8244
INFO:root:Epoch: 85, learning rate: 0.00018090169943794294, train loss: 0.2843
INFO:root:train average_precision, 0.9506
INFO:root:train roc_auc, 0.9482
INFO:root:validate loss: 0.4240
INFO:root:validate average_precision, 0.9098
INFO:root:validate roc_auc, 0.9085
INFO:root:new node validate loss: 0.6848
INFO:root:new node validate average_precision, 0.8443
INFO:root:new node validate roc_auc, 0.8189
INFO:root:Epoch: 86, learning rate: 0.0001968583161129072, train loss: 0.2821
INFO:root:train average_precision, 0.9518
INFO:root:train roc_auc, 0.9492
INFO:root:validate loss: 0.4471
INFO:root:validate average_precision, 0.9071
INFO:root:validate roc_auc, 0.9043
INFO:root:new node validate loss: 0.6961
INFO:root:new node validate average_precision, 0.8552
INFO:root:new node validate roc_auc, 0.8291
INFO:root:Epoch: 87, learning rate: 0.00014257792915672952, train loss: 0.2818
INFO:root:train average_precision, 0.9518
INFO:root:train roc_auc, 0.9489
INFO:root:validate loss: 0.4766
INFO:root:validate average_precision, 0.9081
INFO:root:validate roc_auc, 0.9064
INFO:root:new node validate loss: 0.6768
INFO:root:new node validate average_precision, 0.8619
INFO:root:new node validate roc_auc, 0.8358
INFO:root:Epoch: 88, learning rate: 5.742207084345588e-05, train loss: 0.2850
INFO:root:train average_precision, 0.9517
INFO:root:train roc_auc, 0.9486
INFO:root:validate loss: 0.3804
INFO:root:validate average_precision, 0.9116
INFO:root:validate roc_auc, 0.9087
INFO:root:new node validate loss: 0.5196
INFO:root:new node validate average_precision, 0.8612
INFO:root:new node validate roc_auc, 0.8380
INFO:root:Epoch: 89, learning rate: 3.141683887139303e-06, train loss: 0.2819
INFO:root:train average_precision, 0.9517
INFO:root:train roc_auc, 0.9491
INFO:root:validate loss: 0.4782
INFO:root:validate average_precision, 0.9115
INFO:root:validate roc_auc, 0.9104
INFO:root:new node validate loss: 0.6678
INFO:root:new node validate average_precision, 0.8679
INFO:root:new node validate roc_auc, 0.8435
INFO:root:Epoch: 90, learning rate: 1.9098300562518005e-05, train loss: 0.2819
INFO:root:train average_precision, 0.9513
INFO:root:train roc_auc, 0.9490
INFO:root:validate loss: 0.4064
INFO:root:validate average_precision, 0.9123
INFO:root:validate roc_auc, 0.9109
INFO:root:new node validate loss: 0.5924
INFO:root:new node validate average_precision, 0.8644
INFO:root:new node validate roc_auc, 0.8403
INFO:root:test loss: 0.4645
INFO:root:test average_precision, 0.9330
INFO:root:test roc_auc, 0.9295
INFO:root:new node test loss: 0.6384
INFO:root:new node test average_precision, 0.8920
INFO:root:new node test roc_auc, 0.8796
INFO:root:Epoch: 91, learning rate: 9.372094804728607e-05, train loss: 0.2816
INFO:root:train average_precision, 0.9518
INFO:root:train roc_auc, 0.9493
INFO:root:validate loss: 0.4021
INFO:root:validate average_precision, 0.9135
INFO:root:validate roc_auc, 0.9111
INFO:root:new node validate loss: 0.6041
INFO:root:new node validate average_precision, 0.8621
INFO:root:new node validate roc_auc, 0.8378
INFO:root:Epoch: 92, learning rate: 0.00017289686274214622, train loss: 0.2797
INFO:root:train average_precision, 0.9519
INFO:root:train roc_auc, 0.9496
INFO:root:validate loss: 0.4145
INFO:root:validate average_precision, 0.9093
INFO:root:validate roc_auc, 0.9071
INFO:root:new node validate loss: 0.6610
INFO:root:new node validate average_precision, 0.8623
INFO:root:new node validate roc_auc, 0.8369
INFO:root:Epoch: 93, learning rate: 0.00019921147013171706, train loss: 0.2802
INFO:root:train average_precision, 0.9513
INFO:root:train roc_auc, 0.9493
INFO:root:validate loss: 0.4261
INFO:root:validate average_precision, 0.9096
INFO:root:validate roc_auc, 0.9087
INFO:root:new node validate loss: 0.6123
INFO:root:new node validate average_precision, 0.8539
INFO:root:new node validate roc_auc, 0.8310
INFO:root:Epoch: 94, learning rate: 0.00015358267949776319, train loss: 0.2835
INFO:root:train average_precision, 0.9518
INFO:root:train roc_auc, 0.9488
INFO:root:validate loss: 0.4137
INFO:root:validate average_precision, 0.9108
INFO:root:validate roc_auc, 0.9081
INFO:root:new node validate loss: 0.6586
INFO:root:new node validate average_precision, 0.8498
INFO:root:new node validate roc_auc, 0.8236
INFO:root:Epoch: 95, learning rate: 6.909830056253745e-05, train loss: 0.2828
INFO:root:train average_precision, 0.9516
INFO:root:train roc_auc, 0.9489
INFO:root:validate loss: 0.4058
INFO:root:validate average_precision, 0.9143
INFO:root:validate roc_auc, 0.9127
INFO:root:new node validate loss: 0.5917
INFO:root:new node validate average_precision, 0.8693
INFO:root:new node validate roc_auc, 0.8440
INFO:root:Epoch: 96, learning rate: 7.022351411187594e-06, train loss: 0.2808
INFO:root:train average_precision, 0.9525
INFO:root:train roc_auc, 0.9498
INFO:root:validate loss: 0.4656
INFO:root:validate average_precision, 0.9108
INFO:root:validate roc_auc, 0.9100
INFO:root:new node validate loss: 0.6346
INFO:root:new node validate average_precision, 0.8746
INFO:root:new node validate roc_auc, 0.8542
INFO:root:Epoch: 97, learning rate: 1.2369331995636206e-05, train loss: 0.2832
INFO:root:train average_precision, 0.9509
INFO:root:train roc_auc, 0.9486
INFO:root:validate loss: 0.3933
INFO:root:validate average_precision, 0.9138
INFO:root:validate roc_auc, 0.9129
INFO:root:new node validate loss: 0.5953
INFO:root:new node validate average_precision, 0.8751
INFO:root:new node validate roc_auc, 0.8545
INFO:root:Epoch: 98, learning rate: 8.126186854168509e-05, train loss: 0.2837
INFO:root:train average_precision, 0.9512
INFO:root:train roc_auc, 0.9488
INFO:root:validate loss: 0.4166
INFO:root:validate average_precision, 0.9088
INFO:root:validate roc_auc, 0.9088
INFO:root:new node validate loss: 0.6664
INFO:root:new node validate average_precision, 0.8613
INFO:root:new node validate roc_auc, 0.8372
INFO:root:Epoch: 99, learning rate: 0.0001637423989756078, train loss: 0.2787
INFO:root:train average_precision, 0.9524
INFO:root:train roc_auc, 0.9502
INFO:root:validate loss: 0.4180
INFO:root:validate average_precision, 0.9106
INFO:root:validate roc_auc, 0.9096
INFO:root:new node validate loss: 0.6252
INFO:root:new node validate average_precision, 0.8584
INFO:root:new node validate roc_auc, 0.8347
INFO:root:Epoch: 100, learning rate: 0.0001999999999997302, train loss: 0.2839
INFO:root:train average_precision, 0.9510
INFO:root:train roc_auc, 0.9487
INFO:root:validate loss: 0.4087
INFO:root:validate average_precision, 0.9076
INFO:root:validate roc_auc, 0.9049
INFO:root:new node validate loss: 0.5911
INFO:root:new node validate average_precision, 0.8608
INFO:root:new node validate roc_auc, 0.8358
INFO:root:test loss: 0.4209
INFO:root:test average_precision, 0.9362
INFO:root:test roc_auc, 0.9338
INFO:root:new node test loss: 0.5572
INFO:root:new node test average_precision, 0.8984
INFO:root:new node test roc_auc, 0.8887
INFO:root:load model ./saved_models/TGN/uci/TGN_seed3/TGN_seed3.pkl
INFO:root:get final performance on dataset uci...
INFO:root:test loss: 0.4272
INFO:root:test average_precision, 0.9384
INFO:root:test roc_auc, 0.9359
INFO:root:new node test loss: 0.5754
INFO:root:new node test average_precision, 0.8976
INFO:root:new node test roc_auc, 0.8865
INFO:root:Run 4 cost 11418.21 seconds.
INFO:root:********** Run 5 starts. **********
INFO:root:configuration is Namespace(dataset_name='uci', batch_size=200, model_name='TGN', gpu=0, num_neighbors=10, sample_neighbor_strategy='recent', time_scaling_factor=1e-06, num_walk_heads=8, num_heads=2, num_layers=2, walk_length=1, time_gap=2000, time_feat_dim=100, position_feat_dim=172, edge_bank_memory_mode='unlimited_memory', time_window_mode='fixed_proportion', patch_size=200, channel_embedding_dim=50, max_input_sequence_length=64, learning_rate=0.0001, dropout=0.1, num_epochs=100, optimizer='Adam', weight_decay=0.0, patience=20, val_ratio=0.15, test_ratio=0.15, num_runs=5, test_interval_epochs=10, negative_sample_strategy='random', load_best_configs=False, device='cuda:0', seed=4, save_model_name='TGN_seed4')
INFO:root:model -> Sequential(
  (0): MemoryModel(
    (src_memory_encoder): Linear(in_features=172, out_features=172, bias=True)
    (dst_memory_encoder): Linear(in_features=172, out_features=172, bias=True)
    (edge_encoder): Linear(in_features=172, out_features=172, bias=True)
    (channel_attention): ChannelAttentionTemporal(
      (avg_pool): AdaptiveAvgPool1d(output_size=1)
      (max_pool): AdaptiveMaxPool1d(output_size=1)
      (fc1): Linear(in_features=4, out_features=0, bias=False)
      (relu1): ReLU()
      (fc2): Linear(in_features=0, out_features=4, bias=False)
      (sigmoid): Sigmoid()
    )
    (time_encoder): TimeEncoder(
      (w): Linear(in_features=1, out_features=100, bias=True)
    )
    (message_aggregator): MessageAggregator()
    (memory_bank): MemoryBank(num_nodes=1900, memory_dim=172)
    (memory_updater): CFCMemoryUpdater(
      (memory_bank): MemoryBank(num_nodes=1900, memory_dim=172)
      (memory_updater): MoE(
        (mixer): Linear(in_features=788, out_features=616, bias=True)
        (relu): ReLU(inplace=True)
        (experts): ModuleList(
          (0-2): 3 x rnnmodule(
            (cell): GRUCell(616, 172)
            (relu): ReLU()
          )
          (3-5): 3 x cfcmodule(
            (cell): cfcbundle(
              (rnn_cell): CfCCell(
                (backbone): Sequential(
                  (0): Linear(in_features=788, out_features=128, bias=True)
                  (1): LeCun(
                    (tanh): Tanh()
                  )
                )
                (tanh): Tanh()
                (sigmoid): Sigmoid()
                (ff1): Linear(in_features=128, out_features=172, bias=True)
                (ff2): Linear(in_features=128, out_features=172, bias=True)
                (time_a): Linear(in_features=128, out_features=172, bias=True)
                (time_b): Linear(in_features=128, out_features=172, bias=True)
              )
              (leaky_factor): Linear(in_features=616, out_features=172, bias=True)
            )
            (relu): ReLU()
          )
        )
        (softplus): Softplus(beta=1.0, threshold=20.0)
        (softmax): Softmax(dim=1)
      )
    )
    (embedding_module): GraphAttentionEmbedding(
      (time_encoder): TimeEncoder(
        (w): Linear(in_features=1, out_features=100, bias=True)
      )
      (temporal_conv_layers): ModuleList(
        (0-1): 2 x MultiHeadAttention(
          (query_projection): Linear(in_features=272, out_features=272, bias=False)
          (key_projection): Linear(in_features=444, out_features=272, bias=False)
          (value_projection): Linear(in_features=444, out_features=272, bias=False)
          (layer_norm): LayerNorm((272,), eps=1e-05, elementwise_affine=True)
          (residual_fc): Linear(in_features=272, out_features=272, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
      (merge_layers): ModuleList(
        (0-1): 2 x MergeLayer(
          (fc1): Linear(in_features=444, out_features=172, bias=True)
          (fc2): Linear(in_features=172, out_features=172, bias=True)
          (act): ReLU()
        )
      )
    )
  )
  (1): MergeLayer(
    (fc1): Linear(in_features=344, out_features=172, bias=True)
    (fc2): Linear(in_features=172, out_features=1, bias=True)
    (act): ReLU()
  )
)
INFO:root:model name: TGN, #parameters: 14984612 B, 14633.41015625 KB, 14.29043960571289 MB.
INFO:root:Epoch: 1, learning rate: 0.00016374239897486902, train loss: 0.4410
INFO:root:train average_precision, 0.8927
INFO:root:train roc_auc, 0.8842
INFO:root:validate loss: 0.4963
INFO:root:validate average_precision, 0.8433
INFO:root:validate roc_auc, 0.8271
INFO:root:new node validate loss: 0.5822
INFO:root:new node validate average_precision, 0.7859
INFO:root:new node validate roc_auc, 0.7418
INFO:root:save model ./saved_models/TGN/uci/TGN_seed4/TGN_seed4.pkl
INFO:root:Epoch: 2, learning rate: 8.126186854142736e-05, train loss: 0.3934
INFO:root:train average_precision, 0.9078
INFO:root:train roc_auc, 0.9002
INFO:root:validate loss: 0.5000
INFO:root:validate average_precision, 0.8333
INFO:root:validate roc_auc, 0.8201
INFO:root:new node validate loss: 0.5951
INFO:root:new node validate average_precision, 0.7804
INFO:root:new node validate roc_auc, 0.7383
INFO:root:Epoch: 3, learning rate: 1.2369331995613646e-05, train loss: 0.3812
INFO:root:train average_precision, 0.9100
INFO:root:train roc_auc, 0.9045
INFO:root:validate loss: 0.4969
INFO:root:validate average_precision, 0.8317
INFO:root:validate roc_auc, 0.8228
INFO:root:new node validate loss: 0.5872
INFO:root:new node validate average_precision, 0.7756
INFO:root:new node validate roc_auc, 0.7389
INFO:root:Epoch: 4, learning rate: 7.022351411174938e-06, train loss: 0.3782
INFO:root:train average_precision, 0.9128
INFO:root:train roc_auc, 0.9087
INFO:root:validate loss: 0.4902
INFO:root:validate average_precision, 0.8383
INFO:root:validate roc_auc, 0.8298
INFO:root:new node validate loss: 0.5766
INFO:root:new node validate average_precision, 0.7819
INFO:root:new node validate roc_auc, 0.7442
INFO:root:Epoch: 5, learning rate: 6.909830056248985e-05, train loss: 0.3769
INFO:root:train average_precision, 0.9169
INFO:root:train roc_auc, 0.9116
INFO:root:validate loss: 0.4899
INFO:root:validate average_precision, 0.8377
INFO:root:validate roc_auc, 0.8272
INFO:root:new node validate loss: 0.6009
INFO:root:new node validate average_precision, 0.7665
INFO:root:new node validate roc_auc, 0.7187
INFO:root:Epoch: 6, learning rate: 0.00015358267949790012, train loss: 0.3748
INFO:root:train average_precision, 0.9136
INFO:root:train roc_auc, 0.9083
INFO:root:validate loss: 0.4791
INFO:root:validate average_precision, 0.8469
INFO:root:validate roc_auc, 0.8375
INFO:root:new node validate loss: 0.6023
INFO:root:new node validate average_precision, 0.7738
INFO:root:new node validate roc_auc, 0.7287
INFO:root:save model ./saved_models/TGN/uci/TGN_seed4/TGN_seed4.pkl
INFO:root:Epoch: 7, learning rate: 0.00019921147013149252, train loss: 0.3686
INFO:root:train average_precision, 0.9166
INFO:root:train roc_auc, 0.9115
INFO:root:validate loss: 0.4715
INFO:root:validate average_precision, 0.8520
INFO:root:validate roc_auc, 0.8452
INFO:root:new node validate loss: 0.5984
INFO:root:new node validate average_precision, 0.7814
INFO:root:new node validate roc_auc, 0.7401
INFO:root:save model ./saved_models/TGN/uci/TGN_seed4/TGN_seed4.pkl
INFO:root:Epoch: 8, learning rate: 0.00017289686274217977, train loss: 0.3599
INFO:root:train average_precision, 0.9215
INFO:root:train roc_auc, 0.9157
INFO:root:validate loss: 0.4769
INFO:root:validate average_precision, 0.8486
INFO:root:validate roc_auc, 0.8400
INFO:root:new node validate loss: 0.6005
INFO:root:new node validate average_precision, 0.7807
INFO:root:new node validate roc_auc, 0.7402
INFO:root:Epoch: 9, learning rate: 9.372094804704758e-05, train loss: 0.3637
INFO:root:train average_precision, 0.9192
INFO:root:train roc_auc, 0.9140
INFO:root:validate loss: 0.4764
INFO:root:validate average_precision, 0.8481
INFO:root:validate roc_auc, 0.8412
INFO:root:new node validate loss: 0.5936
INFO:root:new node validate average_precision, 0.7761
INFO:root:new node validate roc_auc, 0.7361
INFO:root:Epoch: 10, learning rate: 1.9098300562509427e-05, train loss: 0.3600
INFO:root:train average_precision, 0.9209
INFO:root:train roc_auc, 0.9152
INFO:root:validate loss: 0.4765
INFO:root:validate average_precision, 0.8477
INFO:root:validate roc_auc, 0.8408
INFO:root:new node validate loss: 0.5860
INFO:root:new node validate average_precision, 0.7897
INFO:root:new node validate roc_auc, 0.7506
INFO:root:test loss: 0.4650
INFO:root:test average_precision, 0.8567
INFO:root:test roc_auc, 0.8533
INFO:root:new node test loss: 0.5254
INFO:root:new node test average_precision, 0.8104
INFO:root:new node test roc_auc, 0.7924
INFO:root:Epoch: 11, learning rate: 3.1416838871375353e-06, train loss: 0.3602
INFO:root:train average_precision, 0.9214
INFO:root:train roc_auc, 0.9160
INFO:root:validate loss: 0.4816
INFO:root:validate average_precision, 0.8412
INFO:root:validate roc_auc, 0.8374
INFO:root:new node validate loss: 0.5979
INFO:root:new node validate average_precision, 0.7783
INFO:root:new node validate roc_auc, 0.7369
INFO:root:Epoch: 12, learning rate: 5.742207084350565e-05, train loss: 0.3599
INFO:root:train average_precision, 0.9212
INFO:root:train roc_auc, 0.9170
INFO:root:validate loss: 0.4694
INFO:root:validate average_precision, 0.8494
INFO:root:validate roc_auc, 0.8460
INFO:root:new node validate loss: 0.5966
INFO:root:new node validate average_precision, 0.7904
INFO:root:new node validate roc_auc, 0.7526
INFO:root:Epoch: 13, learning rate: 0.00014257792915647467, train loss: 0.3544
INFO:root:train average_precision, 0.9231
INFO:root:train roc_auc, 0.9195
INFO:root:validate loss: 0.4431
INFO:root:validate average_precision, 0.8689
INFO:root:validate roc_auc, 0.8678
INFO:root:new node validate loss: 0.5918
INFO:root:new node validate average_precision, 0.7919
INFO:root:new node validate roc_auc, 0.7563
INFO:root:save model ./saved_models/TGN/uci/TGN_seed4/TGN_seed4.pkl
INFO:root:Epoch: 14, learning rate: 0.00019685831611290764, train loss: 0.3523
INFO:root:train average_precision, 0.9236
INFO:root:train roc_auc, 0.9201
INFO:root:validate loss: 0.4707
INFO:root:validate average_precision, 0.8489
INFO:root:validate roc_auc, 0.8444
INFO:root:new node validate loss: 0.5892
INFO:root:new node validate average_precision, 0.7899
INFO:root:new node validate roc_auc, 0.7524
INFO:root:Epoch: 15, learning rate: 0.0001809016994376168, train loss: 0.3510
INFO:root:train average_precision, 0.9234
INFO:root:train roc_auc, 0.9199
INFO:root:validate loss: 0.4359
INFO:root:validate average_precision, 0.8737
INFO:root:validate roc_auc, 0.8742
INFO:root:new node validate loss: 0.5768
INFO:root:new node validate average_precision, 0.8060
INFO:root:new node validate roc_auc, 0.7744
INFO:root:save model ./saved_models/TGN/uci/TGN_seed4/TGN_seed4.pkl
INFO:root:Epoch: 16, learning rate: 0.00010627905195295439, train loss: 0.3436
INFO:root:train average_precision, 0.9266
INFO:root:train roc_auc, 0.9236
INFO:root:validate loss: 0.4436
INFO:root:validate average_precision, 0.8676
INFO:root:validate roc_auc, 0.8645
INFO:root:new node validate loss: 0.5715
INFO:root:new node validate average_precision, 0.8007
INFO:root:new node validate roc_auc, 0.7666
INFO:root:Epoch: 17, learning rate: 2.7103137257852454e-05, train loss: 0.3400
INFO:root:train average_precision, 0.9285
INFO:root:train roc_auc, 0.9251
INFO:root:validate loss: 0.4440
INFO:root:validate average_precision, 0.8667
INFO:root:validate roc_auc, 0.8652
INFO:root:new node validate loss: 0.5851
INFO:root:new node validate average_precision, 0.7944
INFO:root:new node validate roc_auc, 0.7621
INFO:root:Epoch: 18, learning rate: 7.885298685520349e-07, train loss: 0.3408
INFO:root:train average_precision, 0.9281
INFO:root:train roc_auc, 0.9253
INFO:root:validate loss: 0.4454
INFO:root:validate average_precision, 0.8644
INFO:root:validate roc_auc, 0.8635
INFO:root:new node validate loss: 0.5788
INFO:root:new node validate average_precision, 0.8017
INFO:root:new node validate roc_auc, 0.7675
INFO:root:Epoch: 19, learning rate: 4.641732050211155e-05, train loss: 0.3423
INFO:root:train average_precision, 0.9283
INFO:root:train roc_auc, 0.9252
INFO:root:validate loss: 0.4445
INFO:root:validate average_precision, 0.8652
INFO:root:validate roc_auc, 0.8683
INFO:root:new node validate loss: 0.6126
INFO:root:new node validate average_precision, 0.8007
INFO:root:new node validate roc_auc, 0.7691
INFO:root:Epoch: 20, learning rate: 0.00013090169943758345, train loss: 0.3416
INFO:root:train average_precision, 0.9274
INFO:root:train roc_auc, 0.9248
INFO:root:validate loss: 0.4246
INFO:root:validate average_precision, 0.8835
INFO:root:validate roc_auc, 0.8840
INFO:root:new node validate loss: 0.5726
INFO:root:new node validate average_precision, 0.8220
INFO:root:new node validate roc_auc, 0.7955
INFO:root:test loss: 0.4206
INFO:root:test average_precision, 0.9001
INFO:root:test roc_auc, 0.9016
INFO:root:new node test loss: 0.5430
INFO:root:new node test average_precision, 0.8461
INFO:root:new node test roc_auc, 0.8349
INFO:root:save model ./saved_models/TGN/uci/TGN_seed4/TGN_seed4.pkl
INFO:root:Epoch: 21, learning rate: 0.0001929776485888686, train loss: 0.3362
INFO:root:train average_precision, 0.9298
INFO:root:train roc_auc, 0.9269
INFO:root:validate loss: 0.4391
INFO:root:validate average_precision, 0.8733
INFO:root:validate roc_auc, 0.8751
INFO:root:new node validate loss: 0.5864
INFO:root:new node validate average_precision, 0.8139
INFO:root:new node validate roc_auc, 0.7844
INFO:root:Epoch: 22, learning rate: 0.00018763066800434467, train loss: 0.3363
INFO:root:train average_precision, 0.9289
INFO:root:train roc_auc, 0.9264
INFO:root:validate loss: 0.4527
INFO:root:validate average_precision, 0.8793
INFO:root:validate roc_auc, 0.8800
INFO:root:new node validate loss: 0.6333
INFO:root:new node validate average_precision, 0.8112
INFO:root:new node validate roc_auc, 0.7812
INFO:root:Epoch: 23, learning rate: 0.00011873813145862399, train loss: 0.3355
INFO:root:train average_precision, 0.9301
INFO:root:train roc_auc, 0.9271
INFO:root:validate loss: 0.4434
INFO:root:validate average_precision, 0.8717
INFO:root:validate roc_auc, 0.8709
INFO:root:new node validate loss: 0.5931
INFO:root:new node validate average_precision, 0.8102
INFO:root:new node validate roc_auc, 0.7796
INFO:root:Epoch: 24, learning rate: 3.6257601025131094e-05, train loss: 0.3324
INFO:root:train average_precision, 0.9305
INFO:root:train roc_auc, 0.9288
INFO:root:validate loss: 0.4260
INFO:root:validate average_precision, 0.8786
INFO:root:validate roc_auc, 0.8789
INFO:root:new node validate loss: 0.5645
INFO:root:new node validate average_precision, 0.8127
INFO:root:new node validate roc_auc, 0.7837
INFO:root:Epoch: 25, learning rate: 0.0, train loss: 0.3301
INFO:root:train average_precision, 0.9319
INFO:root:train roc_auc, 0.9293
INFO:root:validate loss: 0.4309
INFO:root:validate average_precision, 0.8741
INFO:root:validate roc_auc, 0.8744
INFO:root:new node validate loss: 0.5864
INFO:root:new node validate average_precision, 0.8118
INFO:root:new node validate roc_auc, 0.7805
INFO:root:Epoch: 26, learning rate: 3.625760102511391e-05, train loss: 0.3310
INFO:root:train average_precision, 0.9327
INFO:root:train roc_auc, 0.9301
INFO:root:validate loss: 0.4213
INFO:root:validate average_precision, 0.8810
INFO:root:validate roc_auc, 0.8827
INFO:root:new node validate loss: 0.5932
INFO:root:new node validate average_precision, 0.8179
INFO:root:new node validate roc_auc, 0.7910
INFO:root:Epoch: 27, learning rate: 0.00011873813145868208, train loss: 0.3372
INFO:root:train average_precision, 0.9300
INFO:root:train roc_auc, 0.9277
INFO:root:validate loss: 0.4261
INFO:root:validate average_precision, 0.8837
INFO:root:validate roc_auc, 0.8846
INFO:root:new node validate loss: 0.5903
INFO:root:new node validate average_precision, 0.8223
INFO:root:new node validate roc_auc, 0.7958
INFO:root:save model ./saved_models/TGN/uci/TGN_seed4/TGN_seed4.pkl
INFO:root:Epoch: 28, learning rate: 0.00018763066800447107, train loss: 0.3319
INFO:root:train average_precision, 0.9309
INFO:root:train roc_auc, 0.9286
INFO:root:validate loss: 0.4380
INFO:root:validate average_precision, 0.8778
INFO:root:validate roc_auc, 0.8784
INFO:root:new node validate loss: 0.5921
INFO:root:new node validate average_precision, 0.8224
INFO:root:new node validate roc_auc, 0.7958
INFO:root:Epoch: 29, learning rate: 0.0001929776485888243, train loss: 0.3318
INFO:root:train average_precision, 0.9299
INFO:root:train roc_auc, 0.9285
INFO:root:validate loss: 0.4592
INFO:root:validate average_precision, 0.8798
INFO:root:validate roc_auc, 0.8825
INFO:root:new node validate loss: 0.6498
INFO:root:new node validate average_precision, 0.8153
INFO:root:new node validate roc_auc, 0.7887
INFO:root:Epoch: 30, learning rate: 0.00013090169943767154, train loss: 0.3318
INFO:root:train average_precision, 0.9309
INFO:root:train roc_auc, 0.9289
INFO:root:validate loss: 0.4390
INFO:root:validate average_precision, 0.8720
INFO:root:validate roc_auc, 0.8723
INFO:root:new node validate loss: 0.6163
INFO:root:new node validate average_precision, 0.8148
INFO:root:new node validate roc_auc, 0.7849
INFO:root:test loss: 0.4037
INFO:root:test average_precision, 0.9019
INFO:root:test roc_auc, 0.9007
INFO:root:new node test loss: 0.5092
INFO:root:new node test average_precision, 0.8521
INFO:root:new node test roc_auc, 0.8402
INFO:root:Epoch: 31, learning rate: 4.641732050214138e-05, train loss: 0.3296
INFO:root:train average_precision, 0.9314
INFO:root:train roc_auc, 0.9299
INFO:root:validate loss: 0.4223
INFO:root:validate average_precision, 0.8798
INFO:root:validate roc_auc, 0.8810
INFO:root:new node validate loss: 0.5734
INFO:root:new node validate average_precision, 0.8181
INFO:root:new node validate roc_auc, 0.7917
INFO:root:Epoch: 32, learning rate: 7.885298685523453e-07, train loss: 0.3235
INFO:root:train average_precision, 0.9343
INFO:root:train roc_auc, 0.9317
INFO:root:validate loss: 0.4237
INFO:root:validate average_precision, 0.8799
INFO:root:validate roc_auc, 0.8811
INFO:root:new node validate loss: 0.5838
INFO:root:new node validate average_precision, 0.8219
INFO:root:new node validate roc_auc, 0.7946
INFO:root:Epoch: 33, learning rate: 2.7103137257871025e-05, train loss: 0.3313
INFO:root:train average_precision, 0.9318
INFO:root:train roc_auc, 0.9302
INFO:root:validate loss: 0.4205
INFO:root:validate average_precision, 0.8821
INFO:root:validate roc_auc, 0.8829
INFO:root:new node validate loss: 0.5912
INFO:root:new node validate average_precision, 0.8283
INFO:root:new node validate roc_auc, 0.8012
INFO:root:Epoch: 34, learning rate: 0.00010627905195293237, train loss: 0.3337
INFO:root:train average_precision, 0.9316
INFO:root:train roc_auc, 0.9297
INFO:root:validate loss: 0.4186
INFO:root:validate average_precision, 0.8868
INFO:root:validate roc_auc, 0.8878
INFO:root:new node validate loss: 0.5697
INFO:root:new node validate average_precision, 0.8327
INFO:root:new node validate roc_auc, 0.8085
INFO:root:save model ./saved_models/TGN/uci/TGN_seed4/TGN_seed4.pkl
INFO:root:Epoch: 35, learning rate: 0.00018090169943741467, train loss: 0.3274
INFO:root:train average_precision, 0.9318
INFO:root:train roc_auc, 0.9306
INFO:root:validate loss: 0.4393
INFO:root:validate average_precision, 0.8861
INFO:root:validate roc_auc, 0.8863
INFO:root:new node validate loss: 0.6165
INFO:root:new node validate average_precision, 0.8337
INFO:root:new node validate roc_auc, 0.8086
INFO:root:Epoch: 36, learning rate: 0.00019685831611304034, train loss: 0.3255
INFO:root:train average_precision, 0.9339
INFO:root:train roc_auc, 0.9316
INFO:root:validate loss: 0.4446
INFO:root:validate average_precision, 0.8794
INFO:root:validate roc_auc, 0.8809
INFO:root:new node validate loss: 0.6110
INFO:root:new node validate average_precision, 0.8319
INFO:root:new node validate roc_auc, 0.8062
INFO:root:Epoch: 37, learning rate: 0.00014257792915657063, train loss: 0.3241
INFO:root:train average_precision, 0.9346
INFO:root:train roc_auc, 0.9322
INFO:root:validate loss: 0.4312
INFO:root:validate average_precision, 0.8882
INFO:root:validate roc_auc, 0.8882
INFO:root:new node validate loss: 0.6123
INFO:root:new node validate average_precision, 0.8419
INFO:root:new node validate roc_auc, 0.8146
INFO:root:save model ./saved_models/TGN/uci/TGN_seed4/TGN_seed4.pkl
INFO:root:Epoch: 38, learning rate: 5.742207084349114e-05, train loss: 0.3234
INFO:root:train average_precision, 0.9352
INFO:root:train roc_auc, 0.9328
INFO:root:validate loss: 0.4209
INFO:root:validate average_precision, 0.8822
INFO:root:validate roc_auc, 0.8822
INFO:root:new node validate loss: 0.5782
INFO:root:new node validate average_precision, 0.8291
INFO:root:new node validate roc_auc, 0.8020
INFO:root:Epoch: 39, learning rate: 3.1416838871355007e-06, train loss: 0.3186
INFO:root:train average_precision, 0.9371
INFO:root:train roc_auc, 0.9348
INFO:root:validate loss: 0.4360
INFO:root:validate average_precision, 0.8874
INFO:root:validate roc_auc, 0.8874
INFO:root:new node validate loss: 0.6123
INFO:root:new node validate average_precision, 0.8443
INFO:root:new node validate roc_auc, 0.8183
INFO:root:Epoch: 40, learning rate: 1.909830056249714e-05, train loss: 0.3213
INFO:root:train average_precision, 0.9372
INFO:root:train roc_auc, 0.9350
INFO:root:validate loss: 0.4179
INFO:root:validate average_precision, 0.8879
INFO:root:validate roc_auc, 0.8880
INFO:root:new node validate loss: 0.5949
INFO:root:new node validate average_precision, 0.8395
INFO:root:new node validate roc_auc, 0.8126
INFO:root:test loss: 0.3922
INFO:root:test average_precision, 0.9156
INFO:root:test roc_auc, 0.9144
INFO:root:new node test loss: 0.5235
INFO:root:new node test average_precision, 0.8649
INFO:root:new node test roc_auc, 0.8554
INFO:root:Epoch: 41, learning rate: 9.37209480470043e-05, train loss: 0.3278
INFO:root:train average_precision, 0.9358
INFO:root:train roc_auc, 0.9329
INFO:root:validate loss: 0.4221
INFO:root:validate average_precision, 0.8880
INFO:root:validate roc_auc, 0.8885
INFO:root:new node validate loss: 0.5873
INFO:root:new node validate average_precision, 0.8434
INFO:root:new node validate roc_auc, 0.8177
INFO:root:Epoch: 42, learning rate: 0.00017289686274194672, train loss: 0.3195
INFO:root:train average_precision, 0.9364
INFO:root:train roc_auc, 0.9340
INFO:root:validate loss: 0.4323
INFO:root:validate average_precision, 0.8941
INFO:root:validate roc_auc, 0.8925
INFO:root:new node validate loss: 0.6169
INFO:root:new node validate average_precision, 0.8449
INFO:root:new node validate roc_auc, 0.8191
INFO:root:save model ./saved_models/TGN/uci/TGN_seed4/TGN_seed4.pkl
INFO:root:Epoch: 43, learning rate: 0.00019921147013185085, train loss: 0.3184
INFO:root:train average_precision, 0.9372
INFO:root:train roc_auc, 0.9352
INFO:root:validate loss: 0.4402
INFO:root:validate average_precision, 0.8895
INFO:root:validate roc_auc, 0.8871
INFO:root:new node validate loss: 0.6131
INFO:root:new node validate average_precision, 0.8431
INFO:root:new node validate roc_auc, 0.8171
INFO:root:Epoch: 44, learning rate: 0.0001535826794981424, train loss: 0.3148
INFO:root:train average_precision, 0.9393
INFO:root:train roc_auc, 0.9361
INFO:root:validate loss: 0.4253
INFO:root:validate average_precision, 0.8892
INFO:root:validate roc_auc, 0.8875
INFO:root:new node validate loss: 0.5888
INFO:root:new node validate average_precision, 0.8526
INFO:root:new node validate roc_auc, 0.8256
INFO:root:Epoch: 45, learning rate: 6.909830056258304e-05, train loss: 0.3166
INFO:root:train average_precision, 0.9375
INFO:root:train roc_auc, 0.9350
INFO:root:validate loss: 0.4122
INFO:root:validate average_precision, 0.8934
INFO:root:validate roc_auc, 0.8909
INFO:root:new node validate loss: 0.5591
INFO:root:new node validate average_precision, 0.8406
INFO:root:new node validate roc_auc, 0.8163
INFO:root:Epoch: 46, learning rate: 7.022351411178251e-06, train loss: 0.3146
INFO:root:train average_precision, 0.9386
INFO:root:train roc_auc, 0.9355
INFO:root:validate loss: 0.4272
INFO:root:validate average_precision, 0.8902
INFO:root:validate roc_auc, 0.8890
INFO:root:new node validate loss: 0.6040
INFO:root:new node validate average_precision, 0.8349
INFO:root:new node validate roc_auc, 0.7999
INFO:root:Epoch: 47, learning rate: 1.2369331995621503e-05, train loss: 0.3142
INFO:root:train average_precision, 0.9387
INFO:root:train roc_auc, 0.9369
INFO:root:validate loss: 0.4145
INFO:root:validate average_precision, 0.8916
INFO:root:validate roc_auc, 0.8900
INFO:root:new node validate loss: 0.5940
INFO:root:new node validate average_precision, 0.8468
INFO:root:new node validate roc_auc, 0.8177
INFO:root:Epoch: 48, learning rate: 8.126186854144578e-05, train loss: 0.3166
INFO:root:train average_precision, 0.9394
INFO:root:train roc_auc, 0.9365
INFO:root:validate loss: 0.4184
INFO:root:validate average_precision, 0.8963
INFO:root:validate roc_auc, 0.8946
INFO:root:new node validate loss: 0.6094
INFO:root:new node validate average_precision, 0.8520
INFO:root:new node validate roc_auc, 0.8262
INFO:root:save model ./saved_models/TGN/uci/TGN_seed4/TGN_seed4.pkl
INFO:root:Epoch: 49, learning rate: 0.00016374239897483278, train loss: 0.3104
INFO:root:train average_precision, 0.9403
INFO:root:train roc_auc, 0.9376
INFO:root:validate loss: 0.4342
INFO:root:validate average_precision, 0.8930
INFO:root:validate roc_auc, 0.8906
INFO:root:new node validate loss: 0.6364
INFO:root:new node validate average_precision, 0.8440
INFO:root:new node validate roc_auc, 0.8188
INFO:root:Epoch: 50, learning rate: 0.00020000000000022514, train loss: 0.3091
INFO:root:train average_precision, 0.9415
INFO:root:train roc_auc, 0.9386
INFO:root:validate loss: 0.4424
INFO:root:validate average_precision, 0.8934
INFO:root:validate roc_auc, 0.8915
INFO:root:new node validate loss: 0.6274
INFO:root:new node validate average_precision, 0.8593
INFO:root:new node validate roc_auc, 0.8329
INFO:root:test loss: 0.4606
INFO:root:test average_precision, 0.9196
INFO:root:test roc_auc, 0.9179
INFO:root:new node test loss: 0.6225
INFO:root:new node test average_precision, 0.8797
INFO:root:new node test roc_auc, 0.8672
INFO:root:Epoch: 51, learning rate: 0.00016374239897527237, train loss: 0.3106
INFO:root:train average_precision, 0.9403
INFO:root:train roc_auc, 0.9377
INFO:root:validate loss: 0.4254
INFO:root:validate average_precision, 0.8950
INFO:root:validate roc_auc, 0.8920
INFO:root:new node validate loss: 0.5894
INFO:root:new node validate average_precision, 0.8567
INFO:root:new node validate roc_auc, 0.8317
INFO:root:Epoch: 52, learning rate: 8.126186854144786e-05, train loss: 0.3071
INFO:root:train average_precision, 0.9432
INFO:root:train roc_auc, 0.9398
INFO:root:validate loss: 0.4160
INFO:root:validate average_precision, 0.8969
INFO:root:validate roc_auc, 0.8931
INFO:root:new node validate loss: 0.6121
INFO:root:new node validate average_precision, 0.8432
INFO:root:new node validate roc_auc, 0.8168
INFO:root:Epoch: 53, learning rate: 1.236933199563365e-05, train loss: 0.3057
INFO:root:train average_precision, 0.9434
INFO:root:train roc_auc, 0.9400
INFO:root:validate loss: 0.4275
INFO:root:validate average_precision, 0.8967
INFO:root:validate roc_auc, 0.8928
INFO:root:new node validate loss: 0.6000
INFO:root:new node validate average_precision, 0.8468
INFO:root:new node validate roc_auc, 0.8162
INFO:root:Epoch: 54, learning rate: 7.022351411187958e-06, train loss: 0.3099
INFO:root:train average_precision, 0.9410
INFO:root:train roc_auc, 0.9385
INFO:root:validate loss: 0.4212
INFO:root:validate average_precision, 0.8922
INFO:root:validate roc_auc, 0.8911
INFO:root:new node validate loss: 0.6392
INFO:root:new node validate average_precision, 0.8398
INFO:root:new node validate roc_auc, 0.8146
INFO:root:Epoch: 55, learning rate: 6.909830056245937e-05, train loss: 0.3177
INFO:root:train average_precision, 0.9379
INFO:root:train roc_auc, 0.9355
INFO:root:validate loss: 0.4325
INFO:root:validate average_precision, 0.8885
INFO:root:validate roc_auc, 0.8881
INFO:root:new node validate loss: 0.6429
INFO:root:new node validate average_precision, 0.8345
INFO:root:new node validate roc_auc, 0.8099
INFO:root:Epoch: 56, learning rate: 0.00015358267949800475, train loss: 0.3145
INFO:root:train average_precision, 0.9386
INFO:root:train roc_auc, 0.9362
INFO:root:validate loss: 0.4444
INFO:root:validate average_precision, 0.8978
INFO:root:validate roc_auc, 0.8958
INFO:root:new node validate loss: 0.6534
INFO:root:new node validate average_precision, 0.8347
INFO:root:new node validate roc_auc, 0.8080
INFO:root:save model ./saved_models/TGN/uci/TGN_seed4/TGN_seed4.pkl
INFO:root:Epoch: 57, learning rate: 0.00019921147013189584, train loss: 0.3098
INFO:root:train average_precision, 0.9414
INFO:root:train roc_auc, 0.9384
INFO:root:validate loss: 0.4509
INFO:root:validate average_precision, 0.8831
INFO:root:validate roc_auc, 0.8816
INFO:root:new node validate loss: 0.6746
INFO:root:new node validate average_precision, 0.8330
INFO:root:new node validate roc_auc, 0.8064
INFO:root:Epoch: 58, learning rate: 0.0001728968627421386, train loss: 0.3122
INFO:root:train average_precision, 0.9394
INFO:root:train roc_auc, 0.9372
INFO:root:validate loss: 0.4860
INFO:root:validate average_precision, 0.8931
INFO:root:validate roc_auc, 0.8897
INFO:root:new node validate loss: 0.6479
INFO:root:new node validate average_precision, 0.8482
INFO:root:new node validate roc_auc, 0.8230
INFO:root:Epoch: 59, learning rate: 9.372094804719067e-05, train loss: 0.3096
INFO:root:train average_precision, 0.9423
INFO:root:train roc_auc, 0.9385
INFO:root:validate loss: 0.4272
INFO:root:validate average_precision, 0.8870
INFO:root:validate roc_auc, 0.8841
INFO:root:new node validate loss: 0.6060
INFO:root:new node validate average_precision, 0.8359
INFO:root:new node validate roc_auc, 0.8091
INFO:root:Epoch: 60, learning rate: 1.9098300562488166e-05, train loss: 0.3100
INFO:root:train average_precision, 0.9412
INFO:root:train roc_auc, 0.9383
INFO:root:validate loss: 0.4326
INFO:root:validate average_precision, 0.8951
INFO:root:validate roc_auc, 0.8924
INFO:root:new node validate loss: 0.6530
INFO:root:new node validate average_precision, 0.8451
INFO:root:new node validate roc_auc, 0.8180
INFO:root:test loss: 0.4646
INFO:root:test average_precision, 0.9181
INFO:root:test roc_auc, 0.9170
INFO:root:new node test loss: 0.6171
INFO:root:new node test average_precision, 0.8715
INFO:root:new node test roc_auc, 0.8602
INFO:root:Epoch: 61, learning rate: 3.1416838871342586e-06, train loss: 0.3035
INFO:root:train average_precision, 0.9433
INFO:root:train roc_auc, 0.9403
INFO:root:validate loss: 0.4270
INFO:root:validate average_precision, 0.8964
INFO:root:validate roc_auc, 0.8947
INFO:root:new node validate loss: 0.6428
INFO:root:new node validate average_precision, 0.8439
INFO:root:new node validate roc_auc, 0.8139
INFO:root:Epoch: 62, learning rate: 5.7422070843520144e-05, train loss: 0.3028
INFO:root:train average_precision, 0.9441
INFO:root:train roc_auc, 0.9408
INFO:root:validate loss: 0.4123
INFO:root:validate average_precision, 0.8976
INFO:root:validate roc_auc, 0.8952
INFO:root:new node validate loss: 0.6314
INFO:root:new node validate average_precision, 0.8397
INFO:root:new node validate roc_auc, 0.8148
INFO:root:Epoch: 63, learning rate: 0.00014257792915625287, train loss: 0.3089
INFO:root:train average_precision, 0.9412
INFO:root:train roc_auc, 0.9386
INFO:root:validate loss: 0.4539
INFO:root:validate average_precision, 0.8919
INFO:root:validate roc_auc, 0.8910
INFO:root:new node validate loss: 0.7072
INFO:root:new node validate average_precision, 0.8294
INFO:root:new node validate roc_auc, 0.8010
INFO:root:Epoch: 64, learning rate: 0.00019685831611277526, train loss: 0.3028
INFO:root:train average_precision, 0.9441
INFO:root:train roc_auc, 0.9409
INFO:root:validate loss: 0.4398
INFO:root:validate average_precision, 0.8908
INFO:root:validate roc_auc, 0.8881
INFO:root:new node validate loss: 0.6342
INFO:root:new node validate average_precision, 0.8458
INFO:root:new node validate roc_auc, 0.8166
INFO:root:Epoch: 65, learning rate: 0.00018090169943765484, train loss: 0.3055
INFO:root:train average_precision, 0.9424
INFO:root:train roc_auc, 0.9399
INFO:root:validate loss: 0.4521
INFO:root:validate average_precision, 0.8856
INFO:root:validate roc_auc, 0.8846
INFO:root:new node validate loss: 0.6692
INFO:root:new node validate average_precision, 0.8464
INFO:root:new node validate roc_auc, 0.8216
INFO:root:Epoch: 66, learning rate: 0.00010627905195278804, train loss: 0.3028
INFO:root:train average_precision, 0.9438
INFO:root:train roc_auc, 0.9405
INFO:root:validate loss: 0.4453
INFO:root:validate average_precision, 0.8903
INFO:root:validate roc_auc, 0.8872
INFO:root:new node validate loss: 0.6570
INFO:root:new node validate average_precision, 0.8346
INFO:root:new node validate roc_auc, 0.8050
INFO:root:Epoch: 67, learning rate: 2.7103137257955887e-05, train loss: 0.3054
INFO:root:train average_precision, 0.9421
INFO:root:train roc_auc, 0.9397
INFO:root:validate loss: 0.4145
INFO:root:validate average_precision, 0.8925
INFO:root:validate roc_auc, 0.8898
INFO:root:new node validate loss: 0.5912
INFO:root:new node validate average_precision, 0.8373
INFO:root:new node validate roc_auc, 0.8089
INFO:root:Epoch: 68, learning rate: 7.885298685552731e-07, train loss: 0.3008
INFO:root:train average_precision, 0.9440
INFO:root:train roc_auc, 0.9413
INFO:root:validate loss: 0.4241
INFO:root:validate average_precision, 0.8960
INFO:root:validate roc_auc, 0.8943
INFO:root:new node validate loss: 0.6349
INFO:root:new node validate average_precision, 0.8462
INFO:root:new node validate roc_auc, 0.8175
INFO:root:Epoch: 69, learning rate: 4.64173205021652e-05, train loss: 0.3029
INFO:root:train average_precision, 0.9434
INFO:root:train roc_auc, 0.9408
INFO:root:validate loss: 0.4234
INFO:root:validate average_precision, 0.8953
INFO:root:validate roc_auc, 0.8926
INFO:root:new node validate loss: 0.6119
INFO:root:new node validate average_precision, 0.8390
INFO:root:new node validate roc_auc, 0.8101
INFO:root:Epoch: 70, learning rate: 0.00013090169943785155, train loss: 0.3027
INFO:root:train average_precision, 0.9435
INFO:root:train roc_auc, 0.9412
INFO:root:validate loss: 0.4587
INFO:root:validate average_precision, 0.8986
INFO:root:validate roc_auc, 0.8952
INFO:root:new node validate loss: 0.6660
INFO:root:new node validate average_precision, 0.8505
INFO:root:new node validate roc_auc, 0.8216
INFO:root:test loss: 0.5350
INFO:root:test average_precision, 0.9182
INFO:root:test roc_auc, 0.9163
INFO:root:new node test loss: 0.6876
INFO:root:new node test average_precision, 0.8794
INFO:root:new node test roc_auc, 0.8647
INFO:root:Epoch: 71, learning rate: 0.0001929776485889137, train loss: 0.3025
INFO:root:train average_precision, 0.9434
INFO:root:train roc_auc, 0.9406
INFO:root:validate loss: 0.4606
INFO:root:validate average_precision, 0.8855
INFO:root:validate roc_auc, 0.8830
INFO:root:new node validate loss: 0.7087
INFO:root:new node validate average_precision, 0.8380
INFO:root:new node validate roc_auc, 0.8127
INFO:root:Epoch: 72, learning rate: 0.0001876306680047241, train loss: 0.3000
INFO:root:train average_precision, 0.9450
INFO:root:train roc_auc, 0.9419
INFO:root:validate loss: 0.5243
INFO:root:validate average_precision, 0.8937
INFO:root:validate roc_auc, 0.8899
INFO:root:new node validate loss: 0.7043
INFO:root:new node validate average_precision, 0.8428
INFO:root:new node validate roc_auc, 0.8136
INFO:root:Epoch: 73, learning rate: 0.00011873813145851827, train loss: 0.3014
INFO:root:train average_precision, 0.9461
INFO:root:train roc_auc, 0.9424
INFO:root:validate loss: 0.4104
INFO:root:validate average_precision, 0.8957
INFO:root:validate roc_auc, 0.8920
INFO:root:new node validate loss: 0.6042
INFO:root:new node validate average_precision, 0.8376
INFO:root:new node validate roc_auc, 0.8081
INFO:root:Epoch: 74, learning rate: 3.625760102517048e-05, train loss: 0.3002
INFO:root:train average_precision, 0.9457
INFO:root:train roc_auc, 0.9427
INFO:root:validate loss: 0.4107
INFO:root:validate average_precision, 0.8989
INFO:root:validate roc_auc, 0.8944
INFO:root:new node validate loss: 0.5829
INFO:root:new node validate average_precision, 0.8459
INFO:root:new node validate roc_auc, 0.8167
INFO:root:Epoch: 75, learning rate: 0.0, train loss: 0.2969
INFO:root:train average_precision, 0.9458
INFO:root:train roc_auc, 0.9428
INFO:root:validate loss: 0.4293
INFO:root:validate average_precision, 0.8982
INFO:root:validate roc_auc, 0.8949
INFO:root:new node validate loss: 0.6231
INFO:root:new node validate average_precision, 0.8477
INFO:root:new node validate roc_auc, 0.8177
INFO:root:Epoch: 76, learning rate: 3.625760102509302e-05, train loss: 0.2971
INFO:root:train average_precision, 0.9458
INFO:root:train roc_auc, 0.9429
INFO:root:validate loss: 0.4172
INFO:root:validate average_precision, 0.8971
INFO:root:validate roc_auc, 0.8940
INFO:root:new node validate loss: 0.6258
INFO:root:new node validate average_precision, 0.8441
INFO:root:new node validate roc_auc, 0.8142
INFO:root:load model ./saved_models/TGN/uci/TGN_seed4/TGN_seed4.pkl
INFO:root:get final performance on dataset uci...
INFO:root:test loss: 0.4860
INFO:root:test average_precision, 0.9215
INFO:root:test roc_auc, 0.9208
INFO:root:new node test loss: 0.6750
INFO:root:new node test average_precision, 0.8688
INFO:root:new node test roc_auc, 0.8574
INFO:root:Run 5 cost 8057.22 seconds.
INFO:root:metrics over 5 runs:
INFO:root:test average_precision, [np.float64(0.9346353263095893), np.float64(0.9235366021686572), np.float64(0.9218970536582456), np.float64(0.9383633816377115), np.float64(0.9214850666753162)]
INFO:root:average test average_precision, 0.9280  0.0079
INFO:root:test roc_auc, [np.float64(0.9334636685032137), np.float64(0.9218710583103762), np.float64(0.9187336076675848), np.float64(0.935888409090909), np.float64(0.920840618686869)]
INFO:root:average test roc_auc, 0.9262  0.0079
INFO:root:new node test average_precision, [np.float64(0.8871616548186119), np.float64(0.8761515070371065), np.float64(0.8773526572840922), np.float64(0.8975837231687644), np.float64(0.8688123658952268)]
INFO:root:average new node test average_precision, 0.8814  0.0112
INFO:root:new node test roc_auc, [np.float64(0.8779927119681665), np.float64(0.8637903875880012), np.float64(0.8627511998775634), np.float64(0.8865149801040709), np.float64(0.8574212113559841)]
INFO:root:average new node test roc_auc, 0.8697  0.0121
The dataset has 59835 interactions, involving 1899 different nodes
The training dataset has 34352 interactions, involving 1370 different nodes
The validation dataset has 8975 interactions, involving 1036 different nodes
The test dataset has 8976 interactions, involving 847 different nodes
The new node validation dataset has 5002 interactions, involving 830 different nodes
The new node test dataset has 5932 interactions, involving 684 different nodes
189 nodes were used for the inductive testing, i.e. are never seen during training
